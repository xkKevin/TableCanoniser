{"version":3,"file":"js/app.00fca540.js","mappings":"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","sources":["webpack://TableCanoniser/./node_modules/moment/locale/ sync ^\\.\\/.*$","webpack://TableCanoniser/./src/components/PatternVis.vue?27d9","webpack://TableCanoniser/./src/components/PatternVis.vue","webpack://TableCanoniser/./src/App.vue?d8c0","webpack://TableCanoniser/./src/App.vue","webpack://TableCanoniser/./src/components/ColType.vue?5dc4","webpack://TableCanoniser/./src/components/ColType.vue","webpack://TableCanoniser/./src/components/ColType.vue?edef","webpack://TableCanoniser/./src/utils/dragLayout.ts","webpack://TableCanoniser/./src/components/InOutTable.vue?7f1b","webpack://TableCanoniser/./src/components/InOutTable.vue","webpack://TableCanoniser/./src/components/InOutTable.vue?cbe2","webpack://TableCanoniser/./src/components/CodeView.vue?243d","webpack://TableCanoniser/./src/components/CodeView.vue","webpack://TableCanoniser/./src/components/CodeView.vue?33e2","webpack://TableCanoniser/./src/components/PatternVis.vue?c92c","webpack://TableCanoniser/./src/components/DraggableModal.vue?c844","webpack://TableCanoniser/./src/components/DraggableModal.vue","webpack://TableCanoniser/./src/components/DraggableModal.vue?f84a","webpack://TableCanoniser/./src/views/PanelView.vue?6324","webpack://TableCanoniser/./src/views/PanelView.vue","webpack://TableCanoniser/./src/views/PanelView.vue?f0ad","webpack://TableCanoniser/./src/App.vue?7ccd","webpack://TableCanoniser/./src/main.ts","webpack://TableCanoniser/./src/store/table.ts","webpack://TableCanoniser/./src/types.ts","webpack://TableCanoniser/./src/utils/drawTree.ts","webpack://TableCanoniser/./src/utils/minimap.ts","webpack://TableCanoniser/./src/utils/style.ts","webpack://TableCanoniser/./src/utils/template.ts","webpack://TableCanoniser/../src/grammar.ts","webpack://TableCanoniser/../src/parser.ts","webpack://TableCanoniser/./node_modules/typescript/lib/ sync","webpack://TableCanoniser/webpack/bootstrap","webpack://TableCanoniser/webpack/runtime/amd options","webpack://TableCanoniser/webpack/runtime/chunk loaded","webpack://TableCanoniser/webpack/runtime/compat get default export","webpack://TableCanoniser/webpack/runtime/define property getters","webpack://TableCanoniser/webpack/runtime/ensure chunk","webpack://TableCanoniser/webpack/runtime/get javascript chunk filename","webpack://TableCanoniser/webpack/runtime/get mini-css chunk filename","webpack://TableCanoniser/webpack/runtime/global","webpack://TableCanoniser/webpack/runtime/hasOwnProperty shorthand","webpack://TableCanoniser/webpack/runtime/load script","webpack://TableCanoniser/webpack/runtime/make namespace object","webpack://TableCanoniser/webpack/runtime/node module decorator","webpack://TableCanoniser/webpack/runtime/publicPath","webpack://TableCanoniser/webpack/runtime/jsonp chunk loading","webpack://TableCanoniser/webpack/startup"],"sourcesContent":["var map = {\n\t\"./af\": 22190,\n\t\"./af.js\": 22190,\n\t\"./ar\": 7218,\n\t\"./ar-dz\": 85785,\n\t\"./ar-dz.js\": 85785,\n\t\"./ar-kw\": 29417,\n\t\"./ar-kw.js\": 29417,\n\t\"./ar-ly\": 56904,\n\t\"./ar-ly.js\": 56904,\n\t\"./ar-ma\": 98617,\n\t\"./ar-ma.js\": 98617,\n\t\"./ar-ps\": 91318,\n\t\"./ar-ps.js\": 91318,\n\t\"./ar-sa\": 82699,\n\t\"./ar-sa.js\": 82699,\n\t\"./ar-tn\": 36789,\n\t\"./ar-tn.js\": 36789,\n\t\"./ar.js\": 7218,\n\t\"./az\": 23050,\n\t\"./az.js\": 23050,\n\t\"./be\": 8316,\n\t\"./be.js\": 8316,\n\t\"./bg\": 70310,\n\t\"./bg.js\": 70310,\n\t\"./bm\": 58884,\n\t\"./bm.js\": 58884,\n\t\"./bn\": 83469,\n\t\"./bn-bd\": 46672,\n\t\"./bn-bd.js\": 46672,\n\t\"./bn.js\": 83469,\n\t\"./bo\": 39118,\n\t\"./bo.js\": 39118,\n\t\"./br\": 13113,\n\t\"./br.js\": 13113,\n\t\"./bs\": 23626,\n\t\"./bs.js\": 23626,\n\t\"./ca\": 40921,\n\t\"./ca.js\": 40921,\n\t\"./cs\": 17799,\n\t\"./cs.js\": 17799,\n\t\"./cv\": 12828,\n\t\"./cv.js\": 12828,\n\t\"./cy\": 93521,\n\t\"./cy.js\": 93521,\n\t\"./da\": 56962,\n\t\"./da.js\": 56962,\n\t\"./de\": 93294,\n\t\"./de-at\": 16158,\n\t\"./de-at.js\": 16158,\n\t\"./de-ch\": 95960,\n\t\"./de-ch.js\": 95960,\n\t\"./de.js\": 93294,\n\t\"./dv\": 47963,\n\t\"./dv.js\": 47963,\n\t\"./el\": 3432,\n\t\"./el.js\": 3432,\n\t\"./en-au\": 20998,\n\t\"./en-au.js\": 20998,\n\t\"./en-ca\": 38312,\n\t\"./en-ca.js\": 38312,\n\t\"./en-gb\": 45930,\n\t\"./en-gb.js\": 45930,\n\t\"./en-ie\": 58081,\n\t\"./en-ie.js\": 58081,\n\t\"./en-il\": 71594,\n\t\"./en-il.js\": 71594,\n\t\"./en-in\": 23904,\n\t\"./en-in.js\": 23904,\n\t\"./en-nz\": 1507,\n\t\"./en-nz.js\": 1507,\n\t\"./en-sg\": 19409,\n\t\"./en-sg.js\": 19409,\n\t\"./eo\": 22177,\n\t\"./eo.js\": 22177,\n\t\"./es\": 84805,\n\t\"./es-do\": 39155,\n\t\"./es-do.js\": 39155,\n\t\"./es-mx\": 69791,\n\t\"./es-mx.js\": 69791,\n\t\"./es-us\": 76098,\n\t\"./es-us.js\": 76098,\n\t\"./es.js\": 84805,\n\t\"./et\": 96240,\n\t\"./et.js\": 96240,\n\t\"./eu\": 20391,\n\t\"./eu.js\": 20391,\n\t\"./fa\": 20612,\n\t\"./fa.js\": 20612,\n\t\"./fi\": 4220,\n\t\"./fi.js\": 4220,\n\t\"./fil\": 65570,\n\t\"./fil.js\": 65570,\n\t\"./fo\": 5466,\n\t\"./fo.js\": 5466,\n\t\"./fr\": 14461,\n\t\"./fr-ca\": 66306,\n\t\"./fr-ca.js\": 66306,\n\t\"./fr-ch\": 27081,\n\t\"./fr-ch.js\": 27081,\n\t\"./fr.js\": 14461,\n\t\"./fy\": 73484,\n\t\"./fy.js\": 73484,\n\t\"./ga\": 76957,\n\t\"./ga.js\": 76957,\n\t\"./gd\": 72978,\n\t\"./gd.js\": 72978,\n\t\"./gl\": 89866,\n\t\"./gl.js\": 89866,\n\t\"./gom-deva\": 65011,\n\t\"./gom-deva.js\": 65011,\n\t\"./gom-latn\": 84724,\n\t\"./gom-latn.js\": 84724,\n\t\"./gu\": 71601,\n\t\"./gu.js\": 71601,\n\t\"./he\": 79802,\n\t\"./he.js\": 79802,\n\t\"./hi\": 9358,\n\t\"./hi.js\": 9358,\n\t\"./hr\": 13907,\n\t\"./hr.js\": 13907,\n\t\"./hu\": 10218,\n\t\"./hu.js\": 10218,\n\t\"./hy-am\": 20533,\n\t\"./hy-am.js\": 20533,\n\t\"./id\": 52844,\n\t\"./id.js\": 52844,\n\t\"./is\": 97353,\n\t\"./is.js\": 97353,\n\t\"./it\": 6364,\n\t\"./it-ch\": 20774,\n\t\"./it-ch.js\": 20774,\n\t\"./it.js\": 6364,\n\t\"./ja\": 6008,\n\t\"./ja.js\": 6008,\n\t\"./jv\": 68221,\n\t\"./jv.js\": 68221,\n\t\"./ka\": 92417,\n\t\"./ka.js\": 92417,\n\t\"./kk\": 42071,\n\t\"./kk.js\": 42071,\n\t\"./km\": 76149,\n\t\"./km.js\": 76149,\n\t\"./kn\": 94572,\n\t\"./kn.js\": 94572,\n\t\"./ko\": 60659,\n\t\"./ko.js\": 60659,\n\t\"./ku\": 66285,\n\t\"./ku-kmr\": 59398,\n\t\"./ku-kmr.js\": 59398,\n\t\"./ku.js\": 66285,\n\t\"./ky\": 81609,\n\t\"./ky.js\": 81609,\n\t\"./lb\": 119,\n\t\"./lb.js\": 119,\n\t\"./lo\": 81748,\n\t\"./lo.js\": 81748,\n\t\"./lt\": 71973,\n\t\"./lt.js\": 71973,\n\t\"./lv\": 81347,\n\t\"./lv.js\": 81347,\n\t\"./me\": 53023,\n\t\"./me.js\": 53023,\n\t\"./mi\": 65747,\n\t\"./mi.js\": 65747,\n\t\"./mk\": 64341,\n\t\"./mk.js\": 64341,\n\t\"./ml\": 63840,\n\t\"./ml.js\": 63840,\n\t\"./mn\": 62058,\n\t\"./mn.js\": 62058,\n\t\"./mr\": 19182,\n\t\"./mr.js\": 19182,\n\t\"./ms\": 45197,\n\t\"./ms-my\": 89136,\n\t\"./ms-my.js\": 89136,\n\t\"./ms.js\": 45197,\n\t\"./mt\": 36408,\n\t\"./mt.js\": 36408,\n\t\"./my\": 51683,\n\t\"./my.js\": 51683,\n\t\"./nb\": 53141,\n\t\"./nb.js\": 53141,\n\t\"./ne\": 29344,\n\t\"./ne.js\": 29344,\n\t\"./nl\": 44703,\n\t\"./nl-be\": 84641,\n\t\"./nl-be.js\": 84641,\n\t\"./nl.js\": 44703,\n\t\"./nn\": 79873,\n\t\"./nn.js\": 79873,\n\t\"./oc-lnc\": 61217,\n\t\"./oc-lnc.js\": 61217,\n\t\"./pa-in\": 24612,\n\t\"./pa-in.js\": 24612,\n\t\"./pl\": 24457,\n\t\"./pl.js\": 24457,\n\t\"./pt\": 1089,\n\t\"./pt-br\": 79146,\n\t\"./pt-br.js\": 79146,\n\t\"./pt.js\": 1089,\n\t\"./ro\": 45950,\n\t\"./ro.js\": 45950,\n\t\"./ru\": 27292,\n\t\"./ru.js\": 27292,\n\t\"./sd\": 56774,\n\t\"./sd.js\": 56774,\n\t\"./se\": 87493,\n\t\"./se.js\": 87493,\n\t\"./si\": 3761,\n\t\"./si.js\": 3761,\n\t\"./sk\": 49711,\n\t\"./sk.js\": 49711,\n\t\"./sl\": 88558,\n\t\"./sl.js\": 88558,\n\t\"./sq\": 8633,\n\t\"./sq.js\": 8633,\n\t\"./sr\": 90688,\n\t\"./sr-cyrl\": 47903,\n\t\"./sr-cyrl.js\": 47903,\n\t\"./sr.js\": 90688,\n\t\"./ss\": 31991,\n\t\"./ss.js\": 31991,\n\t\"./sv\": 4639,\n\t\"./sv.js\": 4639,\n\t\"./sw\": 15891,\n\t\"./sw.js\": 15891,\n\t\"./ta\": 45714,\n\t\"./ta.js\": 45714,\n\t\"./te\": 30206,\n\t\"./te.js\": 30206,\n\t\"./tet\": 24768,\n\t\"./tet.js\": 24768,\n\t\"./tg\": 28276,\n\t\"./tg.js\": 28276,\n\t\"./th\": 57977,\n\t\"./th.js\": 57977,\n\t\"./tk\": 56928,\n\t\"./tk.js\": 56928,\n\t\"./tl-ph\": 8046,\n\t\"./tl-ph.js\": 8046,\n\t\"./tlh\": 41361,\n\t\"./tlh.js\": 41361,\n\t\"./tr\": 64367,\n\t\"./tr.js\": 64367,\n\t\"./tzl\": 10627,\n\t\"./tzl.js\": 10627,\n\t\"./tzm\": 12636,\n\t\"./tzm-latn\": 98148,\n\t\"./tzm-latn.js\": 98148,\n\t\"./tzm.js\": 12636,\n\t\"./ug-cn\": 68823,\n\t\"./ug-cn.js\": 68823,\n\t\"./uk\": 40461,\n\t\"./uk.js\": 40461,\n\t\"./ur\": 41366,\n\t\"./ur.js\": 41366,\n\t\"./uz\": 83454,\n\t\"./uz-latn\": 18374,\n\t\"./uz-latn.js\": 18374,\n\t\"./uz.js\": 83454,\n\t\"./vi\": 78572,\n\t\"./vi.js\": 78572,\n\t\"./x-pseudo\": 80464,\n\t\"./x-pseudo.js\": 80464,\n\t\"./yo\": 93709,\n\t\"./yo.js\": 93709,\n\t\"./zh-cn\": 65873,\n\t\"./zh-cn.js\": 65873,\n\t\"./zh-hk\": 17549,\n\t\"./zh-hk.js\": 17549,\n\t\"./zh-mo\": 52240,\n\t\"./zh-mo.js\": 52240,\n\t\"./zh-tw\": 90405,\n\t\"./zh-tw.js\": 90405\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 35358;","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"view\" }\nconst _hoisted_2 = { class: \"view-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"font-size\":\"18px\",\"font-weight\":\"bold\"} }, \"Mapping Patterns\", -1)\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Current instance:\", -1)\nconst _hoisted_5 = [\"title\"]\nconst _hoisted_6 = { style: {\"font-size\":\"15px\",\"height\":\"25px\"} }\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Match:\", -1)\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Extract by:\", -1)\nconst _hoisted_9 = { style: {\"margin-right\":\"10px\"} }\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Reset View\", -1)\nconst _hoisted_11 = {\n  class: \"view-content\",\n  style: {\"display\":\"flex\"}\n}\nconst _hoisted_12 = { style: {\"flex\":\"1.3\"} }\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"path\", { class: \"mini-temp-line top-line\" }, null, -1)\nconst _hoisted_14 = /*#__PURE__*/_createElementVNode(\"path\", { class: \"mini-temp-line bottom-line\" }, null, -1)\nconst _hoisted_15 = [\n  _hoisted_13,\n  _hoisted_14\n]\nconst _hoisted_16 = { style: {\"flex\":\"1\",\"margin-left\":\"5px\"} }\n\nimport { computed, onMounted, ref, watch } from 'vue';\n// import * as d3 from 'd3';\n// import { flextree, FlextreeNode } from 'd3-flextree';\nimport { TreeChart } from '@/utils/drawTree';\nimport { message } from 'ant-design-vue';\nimport { useTableStore } from \"@/store/table\";\nimport * as d3 from 'd3';\nimport { TypeColor } from '@/utils/style';\nimport { drawMinimap, miniZoom } from '@/utils/minimap';\nimport { drawTblTemplate, tempZoom } from '@/utils/template';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PatternVis',\n  setup(__props, { expose: __expose }) {\n\nconst tableStore = useTableStore();\n\n/*\ninterface TreeNode {\n    [key: string]: any;\n    children?: TreeNode[];\n}\n\nconst data: TreeNode = {\n    name: 'Root',\n    children: [\n        { name: 'Child 1' },\n        {\n            name: 'Child 2',\n            children: [\n                { name: 'Grandchild 1' },\n                { name: 'Grandchild 2' },\n                { name: 'Grandchild 3' },\n            ]\n        }\n    ]\n};\n*/\n\n// const currentInstFlag = ref(false);\n// const disableNextFlag = ref(false);\n// const disableGoToInstFlag = ref(false);\nconst instanceContent = ref(\"\");\nconst menuList = computed(() => tableStore.tree.menuList);\n// const contextMenuVisible = tableStore.tree.contextMenuVisible;\nconst contextMenuVisible = computed(() => tableStore.tree.contextMenuVisible && tableStore.tree.menuList.length > 0);\nconst contextMenuVisibleChange = (value: boolean) => {\n    // if (store.state.selectedNode.length === 0 && value === true) return;\n    // store.commit('setContextMenuVisibility', value);\n    tableStore.tree.contextMenuVisible = value;\n    tableStore.tree.menuList = [];\n    // setTimeout(() => {\n    //     tableStore.tree.menuList = [];\n    // }, 0)\n};\n\nconst closeContextMenu = (e: any) => {\n    // console.log(\"closeContextMenu\", e, e.key);\n    const visNode = tableStore.spec.selectNode!.data;\n    let extract: any = null, extractColor: string = '';\n    let triggerCellCursorFlag = false;\n    let messageInfo = \"\\n Press ESC to cancel the selection mode.\";\n    const maxCNum = tableStore.findMaxCNumber() + 1;\n    switch (e.key) {\n        case \"0\":\n            // Reset Area Logic\n            messageInfo = \"Please reselect the template's area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"1\":\n            // Add Constraints Logic\n            messageInfo = \"Please select the constrained cell in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"2-0\":\n            // Target Cols - Position Based Logic\n            extract = {\n                byPositionToTargetCols: Array.from({ length: visNode.width * visNode.height }, (_, i) => `C${maxCNum + i}`)\n            }\n            extractColor = 'positionShallow';\n            break;\n        case \"2-1\":\n            // Target Cols - Context Based Logic\n            extract = {\n                byContext: {\n                    position: 'above'\n                }\n            }\n            extractColor = 'contextShallow';\n            break;\n        case \"2-2\":\n            // Target Cols - Value Based Logic\n            const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n            }\n            extract = {\n                byValue: createExtract()\n            }\n            extractColor = 'valueShallow';\n            break;\n        case \"2-3\":\n            // Target Cols - No Extract Logic\n            tableStore.insertNodeOrPropertyIntoSpecs(undefined, \"extract\")\n            break;\n        case \"3\":\n            // Add Sub-Template Logic\n            messageInfo = \"Please select an area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"4\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!);\n            tableStore.stringifySpec();\n            break;\n        case \"5\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!, tableStore.spec.selectConstrIndex);\n            tableStore.stringifySpec();\n    }\n\n    if (extract !== null) {\n        tableStore.insertNodeOrPropertyIntoSpecs(extract, \"extract\")\n        tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(extract, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), extractColor];\n    }\n    if (triggerCellCursorFlag) {\n        message.info(messageInfo);\n        tableStore.spec.selectAreaFromNode = e.key;\n        document.body.style.cursor = 'cell';\n        document.documentElement.style.setProperty('--custom-cursor', 'cell');\n        const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, tableStore.spec.selectAreaFromLegend);\n        tableStore.highlightTblCells(\"input_tbl\", cells);\n    }\n    tableStore.tree.contextMenuVisible = false;\n}\n\nconst treeContainer = ref<HTMLDivElement | null>(null);\n\nfunction resetZoom() {\n    // drawTree(tableStore.spec.visTree);\n    // c.transition().duration(750)// .call(tableStore.tree.visInst!.zoomfunc as any, d3.zoomIdentity);\n    tableStore.tree.visInst!.resetZoom();\n    // g.matrixtransformzoomsvgsvgtransform\n    d3.select('svg.tbl-container g.left').transition().duration(750)\n        .call(miniZoom!.transform as any, d3.zoomIdentity); // \n    d3.select('svg.tbl-container g.right').transition().duration(750)\n        .call(tempZoom!.transform as any, d3.zoomIdentity); // \n\n}\n\nconst drawTree = (data: any) => {\n    const treeInstance = new TreeChart([2, 1], '.tree-container', data, tableStore, 1.0, 'h');\n    treeInstance.render();\n    tableStore.tree.visInst = treeInstance;\n};\n\nconst typeMap = {\n    \"null\": \"Region\",\n    \"position\": \"Position Based\",\n    \"context\": \"Context Based\",\n    \"value\": \"Value Based\",\n}\nconst selectMatchExtractArea = (type: TypeColor) => {\n    d3.selectAll('.legend').classed('legend-selection', false);\n    d3.select(`.legend.legend-${type}`).classed('legend-selection', true);\n    const selectionsFromLegend = tableStore.spec.selectionsAreaFromLegend;\n    const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n    const cells = tableStore.generateHighlightCells(selectionsFromLegend, selectFromLegend);\n    tableStore.highlightTblCells(\"input_tbl\", cells);\n\n    if (selectFromLegend.length > selectionsFromLegend.length) {\n        selectFromLegend[selectFromLegend.length - 1] = type;\n    } else {\n        selectFromLegend.push(type);\n    }\n    // const cursorStyle = `url(${require('@/assets/cell.png')}), auto`;\n    document.body.style.cursor = 'cell';\n    document.documentElement.style.setProperty('--custom-cursor', 'cell');\n    message.info(\"Now is in \" + typeMap[type as keyof typeof typeMap] + \" mode. Please select the starting area in the input table.\\n Press ESC to cancel the selection mode.\");\n    // tableStore.input_tbl.instance.rootElement.style.cursor = \"cell\";\n    // (document.querySelector('.truncated') as HTMLElement).style.cursor = \"cell\"\n}\n\n\n\nconst tblContainer = ref<SVGSVGElement | null>(null);\n\n/*\nimport { debounce } from 'lodash';\n\n// import { TableCanoniserTemplate } from '@/table-canoniser/dist/grammar';\n\nconst debouncedResize = debounce(() => {\n    drawTree(tableStore.spec.visTree);\n}, 100); // \n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nconst handleFormatter = (v: any) => {\n    // console.log(v, tableStore.output_tbl.tbl.length);\n    // return tableStore.output_tbl.tbl.length === 0 ? '' : isNaN(v) ? 0 : parseInt(v) + 1\n    return tableStore.spec.matchedInstNum === 0 ? '' : isNaN(v) ? 0 : parseInt(v) + 1\n}\n\nconst handleStep = (v: number, info: { offset: number, type: 'up' | 'down' }) => {\n    // :max=\" tableStore.output_tbl.tbl.length> 0 ? tableStore.spec.visTree.children![0].matchs!.length - 1 : 0\"\n    // :min=\"0\"\n    if (info.type === 'up') {\n        if (v <= 1) return;\n        tableStore.goToInstance(v - 2);\n    } else {\n        if (v >= tableStore.spec.visTree.children![0].matchs!.length - 2) return;\n        tableStore.goToInstance(v + 2);\n    }\n}\n\nfunction handleCodeChange(clickFlag = false) {\n    // console.log(\"handleCodeChange: start\", tableStore.editor.mappingSpec.codeUpdateFromEditor);\n    if (tableStore.editor.mappingSpec.codeUpdateFromEditor) {\n        setTimeout(() => {\n            tableStore.editor.mappingSpec.codeUpdateFromEditor = false;\n        }, 600)\n        if (clickFlag) return;\n    }\n    if (tableStore.editor.mappingSpec.code !== tableStore.editor.mappingSpec.instance!.getValue()) {\n        tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.code);\n    }\n    const setFlag = tableStore.prepareDataAfterCodeChange();\n    if (!setFlag) return;\n    if (document.body.style.cursor === 'default') {\n        drawMinimap(tableStore.input_tbl.tbl.length, tableStore.input_tbl.tbl[0].length, tblContainer.value, tableStore);\n    }\n    tableStore.transformTablebyCode();  // auto run\n    if (tableStore.editor.mappingSpec.highlightCode) {\n        // console.log('handleCodeChange-highlightCode', tableStore.editor.mappingSpec.highlightCode);\n        tableStore.highlightCode(...tableStore.editor.mappingSpec.highlightCode);\n        // tableStore.editor.mappingSpec.highlightCode = null;\n    }\n    setTimeout(() => {\n        tableStore.editor.mappingSpec.triggerCodeChange = true;\n    }, 600)\n\n    if (tableStore.spec.matchedInstNum === 0) {\n        instanceContent.value = 'No matched instance';\n        tableStore.tree.instanceIndex = -1;\n    } else {\n        instanceContent.value = 'Total ' + tableStore.spec.matchedInstNum + ' instance(s)';\n    }\n    tableStore.computeColInfo(\"output_tbl\");\n    drawTree(tableStore.spec.visTree); // \n    drawTblTemplate(tblContainer.value, tableStore);\n    // console.log(tableStore.input_tbl.instance.get);\n    // console.log('watch code changed: end');\n    tableStore.optimizeMiniTempDistance();\n    tableStore.updateCurve();\n    // currentInstFlag.value = tableStore.spec.visTree.children!.length > 0 && tableStore.spec.visTree.children![0].matchs !== undefined && tableStore.spec.visTree.children![0].matchs!.length > 0;\n    // disableNextFlag.value = tableStore.spec.selectNode === null || tableStore.spec.visTree.children!.length === 0 || tableStore.spec.visTree.children![0].matchs === undefined || tableStore.tree.instanceIndex === tableStore.spec.visTree.children![0].matchs!.length - 1;\n}\n\n// const debouncedHandleCodeChange = tableStore.debounce(handleCodeChange, 200); // 200ms \n\n\n// Vue 3<script setup>Vue 2 .methods <script setup>methods defineExpose \n__expose({ handleCodeChange });\n\nwatch(() => tableStore.editor.mappingSpec.code, (newVal) => {\n    if (tableStore.editor.mappingSpec.triggerCodeChange) {\n        handleCodeChange()\n    } else if (tableStore.editor.mappingSpec.highlightCode) {\n        tableStore.editor.mappingSpec.instance?.setValue(newVal);\n        tableStore.highlightCode(...tableStore.editor.mappingSpec.highlightCode);\n        tableStore.editor.mappingSpec.triggerCodeChange = true;\n    }\n});\n\nwatch(() => tableStore.tree.instanceIndex, () => {\n    drawTblTemplate(tblContainer.value, tableStore);\n    // disableNextFlag.value = tableStore.spec.selectNode === null || tableStore.spec.visTree.children!.length === 0 || tableStore.spec.visTree.children![0].matchs === undefined || tableStore.tree.instanceIndex === tableStore.spec.visTree.children![0].matchs!.length - 1;\n    tableStore.updateCurve();\n});\n\nwatch(() => tableStore.input_tbl.tbl, (newVal) => {\n    // console.log('watch: input_tbl changed: start');\n    drawMinimap(newVal.length, newVal[0].length, tblContainer.value, tableStore);\n    tableStore.computeColInfo(\"input_tbl\");\n});  // , { deep: true }\n\n// watch(() => tableStore.output_tbl.tbl, () => {\n//     // console.log('watch: output_tbl changed: start');\n//     tableStore.computeColInfo(\"output_tbl\");\n// }, { deep: true });\n\n// watch(() => tableStore.spec.visTree.size.height, (newVal) => {\n//     console.log('watch tbl size changed: start');\n//     const setFlag = tableStore.prepareDataAfterCodeChange();\n//     if (!setFlag) return;\n//     drawTree(tableStore.spec.visTree);\n//     console.log('watch tbl size changed: end');\n// });\n\n\nonMounted(() => {\n    document.querySelector('span.ant-input-number-handler-up')!.setAttribute(\"title\", \"Previous instance\")\n    document.querySelector('span.ant-input-number-handler-down')!.setAttribute(\"title\", \"Next instance\")\n});\n\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_input_number = _resolveComponent(\"a-input-number\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_button_group = _resolveComponent(\"a-button-group\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_flex = _resolveComponent(\"a-flex\")!\n  const _component_a_menu = _resolveComponent(\"a-menu\")!\n  const _component_a_dropdown = _resolveComponent(\"a-dropdown\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_a_flex, {\n        justify: \"space-between\",\n        align: \"center\"\n      }, {\n        default: _withCtx(() => [\n          _hoisted_3,\n          _createElementVNode(\"span\", null, [\n            _hoisted_4,\n            _createVNode(_component_a_input_number, {\n              class: \"goToInstance\",\n              value: _unref(tableStore).tree.instanceIndex,\n              defaultValue: -1,\n              disabled: _unref(tableStore).spec.matchedInstNum === 0,\n              onPressEnter: _cache[0] || (_cache[0] = ($event: any) => (_unref(tableStore).goToInstance(+$event.target.value - 1))),\n              size: \"small\",\n              precision: 0,\n              formatter: handleFormatter,\n              onStep: handleStep,\n              onBlur: _cache[1] || (_cache[1] = ($event: any) => (_unref(tableStore).goToInstance(+$event.target.value - 1)))\n            }, null, 8, [\"value\", \"disabled\"]),\n            _createElementVNode(\"span\", {\n              style: {\"font-weight\":\"normal\"},\n              title: instanceContent.value\n            }, \"/ [\" + _toDisplayString(_unref(tableStore).spec.matchedInstNum) + \"]\", 9, _hoisted_5)\n          ]),\n          _createElementVNode(\"span\", _hoisted_6, [\n            _hoisted_7,\n            _createVNode(_component_a_button_group, { style: {\"margin\":\"0 15px 0 6px\"} }, {\n              default: _withCtx(() => [\n                _createVNode(_component_a_button, {\n                  class: \"legend legend-null\",\n                  size: \"small\",\n                  onClick: _cache[2] || (_cache[2] = ($event: any) => (selectMatchExtractArea('null'))),\n                  title: \"Click to select a starting area in the input table. Press 'Esc' to cancel the selection mode.\"\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\"Region\")\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }),\n            _hoisted_8,\n            _createVNode(_component_a_button_group, { style: {\"margin-left\":\"6px\"} }, {\n              default: _withCtx(() => [\n                _createVNode(_component_a_button, {\n                  class: \"legend legend-position\",\n                  size: \"small\",\n                  onClick: _cache[3] || (_cache[3] = ($event: any) => (selectMatchExtractArea('position'))),\n                  title: \"Click to select a starting area in the input table for matching and extracting by position. Press 'Esc' to cancel the selection mode.\"\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\"Position\")\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_a_button, {\n                  class: \"legend legend-context\",\n                  size: \"small\",\n                  onClick: _cache[4] || (_cache[4] = ($event: any) => (selectMatchExtractArea('context'))),\n                  title: \"Click to select a starting area in the input table for matching and extracting by context. Press 'Esc' to cancel the selection mode.\"\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\"Context\")\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_a_button, {\n                  class: \"legend legend-value\",\n                  size: \"small\",\n                  onClick: _cache[5] || (_cache[5] = ($event: any) => (selectMatchExtractArea('value'))),\n                  title: \"Click to select a starting area in the input table for matching and extracting by value. Press 'Esc' to cancel the selection mode.\"\n                }, {\n                  default: _withCtx(() => [\n                    _createTextVNode(\"Value\")\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _createElementVNode(\"span\", _hoisted_9, [\n            _createVNode(_component_a_button, {\n              id: \"draw_tree\",\n              size: \"small\",\n              onClick: resetZoom\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, {\n                  name: \"bi-arrow-clockwise\",\n                  scale: \"0.9\"\n                }),\n                _hoisted_10\n              ]),\n              _: 1\n            })\n          ])\n        ]),\n        _: 1\n      })\n    ]),\n    _createElementVNode(\"div\", _hoisted_11, [\n      _createElementVNode(\"div\", _hoisted_12, [\n        (_openBlock(), _createElementBlock(\"svg\", {\n          ref_key: \"tblContainer\",\n          ref: tblContainer,\n          class: \"tbl-container\"\n        }, _hoisted_15, 512))\n      ]),\n      _createElementVNode(\"div\", _hoisted_16, [\n        _createVNode(_component_a_dropdown, {\n          trigger: ['contextmenu'],\n          open: contextMenuVisible.value,\n          onOpenChange: contextMenuVisibleChange\n        }, {\n          overlay: _withCtx(() => [\n            _createVNode(_component_a_menu, {\n              onClick: closeContextMenu,\n              items: menuList.value\n            }, null, 8, [\"items\"])\n          ]),\n          default: _withCtx(() => [\n            _createElementVNode(\"div\", {\n              ref_key: \"treeContainer\",\n              ref: treeContainer,\n              class: \"tree-container\"\n            }, null, 512)\n          ]),\n          _: 1\n        }, 8, [\"open\"])\n      ])\n    ])\n  ]))\n}\n}\n\n})","<template>\n    <div class=\"view\"> <!-- style=\"flex: 4.5\" -->\n        <div class=\"view-title\">\n            <a-flex justify=\"space-between\" align=\"center\">\n                <span style=\"font-size: 18px; font-weight: bold;\">Mapping Patterns</span>\n                <span>\n                    <span>Current instance:</span>\n                    <a-input-number class=\"goToInstance\" :value=\"tableStore.tree.instanceIndex\" :defaultValue=\"-1\"\n                        :disabled=\"tableStore.spec.matchedInstNum === 0\"\n                        @pressEnter=\"tableStore.goToInstance(+$event.target.value - 1)\" size=\"small\" :precision=\"0\"\n                        :formatter=\"handleFormatter\" @step=\"handleStep\"\n                        @blur=\"tableStore.goToInstance(+$event.target.value - 1)\"></a-input-number>\n                    <span style=\"font-weight: normal\" :title=\"instanceContent\">/ [{{ tableStore.spec.matchedInstNum\n                        }}]</span>\n                </span>\n                <span style=\"font-size: 15px; height: 25px\">\n                    <span>Match:</span>\n                    <a-button-group style=\"margin: 0 15px 0 6px\">\n                        <a-button class=\"legend legend-null\" size=\"small\" @click=\"selectMatchExtractArea('null')\"\n                            title=\"Click to select a starting area in the input table. Press 'Esc' to cancel the selection mode.\">Region</a-button>\n                    </a-button-group>\n                    <span>Extract by:</span>\n                    <a-button-group style=\"margin-left: 6px\">\n                        <a-button class=\"legend legend-position\" size=\"small\"\n                            @click=\"selectMatchExtractArea('position')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by position. Press 'Esc' to cancel the selection mode.\">Position</a-button>\n                        <a-button class=\"legend legend-context\" size=\"small\" @click=\"selectMatchExtractArea('context')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by context. Press 'Esc' to cancel the selection mode.\">Context</a-button>\n                        <a-button class=\"legend legend-value\" size=\"small\" @click=\"selectMatchExtractArea('value')\"\n                            title=\"Click to select a starting area in the input table for matching and extracting by value. Press 'Esc' to cancel the selection mode.\">Value</a-button>\n                    </a-button-group>\n                </span>\n                <span style=\"margin-right: 10px\">\n                    <a-button id=\"draw_tree\" size=\"small\" @click=\"resetZoom\">\n                        <v-icon name=\"bi-arrow-clockwise\" scale=\"0.9\"></v-icon>\n                        <span>Reset View</span>\n                    </a-button>\n                </span>\n            </a-flex>\n        </div>\n        <div class=\"view-content\" style=\"display: flex;\">\n            <div style=\"flex: 1.3;\">\n                <svg ref=\"tblContainer\" class=\"tbl-container\">\n                    <path class=\"mini-temp-line top-line\"></path>\n                    <path class=\"mini-temp-line bottom-line\"></path>\n                </svg>\n            </div>\n            <div style=\"flex: 1; margin-left: 5px\">\n                <a-dropdown :trigger=\"['contextmenu']\" :open=\"contextMenuVisible\"\n                    @openChange=\"contextMenuVisibleChange\">\n                    <template #overlay>\n                        <a-menu @click=\"closeContextMenu\" :items=\"menuList\">\n                        </a-menu>\n                    </template>\n                    <div ref=\"treeContainer\" class=\"tree-container\"></div>\n                </a-dropdown>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref, watch } from 'vue';\n// import * as d3 from 'd3';\n// import { flextree, FlextreeNode } from 'd3-flextree';\nimport { TreeChart } from '@/utils/drawTree';\nimport { message } from 'ant-design-vue';\nimport { useTableStore } from \"@/store/table\";\nimport * as d3 from 'd3';\nimport { TypeColor } from '@/utils/style';\nconst tableStore = useTableStore();\n\n/*\ninterface TreeNode {\n    [key: string]: any;\n    children?: TreeNode[];\n}\n\nconst data: TreeNode = {\n    name: 'Root',\n    children: [\n        { name: 'Child 1' },\n        {\n            name: 'Child 2',\n            children: [\n                { name: 'Grandchild 1' },\n                { name: 'Grandchild 2' },\n                { name: 'Grandchild 3' },\n            ]\n        }\n    ]\n};\n*/\n\n// const currentInstFlag = ref(false);\n// const disableNextFlag = ref(false);\n// const disableGoToInstFlag = ref(false);\nconst instanceContent = ref(\"\");\nconst menuList = computed(() => tableStore.tree.menuList);\n// const contextMenuVisible = tableStore.tree.contextMenuVisible;\nconst contextMenuVisible = computed(() => tableStore.tree.contextMenuVisible && tableStore.tree.menuList.length > 0);\nconst contextMenuVisibleChange = (value: boolean) => {\n    // if (store.state.selectedNode.length === 0 && value === true) return;\n    // store.commit('setContextMenuVisibility', value);\n    tableStore.tree.contextMenuVisible = value;\n    tableStore.tree.menuList = [];\n    // setTimeout(() => {\n    //     tableStore.tree.menuList = [];\n    // }, 0)\n};\n\nconst closeContextMenu = (e: any) => {\n    // console.log(\"closeContextMenu\", e, e.key);\n    const visNode = tableStore.spec.selectNode!.data;\n    let extract: any = null, extractColor: string = '';\n    let triggerCellCursorFlag = false;\n    let messageInfo = \"\\n Press ESC to cancel the selection mode.\";\n    const maxCNum = tableStore.findMaxCNumber() + 1;\n    switch (e.key) {\n        case \"0\":\n            // Reset Area Logic\n            messageInfo = \"Please reselect the template's area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"1\":\n            // Add Constraints Logic\n            messageInfo = \"Please select the constrained cell in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"2-0\":\n            // Target Cols - Position Based Logic\n            extract = {\n                byPositionToTargetCols: Array.from({ length: visNode.width * visNode.height }, (_, i) => `C${maxCNum + i}`)\n            }\n            extractColor = 'positionShallow';\n            break;\n        case \"2-1\":\n            // Target Cols - Context Based Logic\n            extract = {\n                byContext: {\n                    position: 'above'\n                }\n            }\n            extractColor = 'contextShallow';\n            break;\n        case \"2-2\":\n            // Target Cols - Value Based Logic\n            const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n            }\n            extract = {\n                byValue: createExtract()\n            }\n            extractColor = 'valueShallow';\n            break;\n        case \"2-3\":\n            // Target Cols - No Extract Logic\n            tableStore.insertNodeOrPropertyIntoSpecs(undefined, \"extract\")\n            break;\n        case \"3\":\n            // Add Sub-Template Logic\n            messageInfo = \"Please select an area in the input table.\" + messageInfo;\n            triggerCellCursorFlag = true;\n            break;\n        case \"4\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!);\n            tableStore.stringifySpec();\n            break;\n        case \"5\":\n            tableStore.deleteChildByPath(tableStore.spec.rawSpecs, visNode.path!, tableStore.spec.selectConstrIndex);\n            tableStore.stringifySpec();\n    }\n\n    if (extract !== null) {\n        tableStore.insertNodeOrPropertyIntoSpecs(extract, \"extract\")\n        tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(extract, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), extractColor];\n    }\n    if (triggerCellCursorFlag) {\n        message.info(messageInfo);\n        tableStore.spec.selectAreaFromNode = e.key;\n        document.body.style.cursor = 'cell';\n        document.documentElement.style.setProperty('--custom-cursor', 'cell');\n        const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, tableStore.spec.selectAreaFromLegend);\n        tableStore.highlightTblCells(\"input_tbl\", cells);\n    }\n    tableStore.tree.contextMenuVisible = false;\n}\n\nconst treeContainer = ref<HTMLDivElement | null>(null);\n\nfunction resetZoom() {\n    // drawTree(tableStore.spec.visTree);\n    // c.transition().duration(750)// .call(tableStore.tree.visInst!.zoomfunc as any, d3.zoomIdentity);\n    tableStore.tree.visInst!.resetZoom();\n    // g.matrixtransformzoomsvgsvgtransform\n    d3.select('svg.tbl-container g.left').transition().duration(750)\n        .call(miniZoom!.transform as any, d3.zoomIdentity); // \n    d3.select('svg.tbl-container g.right').transition().duration(750)\n        .call(tempZoom!.transform as any, d3.zoomIdentity); // \n\n}\n\nconst drawTree = (data: any) => {\n    const treeInstance = new TreeChart([2, 1], '.tree-container', data, tableStore, 1.0, 'h');\n    treeInstance.render();\n    tableStore.tree.visInst = treeInstance;\n};\n\nconst typeMap = {\n    \"null\": \"Region\",\n    \"position\": \"Position Based\",\n    \"context\": \"Context Based\",\n    \"value\": \"Value Based\",\n}\nconst selectMatchExtractArea = (type: TypeColor) => {\n    d3.selectAll('.legend').classed('legend-selection', false);\n    d3.select(`.legend.legend-${type}`).classed('legend-selection', true);\n    const selectionsFromLegend = tableStore.spec.selectionsAreaFromLegend;\n    const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n    const cells = tableStore.generateHighlightCells(selectionsFromLegend, selectFromLegend);\n    tableStore.highlightTblCells(\"input_tbl\", cells);\n\n    if (selectFromLegend.length > selectionsFromLegend.length) {\n        selectFromLegend[selectFromLegend.length - 1] = type;\n    } else {\n        selectFromLegend.push(type);\n    }\n    // const cursorStyle = `url(${require('@/assets/cell.png')}), auto`;\n    document.body.style.cursor = 'cell';\n    document.documentElement.style.setProperty('--custom-cursor', 'cell');\n    message.info(\"Now is in \" + typeMap[type as keyof typeof typeMap] + \" mode. Please select the starting area in the input table.\\n Press ESC to cancel the selection mode.\");\n    // tableStore.input_tbl.instance.rootElement.style.cursor = \"cell\";\n    // (document.querySelector('.truncated') as HTMLElement).style.cursor = \"cell\"\n}\n\n\n\nconst tblContainer = ref<SVGSVGElement | null>(null);\n\n/*\nimport { debounce } from 'lodash';\n\n// import { TableCanoniserTemplate } from '@/table-canoniser/dist/grammar';\n\nconst debouncedResize = debounce(() => {\n    drawTree(tableStore.spec.visTree);\n}, 100); // \n\nconst resizeObserver = new ResizeObserver(() => {\n    debouncedResize();\n});\n*/\n\nconst handleFormatter = (v: any) => {\n    // console.log(v, tableStore.output_tbl.tbl.length);\n    // return tableStore.output_tbl.tbl.length === 0 ? '' : isNaN(v) ? 0 : parseInt(v) + 1\n    return tableStore.spec.matchedInstNum === 0 ? '' : isNaN(v) ? 0 : parseInt(v) + 1\n}\n\nconst handleStep = (v: number, info: { offset: number, type: 'up' | 'down' }) => {\n    // :max=\" tableStore.output_tbl.tbl.length> 0 ? tableStore.spec.visTree.children![0].matchs!.length - 1 : 0\"\n    // :min=\"0\"\n    if (info.type === 'up') {\n        if (v <= 1) return;\n        tableStore.goToInstance(v - 2);\n    } else {\n        if (v >= tableStore.spec.visTree.children![0].matchs!.length - 2) return;\n        tableStore.goToInstance(v + 2);\n    }\n}\n\nfunction handleCodeChange(clickFlag = false) {\n    // console.log(\"handleCodeChange: start\", tableStore.editor.mappingSpec.codeUpdateFromEditor);\n    if (tableStore.editor.mappingSpec.codeUpdateFromEditor) {\n        setTimeout(() => {\n            tableStore.editor.mappingSpec.codeUpdateFromEditor = false;\n        }, 600)\n        if (clickFlag) return;\n    }\n    if (tableStore.editor.mappingSpec.code !== tableStore.editor.mappingSpec.instance!.getValue()) {\n        tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.code);\n    }\n    const setFlag = tableStore.prepareDataAfterCodeChange();\n    if (!setFlag) return;\n    if (document.body.style.cursor === 'default') {\n        drawMinimap(tableStore.input_tbl.tbl.length, tableStore.input_tbl.tbl[0].length, tblContainer.value, tableStore);\n    }\n    tableStore.transformTablebyCode();  // auto run\n    if (tableStore.editor.mappingSpec.highlightCode) {\n        // console.log('handleCodeChange-highlightCode', tableStore.editor.mappingSpec.highlightCode);\n        tableStore.highlightCode(...tableStore.editor.mappingSpec.highlightCode);\n        // tableStore.editor.mappingSpec.highlightCode = null;\n    }\n    setTimeout(() => {\n        tableStore.editor.mappingSpec.triggerCodeChange = true;\n    }, 600)\n\n    if (tableStore.spec.matchedInstNum === 0) {\n        instanceContent.value = 'No matched instance';\n        tableStore.tree.instanceIndex = -1;\n    } else {\n        instanceContent.value = 'Total ' + tableStore.spec.matchedInstNum + ' instance(s)';\n    }\n    tableStore.computeColInfo(\"output_tbl\");\n    drawTree(tableStore.spec.visTree); // \n    drawTblTemplate(tblContainer.value, tableStore);\n    // console.log(tableStore.input_tbl.instance.get);\n    // console.log('watch code changed: end');\n    tableStore.optimizeMiniTempDistance();\n    tableStore.updateCurve();\n    // currentInstFlag.value = tableStore.spec.visTree.children!.length > 0 && tableStore.spec.visTree.children![0].matchs !== undefined && tableStore.spec.visTree.children![0].matchs!.length > 0;\n    // disableNextFlag.value = tableStore.spec.selectNode === null || tableStore.spec.visTree.children!.length === 0 || tableStore.spec.visTree.children![0].matchs === undefined || tableStore.tree.instanceIndex === tableStore.spec.visTree.children![0].matchs!.length - 1;\n}\n\n// const debouncedHandleCodeChange = tableStore.debounce(handleCodeChange, 200); // 200ms \n\n\n// Vue 3<script setup>Vue 2 .methods <script setup>methods defineExpose \ndefineExpose({ handleCodeChange });\n\nwatch(() => tableStore.editor.mappingSpec.code, (newVal) => {\n    if (tableStore.editor.mappingSpec.triggerCodeChange) {\n        handleCodeChange()\n    } else if (tableStore.editor.mappingSpec.highlightCode) {\n        tableStore.editor.mappingSpec.instance?.setValue(newVal);\n        tableStore.highlightCode(...tableStore.editor.mappingSpec.highlightCode);\n        tableStore.editor.mappingSpec.triggerCodeChange = true;\n    }\n});\n\nwatch(() => tableStore.tree.instanceIndex, () => {\n    drawTblTemplate(tblContainer.value, tableStore);\n    // disableNextFlag.value = tableStore.spec.selectNode === null || tableStore.spec.visTree.children!.length === 0 || tableStore.spec.visTree.children![0].matchs === undefined || tableStore.tree.instanceIndex === tableStore.spec.visTree.children![0].matchs!.length - 1;\n    tableStore.updateCurve();\n});\n\nimport { drawMinimap, miniZoom } from '@/utils/minimap';\nimport { drawTblTemplate, tempZoom } from '@/utils/template';\nwatch(() => tableStore.input_tbl.tbl, (newVal) => {\n    // console.log('watch: input_tbl changed: start');\n    drawMinimap(newVal.length, newVal[0].length, tblContainer.value, tableStore);\n    tableStore.computeColInfo(\"input_tbl\");\n});  // , { deep: true }\n\n// watch(() => tableStore.output_tbl.tbl, () => {\n//     // console.log('watch: output_tbl changed: start');\n//     tableStore.computeColInfo(\"output_tbl\");\n// }, { deep: true });\n\n// watch(() => tableStore.spec.visTree.size.height, (newVal) => {\n//     console.log('watch tbl size changed: start');\n//     const setFlag = tableStore.prepareDataAfterCodeChange();\n//     if (!setFlag) return;\n//     drawTree(tableStore.spec.visTree);\n//     console.log('watch tbl size changed: end');\n// });\n\n\nonMounted(() => {\n    document.querySelector('span.ant-input-number-handler-up')!.setAttribute(\"title\", \"Previous instance\")\n    document.querySelector('span.ant-input-number-handler-down')!.setAttribute(\"title\", \"Next instance\")\n});\n\n\n\n</script>\n\n<style lang=\"less\">\n.goToInstance {\n    // margin-right: calc(40vw - 430px);\n    width: 58px;\n    margin: 0 6px;\n}\n\n.tree-container {\n    width: 100%;\n    height: 100%;\n\n    .type-node:hover {\n        stroke: var(--color-selection);\n        stroke-width: 3px;\n    }\n\n    .type-node.selection {\n        stroke: var(--color-selection);\n        stroke-width: 3px;\n    }\n}\n\n.tbl-container {\n    width: 100%;\n    height: 100%;\n\n    .mini-temp-line {\n        fill: none;\n        stroke: #0000004D; // var(--color-selectionShallow);\n        stroke-width: 2px;\n    }\n\n    rect.positionShallow {\n        fill: var(--color-positionShallow);\n        stroke: var(--color-positionShallow);\n    }\n\n    rect.position {\n        fill: var(--color-position);\n        stroke: var(--color-position);\n    }\n\n    rect.contextShallow {\n        fill: var(--color-contextShallow);\n        stroke: var(--color-contextShallow);\n    }\n\n    rect.context {\n        fill: var(--color-context);\n        stroke: var(--color-context);\n    }\n\n    rect.valueShallow {\n        fill: var(--color-valueShallow);\n        stroke: var(--color-valueShallow);\n    }\n\n    rect.value {\n        fill: var(--color-value);\n        stroke: var(--color-value);\n    }\n\n    rect.nullShallow {\n        fill: var(--color-nullShallow);\n        stroke: var(--color-nullShallow);\n    }\n\n    rect.null {\n        fill: var(--color-null);\n        stroke: var(--color-null);\n    }\n\n    rect.selectionShallow {\n        fill: var(--color-selectionShallow);\n        stroke: var(--color-selectionShallow);\n    }\n\n    rect.selection {\n        fill: var(--color-selection);\n        stroke: var(--color-selection);\n    }\n\n    .grid-cell {\n        //  rect.grid-cell  rect.selection \n        fill: var(--color-cellFill);\n        stroke: var(--color-cellStroke);\n        stroke-width: 1px;\n    }\n\n    .grid-cell:hover {\n        stroke-width: 2px;\n    }\n\n    .tbl-template-cell:hover {\n        stroke: var(--color-selection);\n        stroke-width: 2px;\n    }\n}\n\n.legend-selection {\n    border-color: #0a58d9 !important; // var(--color-selection);\n}\n\n.legend-null {\n    background: var(--color-null);\n    border-color: var(--color-null);\n    // opacity: 0.5; /*  0.5 */\n}\n\n.legend-position {\n    background: var(--color-position);\n    border-color: var(--color-position);\n}\n\n// .legend-position:hover {\n//     background: var(--color-position) !important;\n// }\n\n.legend-context {\n    background: var(--color-context);\n    border-color: var(--color-context);\n}\n\n.legend-value {\n    background: var(--color-value);\n    border-color: var(--color-value);\n}\n\n.legend {\n    color: white !important;\n    border-width: 2.5px;\n\n    //  span \n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    span {\n        text-align: center;\n        width: 100%;\n        /*  */\n    }\n}\n\n.legend:hover {\n    color: white !important;\n    border-color: #0a58d9 !important;\n}\n</style>","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"wrapper\" }\nconst _hoisted_2 = /*#__PURE__*/_createStaticVNode(\"<div class=\\\"filing-container\\\" style=\\\"display:none;\\\"><span class=\\\"item\\\" id=\\\"busuanzi_container_site_pv\\\"> <span id=\\\"busuanzi_value_site_pv\\\"></span> </span><span class=\\\"item\\\" id=\\\"busuanzi_container_site_uv\\\"> <span id=\\\"busuanzi_value_site_uv\\\"></span> </span><span class=\\\"item\\\" id=\\\"busuanzi_container_page_pv\\\"> <span id=\\\"busuanzi_value_page_pv\\\"></span> </span></div>\", 1)\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_panel_view = _resolveComponent(\"panel-view\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createVNode(_component_panel_view)\n    ]),\n    _hoisted_2\n  ], 64))\n}","<template>\n  <div class=\"wrapper\">\n    <panel-view />\n  </div>\n  <div class=\"filing-container\" style=\"display: none;\">\n    <span class=\"item\" id=\"busuanzi_container_site_pv\">\n      <span id=\"busuanzi_value_site_pv\"></span>\n    </span>\n    <span class=\"item\" id=\"busuanzi_container_site_uv\">\n      <span id=\"busuanzi_value_site_uv\"></span>\n    </span>\n    <span class=\"item\" id=\"busuanzi_container_page_pv\">\n      <span id=\"busuanzi_value_page_pv\"></span>\n    </span>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport PanelView from \"./views/PanelView.vue\";\n\nexport default defineComponent({\n  name: \"overView\",\n  components: {\n    PanelView,\n  },\n});\n</script>\n\n<style lang=\"less\">\n* {\n  margin: 0;\n  padding: 0;\n}\n\n.wrapper {\n  display: flex;\n  flex-flow: column;\n  background-color: #fffffe;\n  height: 100vh;\n  width: 100vw;\n  overflow-x: hidden;\n  overflow-y: hidden;\n}\n</style>\n","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = (n: any) => (_pushScopeId(\"data-v-77dc7f23\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"icons-container\" }\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { style: {\"width\":\"50px\",\"display\":\"inline-block\"} }, null, -1))\nconst _hoisted_3 = { class: \"icon-scroll\" }\nconst _hoisted_4 = [\"src\", \"alt\", \"title\", \"onClick\"]\n\nimport { computed } from 'vue';\nimport stringIcon from '@/assets/string.png';\nimport numberIcon from '@/assets/number.png';\nimport nullIcon from '@/assets/minus.png';\n\nimport { useTableStore } from \"@/store/table\";\n// const { colInfos } = defineProps<{ colInfos: ColInfo[] }>();\ntype IconType = keyof typeof icons;\n\n// Compute sorted column info  tableStore[tblType].colInfo\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ColType',\n  props: {\n    tblType: {}\n  },\n  setup(__props: any) {\n\nconst { tblType } = __props;  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\n// Example data\n// const colInfos = [\n//     { index: 0, string: [0, 1], number: [2], null: [], width: 250 },\n//     { index: 1, string: [], number: [0, 1, 2], null: [1], width: 150 },\n//     { index: 2, string: [0], number: [], null: [1, 2], width: 200 },\n//     { index: 3, string: [0], number: [1], null: [2], width: 300 },\n// ];\n\n// Define icons map\nconst icons = {\n    string: stringIcon,\n    number: numberIcon,\n    none: nullIcon\n};\n\nconst sortedColInfos = computed(() => {\n    return tableStore[tblType].colInfo.map(colInfo => {\n        const iconCounts = [\n            { type: 'string' as IconType, count: colInfo.string.length },\n            { type: 'number' as IconType, count: colInfo.number.length },\n            { type: 'none' as IconType, count: colInfo.none.length }\n        ]\n            .filter(icon => icon.count > 0) // Remove types with zero count\n            .sort((a, b) => b.count - a.count); // Sort by count in descending order\n\n        return {\n            ...colInfo,\n            sortedIcons: iconCounts\n        };\n    });\n});\n\nfunction handleIconClick(col: number, rows: number[]) {\n    const className = 'selection';\n    const cells = rows.map(row => ({ row, col, className }));\n    tableStore.highlightTblCells(tblType, cells, null, true, false);\n    const correspondingTblCells = tableStore.in_out_mapping({ \"0\": cells.map(cell => [cell.row, cell.col]) }, tblType, className);\n\n    if (tblType === \"input_tbl\") {\n        tableStore.highlightMinimapCells(cells);\n        tableStore.highlightTblCells(\"output_tbl\", correspondingTblCells);\n    } else {\n        tableStore.highlightMinimapCells(correspondingTblCells);\n        tableStore.highlightTblCells(\"input_tbl\", correspondingTblCells);\n    }\n}\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _hoisted_2,\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createElementVNode(\"div\", {\n        style: _normalizeStyle({ width: sortedColInfos.value.reduce((sum, colInfo) => sum + colInfo.width, 0) + 'px' })\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(sortedColInfos.value, (colInfo) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            key: colInfo.index,\n            style: _normalizeStyle({ width: colInfo.width + 'px' }),\n            class: \"icon-column\"\n          }, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(colInfo.sortedIcons, (icon) => {\n              return (_openBlock(), _createElementBlock(\"img\", {\n                key: icon.type,\n                src: icons[icon.type],\n                alt: `${icon.type} icon`,\n                class: \"icon\",\n                title: `${icon.count} cell(s) with a data type of ${icon.type}`,\n                onClick: ($event: any) => (handleIconClick(colInfo.index, colInfo[icon.type]))\n              }, null, 8, _hoisted_4))\n            }), 128))\n          ], 4))\n        }), 128))\n      ], 4)\n    ])\n  ]))\n}\n}\n\n})","<template>\n    <div class=\"icons-container\">\n        <div style=\"width: 50px; display: inline-block;\"></div>\n        <div class=\"icon-scroll\">\n            <div :style=\"{ width: sortedColInfos.reduce((sum, colInfo) => sum + colInfo.width, 0) + 'px' }\">\n                <div v-for=\"colInfo in sortedColInfos\" :key=\"colInfo.index\" :style=\"{ width: colInfo.width + 'px' }\"\n                    class=\"icon-column\">\n                    <img v-for=\"icon in colInfo.sortedIcons\" :key=\"icon.type\" :src=\"icons[icon.type]\"\n                        :alt=\"`${icon.type} icon`\" class=\"icon\"\n                        :title=\"`${icon.count} cell(s) with a data type of ${icon.type}`\"\n                        @click=\"handleIconClick(colInfo.index, colInfo[icon.type])\" />\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue';\nimport stringIcon from '@/assets/string.png';\nimport numberIcon from '@/assets/number.png';\nimport nullIcon from '@/assets/minus.png';\n\nimport { useTableStore } from \"@/store/table\";\n// const { colInfos } = defineProps<{ colInfos: ColInfo[] }>();\nconst { tblType } = defineProps<{ tblType: \"input_tbl\" | \"output_tbl\" }>();  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\n// Example data\n// const colInfos = [\n//     { index: 0, string: [0, 1], number: [2], null: [], width: 250 },\n//     { index: 1, string: [], number: [0, 1, 2], null: [1], width: 150 },\n//     { index: 2, string: [0], number: [], null: [1, 2], width: 200 },\n//     { index: 3, string: [0], number: [1], null: [2], width: 300 },\n// ];\n\n// Define icons map\nconst icons = {\n    string: stringIcon,\n    number: numberIcon,\n    none: nullIcon\n};\n\ntype IconType = keyof typeof icons;\n\n// Compute sorted column info  tableStore[tblType].colInfo\nconst sortedColInfos = computed(() => {\n    return tableStore[tblType].colInfo.map(colInfo => {\n        const iconCounts = [\n            { type: 'string' as IconType, count: colInfo.string.length },\n            { type: 'number' as IconType, count: colInfo.number.length },\n            { type: 'none' as IconType, count: colInfo.none.length }\n        ]\n            .filter(icon => icon.count > 0) // Remove types with zero count\n            .sort((a, b) => b.count - a.count); // Sort by count in descending order\n\n        return {\n            ...colInfo,\n            sortedIcons: iconCounts\n        };\n    });\n});\n\nfunction handleIconClick(col: number, rows: number[]) {\n    const className = 'selection';\n    const cells = rows.map(row => ({ row, col, className }));\n    tableStore.highlightTblCells(tblType, cells, null, true, false);\n    const correspondingTblCells = tableStore.in_out_mapping({ \"0\": cells.map(cell => [cell.row, cell.col]) }, tblType, className);\n\n    if (tblType === \"input_tbl\") {\n        tableStore.highlightMinimapCells(cells);\n        tableStore.highlightTblCells(\"output_tbl\", correspondingTblCells);\n    } else {\n        tableStore.highlightMinimapCells(correspondingTblCells);\n        tableStore.highlightTblCells(\"input_tbl\", correspondingTblCells);\n    }\n}\n</script>\n\n<style scoped>\n.icons-container {\n    width: 100%;\n    height: 18px;\n    /*  .parent  .grandparent  */\n    /* overflow: auto; */\n    /*  */\n    /* white-space: nowrap; */\n    /*  */\n    /* flex-shrink: 0; */\n    /*  .parent  */\n}\n\n.icon-column {\n    display: inline-block;\n    text-align: center;\n    /* align-items: center; The display: inline-block property prevents align-items from having an effect. */\n    /* Center icons vertically within the column */\n}\n\n.icon-scroll {\n    display: inline-block;\n    width: calc(100% - 50px);\n    overflow: auto;\n\n    -ms-overflow-style: none;\n    /* IE 10+ */\n    scrollbar-width: none;\n    /* Firefox */\n}\n\n.icon-scroll::-webkit-scrollbar {\n    display: none;\n}\n\n.icon {\n    width: 13px;\n    /* Set appropriate icon size */\n    height: 13px;\n    margin: 0 1px;\n    cursor: pointer;\n    /* Horizontal spacing between icons */\n}\n\n.icon:hover {\n    width: 14px;\n    height: 14px;\n}\n</style>","import script from \"./ColType.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ColType.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ColType.vue?vue&type=style&index=0&id=77dc7f23&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-77dc7f23\"]])\n\nexport default __exports__","const lastEl = {\n  ele: undefined as HTMLElement | undefined,\n  width: 0,\n  height: 0,\n  flex: 1\n}\nconst nextEl = {\n  ele: undefined as HTMLElement | undefined,\n  width: 0,\n  height: 0,\n  flex: 1\n}\nlet flexSum = 0;\nlet startX: number;\nlet startY: number;\nlet dragging: \"\" | \"width\" | \"height\" = \"\";\n\nfunction getNeighborEls(e: MouseEvent, draggingType: \"\" | \"width\" | \"height\") {\n  const dividerEl = e.target as HTMLElement;\n  const siblingElements = Array.from(dividerEl.parentElement!.children) as HTMLElement[];\n  const currentIndex = siblingElements.indexOf(dividerEl);\n  lastEl.ele = siblingElements[currentIndex - 1];\n  lastEl.width = lastEl.ele.getBoundingClientRect().width;\n  lastEl.height = lastEl.ele.getBoundingClientRect().height;\n  lastEl.flex = parseFloat(lastEl.ele.style.flex || \"1\");\n  nextEl.ele = siblingElements[currentIndex + 1];\n  nextEl.width = nextEl.ele.getBoundingClientRect().width;\n  nextEl.height = nextEl.ele.getBoundingClientRect().height;\n  nextEl.flex = parseFloat(nextEl.ele.style.flex || \"1\");\n\n  flexSum = lastEl.flex + nextEl.flex;\n  dragging = draggingType;\n  startX = e.clientX;\n  startY = e.clientY;\n}\n\n\nfunction onDrag(e: MouseEvent) {\n\n  if (!dragging || lastEl.ele === undefined || nextEl.ele === undefined) {\n    return;\n  }\n\n  const move = dragging === \"width\" ? e.clientX - startX : e.clientY - startY;\n  const newLastW_H = lastEl[dragging] + move;\n  const newNextW_H = nextEl[dragging] - move;\n  const newLastRate = newLastW_H / (lastEl[dragging] + nextEl[dragging]);\n  const newNextRate = newNextW_H / (lastEl[dragging] + nextEl[dragging]);\n\n  const newLastFlex = newLastRate * flexSum;\n  const newNextFlex = newNextRate * flexSum;\n\n  lastEl.ele.style.flex = `${newLastFlex}`;\n  nextEl.ele.style.flex = `${newNextFlex}`;\n}\n\nfunction endDrag() {\n  dragging = \"\";\n}\n\nexport { getNeighborEls, onDrag, endDrag }","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, unref as _unref, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"view\" }\nconst _hoisted_2 = { class: \"view-title\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { class: \"head-text\" }, \"Input Table\", -1)\nconst _hoisted_4 = { style: {\"float\":\"right\",\"margin-right\":\"10px\"} }\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Upload\", -1)\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Reset Data\", -1)\nconst _hoisted_7 = { class: \"view-content\" }\nconst _hoisted_8 = {\n  id: \"output-tbl\",\n  style: {\"height\":\"calc(100% - 28px)\",\"overflow\":\"hidden\"}\n}\nconst _hoisted_9 = { class: \"view\" }\nconst _hoisted_10 = { class: \"view-title\" }\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Output Table\", -1)\nconst _hoisted_12 = { style: {\"float\":\"right\",\"margin-right\":\"10px\"} }\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Download\", -1)\nconst _hoisted_14 = { class: \"view-content\" }\nconst _hoisted_15 = {\n  id: \"output-tbl\",\n  style: {\"height\":\"calc(100% - 28px)\",\"overflow\":\"hidden\"}\n}\n\nimport {\n  getCurrentInstance,\n  ComponentPublicInstance,\n  ref,\n  onMounted,\n  watch,\n} from \"vue\";\nimport ColType from \"@/components/ColType.vue\";\nimport { HotTable } from \"@handsontable/vue3\";\nimport \"handsontable/dist/handsontable.full.css\";\nimport { registerAllModules } from \"handsontable/registry\";\nimport Handsontable from \"handsontable\";\nimport { useTableStore, Selection } from \"@/store/table\";\n// import Papa from 'papaparse';  // parse csv data\nimport * as XLSX from 'xlsx';  // parse excel data\nimport { Table2D, TableCanoniserTemplate } from \"@/table-canoniser/dist/grammar\"\nimport { message } from \"ant-design-vue\";\nimport { getNeighborEls } from '@/utils/dragLayout';\n\n// import { ArrowUpTrayIcon } from '@heroicons/vue/24/solid'\n\n// register Handsontable's modules\nimport { drawMinimap } from '@/utils/minimap';\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'InOutTable',\n  setup(__props) {\n\nregisterAllModules();\n\nconst tableStore = useTableStore();\n// const tblCases: { [key: string]: TblVisData } = tableStore.cases;\n\nconst output_col = ref(tableStore.output_tbl.cols);\nconst output_tbl = ref(tableStore.output_tbl.tbl);\nconst input_tbl = ref(tableStore.input_tbl.tbl);\n\nlet inHotInst: Handsontable;\nlet outHotInst: Handsontable;\n\nfunction renderTblCell(instance: Handsontable,\n  td: HTMLElement,\n  row: number,\n  col: number,\n  prop: any,\n  value: any,\n  cellProperties: any) {\n  // @ts-ignore\n  Handsontable.renderers.TextRenderer.apply(this, arguments);\n  td.innerHTML = `<div class=\"truncated\">${value}</div>`\n}\n\nfunction updateColInfoFn(tbl: \"input_tbl\" | \"output_tbl\") {\n  if (tbl === \"input_tbl\") {\n    const tblData = tableStore.input_tbl.tbl;\n    drawMinimap(tblData.length, tblData[0].length, document.querySelector('svg.tbl-container') as SVGSVGElement, tableStore);\n    tableStore.optimizeMiniTempDistance();\n    tableStore.clearStatus(\"miniHighlight\");\n    tableStore.initTblInfo(false);\n    // tableStore.computeColInfo(\"output_tbl\");\n    tableStore.output_tbl.colInfo = [];\n    tableStore.spec.matchedInstNum = 0;\n  }\n  tableStore.computeColInfo(tbl);\n}\n\nfunction resetData() {\n  tableStore.input_tbl.tbl = JSON.parse(JSON.stringify(tableStore.currentInitData));\n  tableStore.input_tbl.instance.updateData(tableStore.input_tbl.tbl);\n  tableStore.input_tbl.instance.render();\n  updateColInfoFn(\"input_tbl\");\n}\n\n// const handleUploadChange = (info: any) => {\n//   if (info.file.status === 'done') {\n//     message.success(`${info.file.name} file uploaded successfully`);\n//   } else if (info.file.status === 'error') {\n//     message.error(`${info.file.name} file upload failed.`);\n//   }\n// };\n\nconst fileList = ref([]);\n// const fileList = ref<UploadProps['fileList']>([{\n//     uid: '1',\n//     name: 'xxx.png',\n//     status: 'done',\n//     response: 'Server Error 500', // custom error message to show\n//     url: 'http://www.baidu.com/xxx.png',\n//   },]);\nlet fileTblData: Table2D = [];\n\nconst handleUpload = (request: any) => {\n  // console.log(request.file);\n  // setTimeout(() => {\n  //   request.onSuccess(\"ok\");\n  // }, 0);\n  try {\n    const reader = new FileReader();\n    // if (request.file.type === 'text/csv' || request.file.type === 'text/plain') {\n    //   reader.onload = (e) => {\n    //     console.log(e);\n    //     const data = e.target?.result;\n    //     parseCsvData(data as string);\n    //   }\n    //   reader.readAsText(request.file);\n    // } else if (request.file.type.endsWith('sheet') || request.file.type.endsWith('excel')) {\n\n    reader.onload = (e) => {\n      const arrayBuffer = e.target?.result;\n      const workbook = XLSX.read(arrayBuffer, { type: 'array' });\n      const firstSheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[firstSheetName];\n      const rawData: Table2D = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n      // Determine the maximum number of columns\n      const maxColumns = Math.max(...rawData.map(row => row.length));\n\n      // Ensure all rows have the same number of columns\n      fileTblData = rawData.map(row => {\n        while (row.length < maxColumns) {\n          row.push(undefined); // Fill missing cells with an empty string or a placeholder\n        }\n        return row;\n      });\n      handlePreview()\n      request.onSuccess(\"ok\");\n      // message.success(`${request.file.name} file uploaded successfully`);\n    };\n    reader.readAsArrayBuffer(request.file);\n  } catch (error) {\n    message.error(`${request.file.name} file uploaded failed.\\n${error}`);\n  }\n};\n\nlet saveLastCase = \"\"\n\nconst handleRemove = () => {\n  tableStore.initTblInfo()\n  tableStore.transformTblUpdateRootArea();\n  tableStore.currentCase = saveLastCase ? saveLastCase : tableStore.caseList[0];\n  saveLastCase = \"\"\n  tableStore.caseList.pop();\n};\n\nconst handlePreview = () => {\n  // executed when file link or preview icon is clicked.\n  tableStore.initTblInfo()\n  tableStore.input_tbl.tbl = fileTblData;\n  tableStore.input_tbl.instance.updateData(fileTblData);\n  tableStore.input_tbl.instance.render();\n  tableStore.currentInitData = JSON.parse(JSON.stringify(fileTblData));\n  tableStore.transformTblUpdateRootArea();\n  if (!tableStore.currentCase.startsWith(\"Custom\")) {\n    saveLastCase = tableStore.currentCase\n  }\n  if (!tableStore.caseList.includes(\"Custom File\")) {\n    tableStore.caseList.push(\"Custom File\");\n  }\n  tableStore.currentCase = \"Custom File\";\n};\n\nwatch(() => tableStore.currentCase, (newVal) => {\n  if (newVal.startsWith(\"Custom\")) handlePreview();\n  else tableStore.loadCaseData(newVal);\n});\n\n\n//  CSV \nfunction arrayToCSV(array: Table2D) {\n  return array.map(row => row.map(cell => `${cell === undefined ? '' : cell}`).join(',')).join('\\n');\n}\n\nconst handleDownload = () => {\n  if (tableStore.output_tbl.cols.length === 0) {\n    message.warning('The output table is empty.');\n    return;\n  }\n  const csv = arrayToCSV([tableStore.output_tbl.cols, ...tableStore.output_tbl.tbl]);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = 'tidy table.csv'; // \n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url); // \n\n  message.success('The output table has been downloaded successfully.');\n};\n\nfunction normalizeSelection(selections: Selection[]): Selection[] {\n  return selections.map(([row1, col1, row2, col2]) => {\n    // 0\n    if (row1 < 0) row1 = 0;\n    if (col1 < 0) col1 = 0;\n    if (row2 < 0) row2 = 0;\n    if (col2 < 0) col2 = 0;\n\n    // startRow <= endRow  startCol <= endCol\n    const startRow = Math.min(row1, row2);\n    const endRow = Math.max(row1, row2);\n    const startCol = Math.min(col1, col2);\n    const endCol = Math.max(col1, col2);\n\n    return [startRow, startCol, endRow, endCol];\n  });\n}\n\nfunction initEventsForTbl(tbl: \"input_tbl\" | \"output_tbl\") {\n  let tblInst1: Handsontable, tblInst2: Handsontable;\n  const tbl2 = tbl === \"input_tbl\" ? \"output_tbl\" : \"input_tbl\";\n  if (tbl === \"input_tbl\") {\n    tblInst1 = inHotInst;\n    tblInst2 = outHotInst;\n  } else {\n    tblInst1 = outHotInst;\n    tblInst2 = inHotInst;\n  }\n  tblInst1.updateSettings({\n    outsideClickDeselects: (targetEle) => {\n      const targetClassName = targetEle?.className;\n      // if ((targetEle.parentNode?.parentNode as HTMLElement).classList.contains(\"goToInstance\") || (targetEle.parentNode as HTMLElement).classList.contains(\"goToInstance\"))\n      if (targetEle.closest(\".goToInstance\") !== null) {\n        if (document.body.style.cursor === 'cell') {\n          tableStore.clearStatus(\"matchArea\");\n        }\n        return true;\n      };\n      if (targetClassName === \"wtHolder\") {\n        return true;\n      }\n      if (typeof targetClassName !== \"string\") {\n        tblInst2.updateSettings({ cell: [] });\n        return true;\n      }\n      if (tblInst1 === outHotInst && [\"relative\", \"rowHeader\", \"current\", \"truncated\"].some((c) => targetClassName.split(\" \").includes(c))) {\n        //  input \n        if (document.body.style.cursor !== 'cell') {\n          tblInst2.updateSettings({ cell: [] });\n        }\n      } else {\n        tableStore.clearStatus(\"matchArea\");\n        tblInst2.updateSettings({ cell: [] });\n      }\n      tableStore.highlightMinimapCells([]);\n      tableStore.clearStatus(\"tree\");\n\n      if (tbl === \"input_tbl\") {\n        if (!(targetClassName.startsWith(\"mtk\") || targetClassName === \"view-line\"))\n          tableStore.editor.mappingSpec.decorations?.clear();\n      }\n\n      return true;\n    },\n  });\n\n  tblInst1.addHook(\"afterColumnResize\", (currentColumn, newSize, isDoubleClick) => {\n    // \n    tableStore.computeColInfo(tbl);\n  });\n  // tbl\n  tblInst1.addHook(\"afterChange\", (changes, source) => {\n    // \n    if (changes) {\n      if (tbl === \"input_tbl\") {\n        tableStore.clearStatus(\"miniHighlight\");\n        tableStore.initTblInfo(false);\n        tableStore.computeColInfo(\"output_tbl\");\n        tableStore.spec.matchedInstNum = 0;\n      }\n      tableStore.computeColInfo(tbl);\n    }\n  });\n  tblInst1.addHook(\"afterCreateRow\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterCreateCol\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterRemoveRow\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterRemoveCol\", () => updateColInfoFn(tbl));\n\n  tblInst1.addHook(\"afterOnCellMouseDown\", (e) => {\n    tblInst2.updateSettings({ cell: [] });\n  });\n  tblInst1.addHook(\"afterOnCellMouseUp\", (event, coords, TD) => {\n    const selected = normalizeSelection(tblInst1.getSelected() || []);\n    // key value \n    const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(selected);\n\n    // \n    // console.log(selectedCoords);\n\n    const cells = tableStore.in_out_mapping(selectedCoords, tbl);\n    tableStore.highlightTblCells(tbl2, cells);\n    // tableStore.highlightMinimapCells([{ ...coords, className: \"posi-mapping\" }]);\n\n    if (tbl === \"input_tbl\") {\n      tableStore.highlightMinimapCells(hightedCells);\n      // console.log(document.body.style.cursor, tableStore.spec.selectAreaFromNode, tableStore.spec.selectAreaFromLegend.length);\n      if (document.body.style.cursor === 'cell') {\n        if (tableStore.spec.selectAreaFromNode) {\n          // \n          tableStore.tree.instanceIndex = 0;\n          tableStore.updateVisTreeAreaBox();\n          const selectType = tableStore.spec.selectAreaFromNode;\n          const visNode = selectType === \"0\" ? tableStore.spec.selectNode!.parent!.data : tableStore.spec.selectNode!.data;\n          const nx = visNode.x, ny = visNode.y, nw = visNode.width, nh = visNode.height;\n          const [startRow, startCol, endRow, endCol] = selected[0];\n          const offsetX = startCol - nx, offsetY = startRow - ny;\n          let match: TableCanoniserTemplate[\"match\"] = {};\n          switch (selectType) {\n            case \"0\":\n            // Reset Area Logic\n            case \"3\":\n              // Add Sub-Template Logic\n              const width = endCol - startCol + 1;\n              const height = endRow - startRow + 1;\n              const traverse = {\n                xDirection: nw >= 2 * width ? 'after' as const : undefined,\n                yDirection: nh >= 2 * height ? 'after' as const : undefined\n              }\n              match = {\n                startCell: {\n                  // offsetLayer: \"current\",\n                  // offsetFrom: \"topLeft\",\n                  offsetX: offsetX,\n                  offsetY: offsetY\n                },\n                size: { width, height },\n                traverse\n              }\n              if (selectType === \"0\") {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"match\");\n                const currentSpec = tableStore.getNodebyPath(tableStore.spec.rawSpecs, tableStore.spec.selectNode!.data.path!) as TableCanoniserTemplate;\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(currentSpec.match, currentSpec), `${tableStore.spec.selectNode!.data.type}Shallow`];\n              } else {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"children\");\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine({ match: match }), 'nullShallow'];\n              }\n              break;\n            case \"1\":\n              // Add Constraints Logic\n              const cellValue = inHotInst.getDataAtCell(startRow, startCol);\n              match = {\n                constraints: [{\n                  offsetX: offsetX,\n                  offsetY: offsetY,\n                  valueCstr: tableStore.getCellDataType(cellValue) // TableCanoniserKeyWords.String,\n                }]\n              }\n              const constraint = match.constraints![0]\n              tableStore.insertNodeOrPropertyIntoSpecs(constraint, \"constraints\");\n              tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(constraint, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), `${visNode.type}Shallow`];\n              break;\n          }\n          tableStore.spec.selectAreaFromNode = \"\";\n          tableStore.clearStatus(\"matchArea\");\n          /*\n          const areaConfig = tableStore.spec.areaConfig;\n          areaConfig.match!.startCell = {\n            offsetLayer: \"root\",\n            offsetFrom: \"topLeft\",\n            offsetX: selected[0][1] < 0 ? 0 : selected[0][1],\n            offsetY: selected[0][0] < 0 ? 0 : selected[0][0]\n          }\n          areaConfig.match!.size = {\n            width: selected[0][3] - selected[0][1] + 1,\n            height: selected[0][2] - selected[0][0] + 1\n          }\n          areaConfig.match!.traverse = {\n            xDirection: \"after\",\n            yDirection: \"after\"\n          }\n          const areaFormData = tableStore.spec.areaFormData;\n          areaFormData.offsetLayer = areaConfig.match!.startCell?.offsetLayer;\n          areaFormData.offsetFrom = areaConfig.match!.startCell?.offsetFrom;\n          areaFormData.position = {\n            x: areaConfig.match!.startCell?.offsetX,\n            y: areaConfig.match!.startCell?.offsetY\n          }\n          areaFormData.traverse = {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n          }\n          areaFormData.size = {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n          }\n          tableStore.spec.dragConfigOpen = true;\n          */\n        } else if (tableStore.spec.selectAreaFromLegend.length) {\n          // legend\n          inHotInst.updateSettings({ cell: [] });\n          const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n          tableStore.spec.selectionsAreaFromLegend.push(selected[0]);\n          tableStore.spec.selectionsPath.push([]);\n          if (selectFromLegend.length < tableStore.spec.selectionsAreaFromLegend.length) {\n            selectFromLegend.push(selectFromLegend[selectFromLegend.length - 1])\n          }\n          const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, selectFromLegend);\n          tableStore.highlightTblCells(tbl, cells);\n          // document.body.style.cursor = 'default';\n          // document.documentElement.style.setProperty('--custom-cursor', 'default');\n\n          const { specs, newSpec } = tableStore.buildTree(tableStore.spec.selectionsAreaFromLegend, selectFromLegend, tableStore.spec.selectionsPath);\n\n          tableStore.stringifySpec(specs);\n          tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(newSpec, null, specs), `${selectFromLegend[selectFromLegend.length - 1]}Shallow`];\n        }\n      }\n\n      tableStore.highlightNodes(selected);\n    } else {\n      tableStore.highlightMinimapCells(cells);\n    }\n  });\n}\n\nonMounted(() => {\n\n  const proxy = getCurrentInstance()?.proxy as ComponentPublicInstance;\n  inHotInst = (proxy.$refs.inputTbl as any).hotInstance as Handsontable;\n  outHotInst = (proxy.$refs.outputTbl as any).hotInstance as Handsontable;\n\n  tableStore.input_tbl.instance = inHotInst;\n  tableStore.output_tbl.instance = outHotInst;\n\n  initEventsForTbl(\"input_tbl\");\n  initEventsForTbl(\"output_tbl\");\n\n  // keepIconsSynchronizedWithTable() { },\n  const iconScrolls = document.querySelectorAll('.icons-container .icon-scroll');\n  const tblScrolls = document.querySelectorAll('.ht_master .wtHolder');\n\n  iconScrolls.forEach((iconScroll, index) => {\n    iconScroll.addEventListener('scroll', () => {\n      tblScrolls[index].scrollLeft = iconScroll.scrollLeft;\n    });\n\n    tblScrolls[index].addEventListener('scroll', () => {\n      iconScroll.scrollLeft = tblScrolls[index].scrollLeft;\n    });\n  })\n});\n\n// function showDropdown() {\n//   //   isOpen = true;\n// }\n// function hideDropdown() {\n//   //   isOpen = false;\n// }\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_upload = _resolveComponent(\"a-upload\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _hoisted_3,\n        _createElementVNode(\"span\", _hoisted_4, [\n          _createVNode(_component_a_upload, {\n            \"file-list\": fileList.value,\n            \"onUpdate:fileList\": _cache[0] || (_cache[0] = ($event: any) => ((fileList).value = $event)),\n            \"max-count\": 1,\n            accept: \".csv, .txt, .xls, .xlsx\",\n            customRequest: handleUpload,\n            onRemove: handleRemove,\n            onPreview: handlePreview,\n            showUploadList: {\n            showRemoveIcon: true,\n          }\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_button, { size: \"small\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_v_icon, {\n                    name: \"bi-upload\",\n                    scale: \"0.85\"\n                  }),\n                  _hoisted_5\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }, 8, [\"file-list\"]),\n          _createVNode(_component_a_button, {\n            style: {\"margin-left\":\"5px\"},\n            size: \"small\",\n            onClick: resetData\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, {\n                name: \"bi-arrow-clockwise\",\n                scale: \"0.9\"\n              }),\n              _hoisted_6\n            ]),\n            _: 1\n          })\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_7, [\n        _createVNode(ColType, { tblType: \"input_tbl\" }),\n        _createElementVNode(\"div\", _hoisted_8, [\n          _createVNode(_unref(HotTable), {\n            ref: \"inputTbl\",\n            data: input_tbl.value,\n            rowHeaders: true,\n            colHeaders: true,\n            manualColumnResize: true,\n            autoWrapRow: true,\n            autoWrapCol: true,\n            contextMenu: true,\n            renderer: renderTblCell,\n            licenseKey: \"non-commercial-and-evaluation\"\n          }, null, 8, [\"data\"])\n        ])\n      ])\n    ]),\n    _createElementVNode(\"div\", {\n      class: \"divider-w\",\n      onMousedown: _cache[1] || (_cache[1] = ($event: any) => (_unref(getNeighborEls)($event, 'width'))),\n      title: \"Drag to resize\"\n    }, null, 32),\n    _createElementVNode(\"div\", _hoisted_9, [\n      _createElementVNode(\"div\", _hoisted_10, [\n        _hoisted_11,\n        _createElementVNode(\"span\", _hoisted_12, [\n          _createVNode(_component_a_button, {\n            size: \"small\",\n            onClick: handleDownload\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_v_icon, {\n                name: \"bi-download\",\n                scale: \"0.85\"\n              }),\n              _hoisted_13\n            ]),\n            _: 1\n          })\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_14, [\n        _createVNode(ColType, { tblType: \"output_tbl\" }),\n        _createElementVNode(\"div\", _hoisted_15, [\n          _createVNode(_unref(HotTable), {\n            ref: \"outputTbl\",\n            data: output_tbl.value,\n            rowHeaders: true,\n            colHeaders: output_col.value,\n            manualColumnResize: true,\n            renderer: renderTblCell,\n            contextMenu: true,\n            autoWrapRow: true,\n            autoWrapCol: true,\n            licenseKey: \"non-commercial-and-evaluation\"\n          }, null, 8, [\"data\", \"colHeaders\"])\n        ])\n      ])\n    ])\n  ], 64))\n}\n}\n\n})","<template>\n  <div class=\"view\">\n    <div class=\"view-title\">\n      <span class=\"head-text\">Input Table</span>\n      <span style=\"float: right; margin-right: 10px\">\n        <a-upload v-model:file-list=\"fileList\" :max-count=\"1\" accept=\".csv, .txt, .xls, .xlsx\"\n          :customRequest=\"handleUpload\" @remove=\"handleRemove\" @preview=\"handlePreview\" :showUploadList=\"{\n            showRemoveIcon: true,\n          }\">\n          <a-button size=\"small\">\n            <v-icon name=\"bi-upload\" scale=\"0.85\" />\n            <span>Upload</span>\n          </a-button>\n        </a-upload>\n        <a-button style=\"margin-left: 5px;\" size=\"small\" @click=\"resetData\">\n          <v-icon name=\"bi-arrow-clockwise\" scale=\"0.9\"></v-icon>\n          <span>Reset Data</span>\n        </a-button>\n      </span>\n    </div>\n    <div class=\"view-content\">\n      <ColType tblType=\"input_tbl\" />\n      <div id=\"output-tbl\" style=\"height: calc(100% - 28px); overflow: hidden;\">\n        <hot-table ref=\"inputTbl\" :data=\"input_tbl\" :rowHeaders=\"true\" :colHeaders=\"true\" :manualColumnResize=\"true\"\n          :autoWrapRow=\"true\" :autoWrapCol=\"true\" :contextMenu=\"true\" :renderer=\"renderTblCell\"\n          licenseKey=\"non-commercial-and-evaluation\"></hot-table>\n      </div>\n    </div>\n  </div>\n  <div class=\"divider-w\" @mousedown=\"getNeighborEls($event, 'width')\" title=\"Drag to resize\"></div>\n  <div class=\"view\">\n    <div class=\"view-title\">\n      <span>Output Table</span>\n      <span style=\"float: right; margin-right: 10px\">\n        <a-button size=\"small\" @click=\"handleDownload\">\n          <v-icon name=\"bi-download\" scale=\"0.85\"></v-icon>\n          <span>Download</span>\n        </a-button>\n      </span>\n    </div>\n    <div class=\"view-content\">\n      <ColType tblType=\"output_tbl\" />\n      <div id=\"output-tbl\" style=\"height: calc(100% - 28px); overflow: hidden;\">\n        <hot-table ref=\"outputTbl\" :data=\"output_tbl\" :rowHeaders=\"true\" :colHeaders=\"output_col\"\n          :manualColumnResize=\"true\" :renderer=\"renderTblCell\" :contextMenu=\"true\" :autoWrapRow=\"true\"\n          :autoWrapCol=\"true\" licenseKey=\"non-commercial-and-evaluation\"></hot-table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  getCurrentInstance,\n  ComponentPublicInstance,\n  ref,\n  onMounted,\n  watch,\n} from \"vue\";\nimport ColType from \"@/components/ColType.vue\";\nimport { HotTable } from \"@handsontable/vue3\";\nimport \"handsontable/dist/handsontable.full.css\";\nimport { registerAllModules } from \"handsontable/registry\";\nimport Handsontable from \"handsontable\";\nimport { useTableStore, Selection } from \"@/store/table\";\n// import Papa from 'papaparse';  // parse csv data\nimport * as XLSX from 'xlsx';  // parse excel data\nimport { Table2D, TableCanoniserTemplate } from \"@/table-canoniser/dist/grammar\"\nimport { message } from \"ant-design-vue\";\nimport { getNeighborEls } from '@/utils/dragLayout';\n\n// import { ArrowUpTrayIcon } from '@heroicons/vue/24/solid'\n\n// register Handsontable's modules\nregisterAllModules();\n\nconst tableStore = useTableStore();\n// const tblCases: { [key: string]: TblVisData } = tableStore.cases;\n\nconst output_col = ref(tableStore.output_tbl.cols);\nconst output_tbl = ref(tableStore.output_tbl.tbl);\nconst input_tbl = ref(tableStore.input_tbl.tbl);\n\nlet inHotInst: Handsontable;\nlet outHotInst: Handsontable;\n\nfunction renderTblCell(instance: Handsontable,\n  td: HTMLElement,\n  row: number,\n  col: number,\n  prop: any,\n  value: any,\n  cellProperties: any) {\n  // @ts-ignore\n  Handsontable.renderers.TextRenderer.apply(this, arguments);\n  td.innerHTML = `<div class=\"truncated\">${value}</div>`\n}\n\nfunction updateColInfoFn(tbl: \"input_tbl\" | \"output_tbl\") {\n  if (tbl === \"input_tbl\") {\n    const tblData = tableStore.input_tbl.tbl;\n    drawMinimap(tblData.length, tblData[0].length, document.querySelector('svg.tbl-container') as SVGSVGElement, tableStore);\n    tableStore.optimizeMiniTempDistance();\n    tableStore.clearStatus(\"miniHighlight\");\n    tableStore.initTblInfo(false);\n    // tableStore.computeColInfo(\"output_tbl\");\n    tableStore.output_tbl.colInfo = [];\n    tableStore.spec.matchedInstNum = 0;\n  }\n  tableStore.computeColInfo(tbl);\n}\n\nfunction resetData() {\n  tableStore.input_tbl.tbl = JSON.parse(JSON.stringify(tableStore.currentInitData));\n  tableStore.input_tbl.instance.updateData(tableStore.input_tbl.tbl);\n  tableStore.input_tbl.instance.render();\n  updateColInfoFn(\"input_tbl\");\n}\n\n// const handleUploadChange = (info: any) => {\n//   if (info.file.status === 'done') {\n//     message.success(`${info.file.name} file uploaded successfully`);\n//   } else if (info.file.status === 'error') {\n//     message.error(`${info.file.name} file upload failed.`);\n//   }\n// };\n\nconst fileList = ref([]);\n// const fileList = ref<UploadProps['fileList']>([{\n//     uid: '1',\n//     name: 'xxx.png',\n//     status: 'done',\n//     response: 'Server Error 500', // custom error message to show\n//     url: 'http://www.baidu.com/xxx.png',\n//   },]);\nlet fileTblData: Table2D = [];\n\nconst handleUpload = (request: any) => {\n  // console.log(request.file);\n  // setTimeout(() => {\n  //   request.onSuccess(\"ok\");\n  // }, 0);\n  try {\n    const reader = new FileReader();\n    // if (request.file.type === 'text/csv' || request.file.type === 'text/plain') {\n    //   reader.onload = (e) => {\n    //     console.log(e);\n    //     const data = e.target?.result;\n    //     parseCsvData(data as string);\n    //   }\n    //   reader.readAsText(request.file);\n    // } else if (request.file.type.endsWith('sheet') || request.file.type.endsWith('excel')) {\n\n    reader.onload = (e) => {\n      const arrayBuffer = e.target?.result;\n      const workbook = XLSX.read(arrayBuffer, { type: 'array' });\n      const firstSheetName = workbook.SheetNames[0];\n      const worksheet = workbook.Sheets[firstSheetName];\n      const rawData: Table2D = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n      // Determine the maximum number of columns\n      const maxColumns = Math.max(...rawData.map(row => row.length));\n\n      // Ensure all rows have the same number of columns\n      fileTblData = rawData.map(row => {\n        while (row.length < maxColumns) {\n          row.push(undefined); // Fill missing cells with an empty string or a placeholder\n        }\n        return row;\n      });\n      handlePreview()\n      request.onSuccess(\"ok\");\n      // message.success(`${request.file.name} file uploaded successfully`);\n    };\n    reader.readAsArrayBuffer(request.file);\n  } catch (error) {\n    message.error(`${request.file.name} file uploaded failed.\\n${error}`);\n  }\n};\n\nlet saveLastCase = \"\"\n\nconst handleRemove = () => {\n  tableStore.initTblInfo()\n  tableStore.transformTblUpdateRootArea();\n  tableStore.currentCase = saveLastCase ? saveLastCase : tableStore.caseList[0];\n  saveLastCase = \"\"\n  tableStore.caseList.pop();\n};\n\nconst handlePreview = () => {\n  // executed when file link or preview icon is clicked.\n  tableStore.initTblInfo()\n  tableStore.input_tbl.tbl = fileTblData;\n  tableStore.input_tbl.instance.updateData(fileTblData);\n  tableStore.input_tbl.instance.render();\n  tableStore.currentInitData = JSON.parse(JSON.stringify(fileTblData));\n  tableStore.transformTblUpdateRootArea();\n  if (!tableStore.currentCase.startsWith(\"Custom\")) {\n    saveLastCase = tableStore.currentCase\n  }\n  if (!tableStore.caseList.includes(\"Custom File\")) {\n    tableStore.caseList.push(\"Custom File\");\n  }\n  tableStore.currentCase = \"Custom File\";\n};\n\nwatch(() => tableStore.currentCase, (newVal) => {\n  if (newVal.startsWith(\"Custom\")) handlePreview();\n  else tableStore.loadCaseData(newVal);\n});\n\n\n//  CSV \nfunction arrayToCSV(array: Table2D) {\n  return array.map(row => row.map(cell => `${cell === undefined ? '' : cell}`).join(',')).join('\\n');\n}\n\nconst handleDownload = () => {\n  if (tableStore.output_tbl.cols.length === 0) {\n    message.warning('The output table is empty.');\n    return;\n  }\n  const csv = arrayToCSV([tableStore.output_tbl.cols, ...tableStore.output_tbl.tbl]);\n  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = 'tidy table.csv'; // \n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n  URL.revokeObjectURL(url); // \n\n  message.success('The output table has been downloaded successfully.');\n};\n\nfunction normalizeSelection(selections: Selection[]): Selection[] {\n  return selections.map(([row1, col1, row2, col2]) => {\n    // 0\n    if (row1 < 0) row1 = 0;\n    if (col1 < 0) col1 = 0;\n    if (row2 < 0) row2 = 0;\n    if (col2 < 0) col2 = 0;\n\n    // startRow <= endRow  startCol <= endCol\n    const startRow = Math.min(row1, row2);\n    const endRow = Math.max(row1, row2);\n    const startCol = Math.min(col1, col2);\n    const endCol = Math.max(col1, col2);\n\n    return [startRow, startCol, endRow, endCol];\n  });\n}\n\nimport { drawMinimap } from '@/utils/minimap';\n\nfunction initEventsForTbl(tbl: \"input_tbl\" | \"output_tbl\") {\n  let tblInst1: Handsontable, tblInst2: Handsontable;\n  const tbl2 = tbl === \"input_tbl\" ? \"output_tbl\" : \"input_tbl\";\n  if (tbl === \"input_tbl\") {\n    tblInst1 = inHotInst;\n    tblInst2 = outHotInst;\n  } else {\n    tblInst1 = outHotInst;\n    tblInst2 = inHotInst;\n  }\n  tblInst1.updateSettings({\n    outsideClickDeselects: (targetEle) => {\n      const targetClassName = targetEle?.className;\n      // if ((targetEle.parentNode?.parentNode as HTMLElement).classList.contains(\"goToInstance\") || (targetEle.parentNode as HTMLElement).classList.contains(\"goToInstance\"))\n      if (targetEle.closest(\".goToInstance\") !== null) {\n        if (document.body.style.cursor === 'cell') {\n          tableStore.clearStatus(\"matchArea\");\n        }\n        return true;\n      };\n      if (targetClassName === \"wtHolder\") {\n        return true;\n      }\n      if (typeof targetClassName !== \"string\") {\n        tblInst2.updateSettings({ cell: [] });\n        return true;\n      }\n      if (tblInst1 === outHotInst && [\"relative\", \"rowHeader\", \"current\", \"truncated\"].some((c) => targetClassName.split(\" \").includes(c))) {\n        //  input \n        if (document.body.style.cursor !== 'cell') {\n          tblInst2.updateSettings({ cell: [] });\n        }\n      } else {\n        tableStore.clearStatus(\"matchArea\");\n        tblInst2.updateSettings({ cell: [] });\n      }\n      tableStore.highlightMinimapCells([]);\n      tableStore.clearStatus(\"tree\");\n\n      if (tbl === \"input_tbl\") {\n        if (!(targetClassName.startsWith(\"mtk\") || targetClassName === \"view-line\"))\n          tableStore.editor.mappingSpec.decorations?.clear();\n      }\n\n      return true;\n    },\n  });\n\n  tblInst1.addHook(\"afterColumnResize\", (currentColumn, newSize, isDoubleClick) => {\n    // \n    tableStore.computeColInfo(tbl);\n  });\n  // tbl\n  tblInst1.addHook(\"afterChange\", (changes, source) => {\n    // \n    if (changes) {\n      if (tbl === \"input_tbl\") {\n        tableStore.clearStatus(\"miniHighlight\");\n        tableStore.initTblInfo(false);\n        tableStore.computeColInfo(\"output_tbl\");\n        tableStore.spec.matchedInstNum = 0;\n      }\n      tableStore.computeColInfo(tbl);\n    }\n  });\n  tblInst1.addHook(\"afterCreateRow\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterCreateCol\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterRemoveRow\", () => updateColInfoFn(tbl));\n  tblInst1.addHook(\"afterRemoveCol\", () => updateColInfoFn(tbl));\n\n  tblInst1.addHook(\"afterOnCellMouseDown\", (e) => {\n    tblInst2.updateSettings({ cell: [] });\n  });\n  tblInst1.addHook(\"afterOnCellMouseUp\", (event, coords, TD) => {\n    const selected = normalizeSelection(tblInst1.getSelected() || []);\n    // key value \n    const { selectedCoords, hightedCells } = tableStore.getHightlightedCells(selected);\n\n    // \n    // console.log(selectedCoords);\n\n    const cells = tableStore.in_out_mapping(selectedCoords, tbl);\n    tableStore.highlightTblCells(tbl2, cells);\n    // tableStore.highlightMinimapCells([{ ...coords, className: \"posi-mapping\" }]);\n\n    if (tbl === \"input_tbl\") {\n      tableStore.highlightMinimapCells(hightedCells);\n      // console.log(document.body.style.cursor, tableStore.spec.selectAreaFromNode, tableStore.spec.selectAreaFromLegend.length);\n      if (document.body.style.cursor === 'cell') {\n        if (tableStore.spec.selectAreaFromNode) {\n          // \n          tableStore.tree.instanceIndex = 0;\n          tableStore.updateVisTreeAreaBox();\n          const selectType = tableStore.spec.selectAreaFromNode;\n          const visNode = selectType === \"0\" ? tableStore.spec.selectNode!.parent!.data : tableStore.spec.selectNode!.data;\n          const nx = visNode.x, ny = visNode.y, nw = visNode.width, nh = visNode.height;\n          const [startRow, startCol, endRow, endCol] = selected[0];\n          const offsetX = startCol - nx, offsetY = startRow - ny;\n          let match: TableCanoniserTemplate[\"match\"] = {};\n          switch (selectType) {\n            case \"0\":\n            // Reset Area Logic\n            case \"3\":\n              // Add Sub-Template Logic\n              const width = endCol - startCol + 1;\n              const height = endRow - startRow + 1;\n              const traverse = {\n                xDirection: nw >= 2 * width ? 'after' as const : undefined,\n                yDirection: nh >= 2 * height ? 'after' as const : undefined\n              }\n              match = {\n                startCell: {\n                  // offsetLayer: \"current\",\n                  // offsetFrom: \"topLeft\",\n                  offsetX: offsetX,\n                  offsetY: offsetY\n                },\n                size: { width, height },\n                traverse\n              }\n              if (selectType === \"0\") {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"match\");\n                const currentSpec = tableStore.getNodebyPath(tableStore.spec.rawSpecs, tableStore.spec.selectNode!.data.path!) as TableCanoniserTemplate;\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(currentSpec.match, currentSpec), `${tableStore.spec.selectNode!.data.type}Shallow`];\n              } else {\n                tableStore.insertNodeOrPropertyIntoSpecs(match, \"children\");\n                tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine({ match: match }), 'nullShallow'];\n              }\n              break;\n            case \"1\":\n              // Add Constraints Logic\n              const cellValue = inHotInst.getDataAtCell(startRow, startCol);\n              match = {\n                constraints: [{\n                  offsetX: offsetX,\n                  offsetY: offsetY,\n                  valueCstr: tableStore.getCellDataType(cellValue) // TableCanoniserKeyWords.String,\n                }]\n              }\n              const constraint = match.constraints![0]\n              tableStore.insertNodeOrPropertyIntoSpecs(constraint, \"constraints\");\n              tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(constraint, tableStore.getNodebyPath(tableStore.spec.rawSpecs, visNode.path!)), `${visNode.type}Shallow`];\n              break;\n          }\n          tableStore.spec.selectAreaFromNode = \"\";\n          tableStore.clearStatus(\"matchArea\");\n          /*\n          const areaConfig = tableStore.spec.areaConfig;\n          areaConfig.match!.startCell = {\n            offsetLayer: \"root\",\n            offsetFrom: \"topLeft\",\n            offsetX: selected[0][1] < 0 ? 0 : selected[0][1],\n            offsetY: selected[0][0] < 0 ? 0 : selected[0][0]\n          }\n          areaConfig.match!.size = {\n            width: selected[0][3] - selected[0][1] + 1,\n            height: selected[0][2] - selected[0][0] + 1\n          }\n          areaConfig.match!.traverse = {\n            xDirection: \"after\",\n            yDirection: \"after\"\n          }\n          const areaFormData = tableStore.spec.areaFormData;\n          areaFormData.offsetLayer = areaConfig.match!.startCell?.offsetLayer;\n          areaFormData.offsetFrom = areaConfig.match!.startCell?.offsetFrom;\n          areaFormData.position = {\n            x: areaConfig.match!.startCell?.offsetX,\n            y: areaConfig.match!.startCell?.offsetY\n          }\n          areaFormData.traverse = {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n          }\n          areaFormData.size = {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n          }\n          tableStore.spec.dragConfigOpen = true;\n          */\n        } else if (tableStore.spec.selectAreaFromLegend.length) {\n          // legend\n          inHotInst.updateSettings({ cell: [] });\n          const selectFromLegend = tableStore.spec.selectAreaFromLegend;\n          tableStore.spec.selectionsAreaFromLegend.push(selected[0]);\n          tableStore.spec.selectionsPath.push([]);\n          if (selectFromLegend.length < tableStore.spec.selectionsAreaFromLegend.length) {\n            selectFromLegend.push(selectFromLegend[selectFromLegend.length - 1])\n          }\n          const cells = tableStore.generateHighlightCells(tableStore.spec.selectionsAreaFromLegend, selectFromLegend);\n          tableStore.highlightTblCells(tbl, cells);\n          // document.body.style.cursor = 'default';\n          // document.documentElement.style.setProperty('--custom-cursor', 'default');\n\n          const { specs, newSpec } = tableStore.buildTree(tableStore.spec.selectionsAreaFromLegend, selectFromLegend, tableStore.spec.selectionsPath);\n\n          tableStore.stringifySpec(specs);\n          tableStore.editor.mappingSpec.highlightCode = [...tableStore.getHighlightCodeStartEndLine(newSpec, null, specs), `${selectFromLegend[selectFromLegend.length - 1]}Shallow`];\n        }\n      }\n\n      tableStore.highlightNodes(selected);\n    } else {\n      tableStore.highlightMinimapCells(cells);\n    }\n  });\n}\n\nonMounted(() => {\n\n  const proxy = getCurrentInstance()?.proxy as ComponentPublicInstance;\n  inHotInst = (proxy.$refs.inputTbl as any).hotInstance as Handsontable;\n  outHotInst = (proxy.$refs.outputTbl as any).hotInstance as Handsontable;\n\n  tableStore.input_tbl.instance = inHotInst;\n  tableStore.output_tbl.instance = outHotInst;\n\n  initEventsForTbl(\"input_tbl\");\n  initEventsForTbl(\"output_tbl\");\n\n  // keepIconsSynchronizedWithTable() { },\n  const iconScrolls = document.querySelectorAll('.icons-container .icon-scroll');\n  const tblScrolls = document.querySelectorAll('.ht_master .wtHolder');\n\n  iconScrolls.forEach((iconScroll, index) => {\n    iconScroll.addEventListener('scroll', () => {\n      tblScrolls[index].scrollLeft = iconScroll.scrollLeft;\n    });\n\n    tblScrolls[index].addEventListener('scroll', () => {\n      iconScroll.scrollLeft = tblScrolls[index].scrollLeft;\n    });\n  })\n});\n\n// function showDropdown() {\n//   //   isOpen = true;\n// }\n// function hideDropdown() {\n//   //   isOpen = false;\n// }\n</script>\n\n<style lang=\"less\">\n.ant-upload-wrapper {\n  position: relative;\n\n  .ant-upload {\n    display: inline-block;\n    // margin-right: 60px;\n  }\n\n  .ant-upload-list {\n    position: absolute;\n    top: -11px;\n    right: 81px;\n    cursor: pointer;\n  }\n\n  .ant-upload-list-item-name {\n    color: #1677ff;\n    padding: 0 0 0 2px !important;\n    max-width: 150px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n}\n\n.handsontable {\n  .truncated {\n    max-width: 140px; // 10px, padding\n    min-width: 50px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n\n  div.relative,\n  td {\n    cursor: var(--custom-cursor) !important;\n  }\n\n  td.htRight {\n    background-color: #3498db;\n  }\n\n  td.position {\n    color: #fff !important;\n    background-color: var(--color-position);\n  }\n\n  td.positionShallow {\n    color: #fff !important;\n    background-color: var(--color-positionShallow);\n  }\n\n  td.context {\n    color: #fff !important;\n    background-color: var(--color-context);\n  }\n\n  td.contextShallow {\n    color: #fff !important;\n    background-color: var(--color-contextShallow);\n  }\n\n  td.value {\n    color: #fff !important;\n    background-color: var(--color-value);\n  }\n\n  td.valueShallow {\n    color: #fff !important;\n    background-color: var(--color-valueShallow);\n  }\n\n  td.null {\n    color: #fff !important;\n    background-color: var(--color-null);\n  }\n\n  td.nullShallow {\n    color: #fff !important;\n    background-color: var(--color-nullShallow);\n  }\n\n  td.selection {\n    color: #fff !important;\n    background-color: var(--color-selection);\n  }\n\n  td.selectionShallow {\n    color: #fff !important;\n    background-color: var(--color-selectionShallow);\n  }\n}\n</style>\n","import script from \"./InOutTable.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InOutTable.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InOutTable.vue?vue&type=style&index=0&id=0d9c7c1a&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport * as monaco from \"monaco-editor\";\nimport { onMounted, onUnmounted, ref, watch } from \"vue\";\nimport { useTableStore } from \"@/store/table\";\n\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'CodeView',\n  props: {\n    codeType: {}\n  },\n  setup(__props: any) {\n\nconst { codeType } = __props;  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\nconst editorDefaultOptions = {\n    value: '',\n    language: 'typescript', // tableStore.editor[codeType].language,\n    theme: 'vs',\n    fontSize: 14,\n    glyphMargin: false,\n    automaticLayout: false, // Automatic layout may cause \"ResizeObserver loop completed with undelivered notifications.\" warning. To avoid this, set automaticLayout to false\n    autoIndent: 'advanced',\n    readOnly: codeType === \"rootArea\" ? true : false,\n    minimap: {\n        enabled: codeType === \"rootArea\" ? true : false,\n    },\n    lineNumbersMinChars: 1,\n    scrollBeyondLastLine: false, // Prevent scrolling beyond the last line\n    wordWrap: 'on', // \n    // wordWrapColumn: 80, //  80  80 \n    padding: {\n        bottom: 50, // Adjust the bottom padding to 50px\n    },\n};\n\nconst editorWrapper = ref<HTMLElement | null>(null);\n\nlet editor: monaco.editor.IStandaloneCodeEditor | null = null;\n\n// let mappingSpec: string = \"\"\n\nconst regex = /\\s+/g;\nconst areStringEqual = (str1: string, str2: string) => (str1.replace(regex, '') === str2.replace(regex, ''));\n\nconst initEditor = () => {\n    if (editor) { // if editor is already initialized, dispose it first\n        editor.dispose();\n    }\n    const editorOptions = {\n        ...editorDefaultOptions,\n        value: tableStore.editor[codeType].code,\n    };\n    editor = monaco.editor.create(editorWrapper.value!, editorOptions as monaco.editor.IEditorConstructionOptions);  // ! means that editorWrapper.value is not null\n\n    editor.onDidBlurEditorText((e) => {\n        // \n        if (codeType === \"mappingSpec\") {\n            tableStore.checkGrammarError();\n            if (tableStore.editor.mappingSpec.errorMark !== null) return\n        }\n        const value = editor!.getValue();\n        if (areStringEqual(tableStore.editor[codeType].code, value)) return; // \n        if (codeType === \"mappingSpec\") {\n            tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n            // \n            tableStore.spec.redoHistory = [];\n            tableStore.editor.mappingSpec.codeUpdateFromEditor = true;\n        }\n        tableStore.editor[codeType].code = value;\n        // console.log('onblur', e);\n    });\n    if (codeType === \"mappingSpec\") {\n        // \n        editor.onDidChangeModelContent(() => {\n            tableStore.editor.mappingSpec.decorations?.clear();\n        })\n    }\n};\n\nwatch(() => tableStore.editor.rootArea.code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    tableStore.editor.rootArea.instance?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n/*\nwatch(() => tableStore.editor[codeType].code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    editor?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n*/\n\n// import { debounce } from 'lodash';\nconst handleResize = tableStore.debounce(() => {\n    if (editor) {\n        editor.layout();\n    }\n}, 300); // Adjust the delay time, in milliseconds\n\n// \n// window.addEventListener('resize', handleResize);\n\n// const resizeObserver = new ResizeObserver(() => {\n//     // console.log(\"Resize observed\", entries);\n//     try { handleResize(); }\n//     catch (e) { console.log(e) }\n// });\nconst resizeObserver = new ResizeObserver(handleResize);\n\nif (codeType === \"mappingSpec\") {\n\n    // https://microsoft.github.io/monaco-editor/playground.html?source=v0.50.0#example-extending-language-services-configure-javascript-defaults\n\n    const libUri = \"ts:grammar.ts\";\n    // Check if model already exists\n    const existingModel = monaco.editor.getModels().find(model => model.uri.toString() === libUri);\n\n    if (!existingModel) {\n        fetch('./grammar.ts').then((response) => {\n            response.text().then((tsContent) => {\n\n                // validation settings\n                monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({\n                    noSemanticValidation: true,\n                    noSyntaxValidation: false,\n                });\n\n                // compiler options\n                monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n                    target: monaco.languages.typescript.ScriptTarget.ES2015,\n                    allowNonTsExtensions: true,\n                });\n                monaco.languages.typescript.javascriptDefaults.addExtraLib(tsContent, libUri);\n\n                // When resolving definitions and references, the editor will try to use created models.\n                // Creating a model for the library allows \"peek definition/references\" commands to work with the library.\n                monaco.editor.createModel(tsContent, \"typescript\", monaco.Uri.parse(libUri));\n            });\n        });\n    }\n}\n\nonMounted(() => {\n    initEditor();\n    //  resize \n    resizeObserver.observe(editorWrapper.value!);\n    if (editor) {\n        tableStore.editor[codeType].instance = editor;\n        if (codeType === \"mappingSpec\") {\n            tableStore.editor.mappingSpec.decorations = editor.createDecorationsCollection([]);\n        }\n    }\n});\n\nonUnmounted(() => {\n    // Code Panel const option \n    if (editor) {\n        editor.dispose();\n    }\n});\n\n\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"editorWrapper\",\n    ref: editorWrapper,\n    class: \"editor-container\"\n  }, null, 512))\n}\n}\n\n})","<template>\n    <div ref=\"editorWrapper\" class=\"editor-container\"></div>\n</template>\n\n<script setup lang=\"ts\">\nimport * as monaco from \"monaco-editor\";\nimport { onMounted, onUnmounted, ref, watch } from \"vue\";\nimport { useTableStore } from \"@/store/table\";\n\n\nconst { codeType } = defineProps<{ codeType: \"mappingSpec\" | \"rootArea\" }>();  // | \"transformScript\"\n\nconst tableStore = useTableStore();\n\nconst editorDefaultOptions = {\n    value: '',\n    language: 'typescript', // tableStore.editor[codeType].language,\n    theme: 'vs',\n    fontSize: 14,\n    glyphMargin: false,\n    automaticLayout: false, // Automatic layout may cause \"ResizeObserver loop completed with undelivered notifications.\" warning. To avoid this, set automaticLayout to false\n    autoIndent: 'advanced',\n    readOnly: codeType === \"rootArea\" ? true : false,\n    minimap: {\n        enabled: codeType === \"rootArea\" ? true : false,\n    },\n    lineNumbersMinChars: 1,\n    scrollBeyondLastLine: false, // Prevent scrolling beyond the last line\n    wordWrap: 'on', // \n    // wordWrapColumn: 80, //  80  80 \n    padding: {\n        bottom: 50, // Adjust the bottom padding to 50px\n    },\n};\n\nconst editorWrapper = ref<HTMLElement | null>(null);\n\nlet editor: monaco.editor.IStandaloneCodeEditor | null = null;\n\n// let mappingSpec: string = \"\"\n\nconst regex = /\\s+/g;\nconst areStringEqual = (str1: string, str2: string) => (str1.replace(regex, '') === str2.replace(regex, ''));\n\nconst initEditor = () => {\n    if (editor) { // if editor is already initialized, dispose it first\n        editor.dispose();\n    }\n    const editorOptions = {\n        ...editorDefaultOptions,\n        value: tableStore.editor[codeType].code,\n    };\n    editor = monaco.editor.create(editorWrapper.value!, editorOptions as monaco.editor.IEditorConstructionOptions);  // ! means that editorWrapper.value is not null\n\n    editor.onDidBlurEditorText((e) => {\n        // \n        if (codeType === \"mappingSpec\") {\n            tableStore.checkGrammarError();\n            if (tableStore.editor.mappingSpec.errorMark !== null) return\n        }\n        const value = editor!.getValue();\n        if (areStringEqual(tableStore.editor[codeType].code, value)) return; // \n        if (codeType === \"mappingSpec\") {\n            tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n            // \n            tableStore.spec.redoHistory = [];\n            tableStore.editor.mappingSpec.codeUpdateFromEditor = true;\n        }\n        tableStore.editor[codeType].code = value;\n        // console.log('onblur', e);\n    });\n    if (codeType === \"mappingSpec\") {\n        // \n        editor.onDidChangeModelContent(() => {\n            tableStore.editor.mappingSpec.decorations?.clear();\n        })\n    }\n};\n\nwatch(() => tableStore.editor.rootArea.code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    tableStore.editor.rootArea.instance?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n\n/*\nwatch(() => tableStore.editor[codeType].code, (newVal) => {\n    // console.log(\"watch editor code\", codeType);\n    editor?.setValue(newVal);  // update editor content; ? means if editor is not null then call setValue, else do nothing\n});\n*/\n\n// import { debounce } from 'lodash';\nconst handleResize = tableStore.debounce(() => {\n    if (editor) {\n        editor.layout();\n    }\n}, 300); // Adjust the delay time, in milliseconds\n\n// \n// window.addEventListener('resize', handleResize);\n\n// const resizeObserver = new ResizeObserver(() => {\n//     // console.log(\"Resize observed\", entries);\n//     try { handleResize(); }\n//     catch (e) { console.log(e) }\n// });\nconst resizeObserver = new ResizeObserver(handleResize);\n\nif (codeType === \"mappingSpec\") {\n\n    // https://microsoft.github.io/monaco-editor/playground.html?source=v0.50.0#example-extending-language-services-configure-javascript-defaults\n\n    const libUri = \"ts:grammar.ts\";\n    // Check if model already exists\n    const existingModel = monaco.editor.getModels().find(model => model.uri.toString() === libUri);\n\n    if (!existingModel) {\n        fetch('./grammar.ts').then((response) => {\n            response.text().then((tsContent) => {\n\n                // validation settings\n                monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({\n                    noSemanticValidation: true,\n                    noSyntaxValidation: false,\n                });\n\n                // compiler options\n                monaco.languages.typescript.javascriptDefaults.setCompilerOptions({\n                    target: monaco.languages.typescript.ScriptTarget.ES2015,\n                    allowNonTsExtensions: true,\n                });\n                monaco.languages.typescript.javascriptDefaults.addExtraLib(tsContent, libUri);\n\n                // When resolving definitions and references, the editor will try to use created models.\n                // Creating a model for the library allows \"peek definition/references\" commands to work with the library.\n                monaco.editor.createModel(tsContent, \"typescript\", monaco.Uri.parse(libUri));\n            });\n        });\n    }\n}\n\nonMounted(() => {\n    initEditor();\n    //  resize \n    resizeObserver.observe(editorWrapper.value!);\n    if (editor) {\n        tableStore.editor[codeType].instance = editor;\n        if (codeType === \"mappingSpec\") {\n            tableStore.editor.mappingSpec.decorations = editor.createDecorationsCollection([]);\n        }\n    }\n});\n\nonUnmounted(() => {\n    // Code Panel const option \n    if (editor) {\n        editor.dispose();\n    }\n});\n\n\n</script>\n\n\n<style lang=\"less\">\n.editor-container {\n    width: 100%;\n    height: 100%;\n    /* You can adjust the height as needed */\n\n    .nullShallow {\n        // background-color: var(--color-null);\n        background-color: var(--color-nullRGBA); // var(--color-nullShallow);\n    }\n\n    .positionShallow {\n        // background-color: var(--color-position);\n        background-color: var(--color-positionRGBA); // var(--color-positionShallow);\n    }\n\n    .valueShallow {\n        // background-color: var(--color-value);\n        background-color: var(--color-valueRGBA); // var(--color-valueShallow);\n    }\n\n    .contextShallow {\n        // background-color: var(--color-context);\n        background-color: var(--color-contextRGBA); // var(--color-contextShallow);\n    }\n\n    .selectionShallow {\n        // background-color: var(--color-selection);\n        background-color: var(--color-selectionRGBA); // var(--color-selectionShallow);\n    }\n\n}\n</style>","import script from \"./CodeView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CodeView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CodeView.vue?vue&type=style&index=0&id=1ffe2708&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import script from \"./PatternVis.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PatternVis.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PatternVis.vue?vue&type=style&index=0&id=5df72c4c&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, normalizeStyle as _normalizeStyle } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"span\", null, \"x (col):\", -1)\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"span\", null, \"y (row):\", -1)\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", null, \"width:\", -1)\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"span\", null, \"height:\", -1)\n\nimport { ref, computed, CSSProperties, watch, watchEffect } from 'vue';\nimport { useDraggable } from '@vueuse/core';\nimport { useTableStore, AreaForm } from '@/store/table';\n// import { TableCanoniserTemplate } from '@/table-canoniser/dist/grammar';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'DraggableModal',\n  setup(__props) {\n\nconst tableStore = useTableStore();\nconst areaConfig = tableStore.spec.areaConfig;\n\n\n\n/* ---------- Area Form ---------- */\n// const formData = ref<TableCanoniserTemplate>(areaConfig)\nconst formData = ref<AreaForm>(tableStore.spec.areaFormData)\n\ntableStore.spec.areaFormData = formData.value\n\nconst handleOk = (values: any) => {\n    handleCancel();\n    tableStore.selectArea();\n};\nconst resetForm = () => {\n    formData.value = {\n        offsetLayer: areaConfig.match!.startCell?.offsetLayer,\n        offsetFrom: areaConfig.match!.startCell?.offsetFrom,\n        position: {\n            x: areaConfig.match!.startCell?.offsetX,\n            y: areaConfig.match!.startCell?.offsetY\n        },\n        traverse: {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n        },\n        size: {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n        }\n    };\n}\n\n\n/* ---------- Draggable ---------- */\nconst open = computed(() => tableStore.spec.dragConfigOpen)\nconst modalTitleRef = ref<HTMLElement>();\n\nconst { x, y, isDragging } = useDraggable(modalTitleRef);\nconst handleCancel = () => {\n    tableStore.spec.dragConfigOpen = false;\n    tableStore.spec.selectAreaFromNode = \"\";\n};\nconst startX = ref<number>(0);\nconst startY = ref<number>(0);\nconst startedDrag = ref(false);\nconst transformX = ref(0);\nconst transformY = ref(0);\nconst preTransformX = ref(0);\nconst preTransformY = ref(0);\nconst dragRect = ref({ left: 0, right: 0, top: 0, bottom: 0 });\nwatch([x, y], () => {\n    if (!startedDrag.value) {\n        startX.value = x.value;\n        startY.value = y.value;\n        const bodyRect = document.body.getBoundingClientRect();\n        const titleRect = modalTitleRef.value!.getBoundingClientRect();\n        dragRect.value.right = bodyRect.width - titleRect.width;\n        dragRect.value.bottom = bodyRect.height - titleRect.height;\n        preTransformX.value = transformX.value;\n        preTransformY.value = transformY.value;\n    }\n    startedDrag.value = true;\n});\nwatch(isDragging, () => {\n    if (!isDragging) {\n        startedDrag.value = false;\n    }\n});\n\nwatchEffect(() => {\n    if (startedDrag.value) {\n        transformX.value =\n            preTransformX.value +\n            Math.min(Math.max(dragRect.value.left, x.value), dragRect.value.right) -\n            startX.value;\n        transformY.value =\n            preTransformY.value +\n            Math.min(Math.max(dragRect.value.top, y.value), dragRect.value.bottom) -\n            startY.value;\n    }\n});\nconst transformStyle = computed<CSSProperties>(() => {\n    return {\n        transform: `translate(${transformX.value}px, ${transformY.value}px)`,\n    };\n});\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_divider = _resolveComponent(\"a-divider\")!\n  const _component_a_col = _resolveComponent(\"a-col\")!\n  const _component_a_radio_button = _resolveComponent(\"a-radio-button\")!\n  const _component_a_radio_group = _resolveComponent(\"a-radio-group\")!\n  const _component_a_row = _resolveComponent(\"a-row\")!\n  const _component_a_modal = _resolveComponent(\"a-modal\")!\n\n  return (_openBlock(), _createBlock(_component_a_modal, {\n    ref: \"modalRef\",\n    open: open.value,\n    \"onUpdate:open\": _cache[8] || (_cache[8] = ($event: any) => ((open).value = $event)),\n    \"wrap-style\": { overflow: 'hidden' },\n    onCancel: handleCancel,\n    onOk: handleOk,\n    okText: \"Confirm\",\n    width: \"600px\"\n  }, {\n    title: _withCtx(() => [\n      _createElementVNode(\"div\", {\n        ref_key: \"modalTitleRef\",\n        ref: modalTitleRef,\n        style: {\"width\":\"100%\",\"cursor\":\"move\"}\n      }, \"Template Area\", 512)\n    ]),\n    modalRender: _withCtx(({ originVNode }) => [\n      _createElementVNode(\"div\", {\n        style: _normalizeStyle(transformStyle.value)\n      }, [\n        (_openBlock(), _createBlock(_resolveDynamicComponent(originVNode)))\n      ], 4)\n    ]),\n    default: _withCtx(() => [\n      _createElementVNode(\"div\", null, [\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"startCell\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"offsetLayer\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.offsetLayer,\n                    \"onUpdate:value\": _cache[0] || (_cache[0] = ($event: any) => ((formData.value.offsetLayer) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"current\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"current\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"parent\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"parent\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"root\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"root\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"areaLayerFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"referenceAreaPosition\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.offsetFrom,\n                    \"onUpdate:value\": _cache[1] || (_cache[1] = ($event: any) => ((formData.value.offsetFrom) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"topLeft\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"topLeft\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"topRight\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"topRight\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"bottomLeft\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"bottomLeft\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"bottomRight\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"bottomRight\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"Start Position\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _hoisted_1,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.position.x,\n                    \"onUpdate:value\": _cache[2] || (_cache[2] = ($event: any) => ((formData.value.position.x) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.startCell!.offsetX\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.startCell!.offsetX), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"offsetFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"]),\n                  _hoisted_2,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.position.y,\n                    \"onUpdate:value\": _cache[3] || (_cache[3] = ($event: any) => ((formData.value.position.y) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.startCell!.offsetY\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.startCell!.offsetY), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: \"offsetFn\",\n                        title: \"areaLayerFn\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"Custom Func\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"size\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"5\" }, {\n                default: _withCtx(() => [\n                  _hoisted_3,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.size.width,\n                    \"onUpdate:value\": _cache[4] || (_cache[4] = ($event: any) => ((formData.value.size.width) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.size!.width\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.size!.width), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"5\" }, {\n                default: _withCtx(() => [\n                  _hoisted_4,\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.size.height,\n                    \"onUpdate:value\": _cache[5] || (_cache[5] = ($event: any) => ((formData.value.size.height) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, {\n                        value: _unref(areaConfig).match!.size!.height\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(_toDisplayString(_unref(areaConfig).match!.size!.height), 1)\n                        ]),\n                        _: 1\n                      }, 8, [\"value\"]),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ]),\n        _createElementVNode(\"div\", null, [\n          _createVNode(_component_a_divider, null, {\n            default: _withCtx(() => [\n              _createTextVNode(\"traverse\")\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"x direction:\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.traverse.xDirection,\n                    \"onUpdate:value\": _cache[6] || (_cache[6] = ($event: any) => ((formData.value.traverse.xDirection) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"after\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"after\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"above\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"above\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"whole\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"whole\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_a_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_a_col, { flex: \"100px\" }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"y direction:\")\n                ]),\n                _: 1\n              }),\n              _createVNode(_component_a_col, { flex: \"auto\" }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_a_radio_group, {\n                    value: formData.value.traverse.yDirection,\n                    \"onUpdate:value\": _cache[7] || (_cache[7] = ($event: any) => ((formData.value.traverse.yDirection) = $event))\n                  }, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_a_radio_button, { value: \"after\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"after\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"above\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"above\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, { value: \"whole\" }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"whole\")\n                        ]),\n                        _: 1\n                      }),\n                      _createVNode(_component_a_radio_button, {\n                        value: null,\n                        title: \"Don't specify\"\n                      }, {\n                        default: _withCtx(() => [\n                          _createTextVNode(\"null\")\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  }, 8, [\"value\"])\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          })\n        ])\n      ])\n    ]),\n    _: 1\n  }, 8, [\"open\"]))\n}\n}\n\n})","<template>\n    <a-modal ref=\"modalRef\" v-model:open=\"open\" :wrap-style=\"{ overflow: 'hidden' }\" @cancel=\"handleCancel\"\n        @ok=\"handleOk\" okText=\"Confirm\" width=\"600px\">\n        <div>\n            <div>\n                <a-divider>startCell</a-divider>\n                <a-row>\n                    <a-col flex=\"100px\">offsetLayer</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.offsetLayer\">\n                            <a-radio-button value=\"current\">current</a-radio-button>\n                            <a-radio-button value=\"parent\">parent</a-radio-button>\n                            <a-radio-button value=\"root\">root</a-radio-button>\n                            <a-radio-button value=\"areaLayerFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">referenceAreaPosition</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.offsetFrom\">\n                            <a-radio-button value=\"topLeft\">topLeft</a-radio-button>\n                            <a-radio-button value=\"topRight\">topRight</a-radio-button>\n                            <a-radio-button value=\"bottomLeft\">bottomLeft</a-radio-button>\n                            <a-radio-button value=\"bottomRight\">bottomRight</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">Start Position</a-col>\n                    <a-col flex=\"auto\">\n                        <span>x (col):</span>\n                        <a-radio-group v-model:value=\"formData.position.x\">\n                            <a-radio-button :value=\"areaConfig.match!.startCell!.offsetX\">{{\n                                areaConfig.match!.startCell!.offsetX\n                                }}</a-radio-button>\n                            <a-radio-button value=\"offsetFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                        <span>y (row):</span>\n                        <a-radio-group v-model:value=\"formData.position.y\">\n                            <a-radio-button :value=\"areaConfig.match!.startCell!.offsetY\">{{\n                                areaConfig.match!.startCell!.offsetY\n                                }}</a-radio-button>\n                            <a-radio-button value=\"offsetFn\" title=\"areaLayerFn\">Custom Func</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n            <div>\n                <a-divider>size</a-divider>\n                <a-row>\n                    <a-col flex=\"5\">\n                        <span>width:</span>\n                        <a-radio-group v-model:value=\"formData.size.width\">\n                            <a-radio-button :value=\"areaConfig.match!.size!.width\">{{ areaConfig.match!.size!.width\n                                }}</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                    <a-col flex=\"5\">\n                        <span>height:</span>\n                        <a-radio-group v-model:value=\"formData.size.height\">\n                            <a-radio-button :value=\"areaConfig.match!.size!.height\">{{ areaConfig.match!.size!.height\n                                }}</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n            <div>\n                <a-divider>traverse</a-divider>\n                <a-row>\n                    <a-col flex=\"100px\">x direction:</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.traverse.xDirection\">\n                            <a-radio-button value=\"after\">after</a-radio-button>\n                            <a-radio-button value=\"above\">above</a-radio-button>\n                            <a-radio-button value=\"whole\">whole</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n                <a-row>\n                    <a-col flex=\"100px\">y direction:</a-col>\n                    <a-col flex=\"auto\">\n                        <a-radio-group v-model:value=\"formData.traverse.yDirection\">\n                            <a-radio-button value=\"after\">after</a-radio-button>\n                            <a-radio-button value=\"above\">above</a-radio-button>\n                            <a-radio-button value=\"whole\">whole</a-radio-button>\n                            <a-radio-button :value=\"null\" title=\"Don't specify\">null</a-radio-button>\n                        </a-radio-group>\n                    </a-col>\n                </a-row>\n            </div>\n        </div>\n\n        <template #title>\n            <div ref=\"modalTitleRef\" style=\"width: 100%; cursor: move\">Template Area</div>\n        </template>\n        <template #modalRender=\"{ originVNode }\">\n            <div :style=\"transformStyle\">\n                <component :is=\"originVNode\" />\n            </div>\n        </template>\n    </a-modal>\n</template>\n<script lang=\"ts\" setup>\nimport { ref, computed, CSSProperties, watch, watchEffect } from 'vue';\nimport { useDraggable } from '@vueuse/core';\nimport { useTableStore, AreaForm } from '@/store/table';\n// import { TableCanoniserTemplate } from '@/table-canoniser/dist/grammar';\nconst tableStore = useTableStore();\nconst areaConfig = tableStore.spec.areaConfig;\n\n\n\n/* ---------- Area Form ---------- */\n// const formData = ref<TableCanoniserTemplate>(areaConfig)\nconst formData = ref<AreaForm>(tableStore.spec.areaFormData)\n\ntableStore.spec.areaFormData = formData.value\n\nconst handleOk = (values: any) => {\n    handleCancel();\n    tableStore.selectArea();\n};\nconst resetForm = () => {\n    formData.value = {\n        offsetLayer: areaConfig.match!.startCell?.offsetLayer,\n        offsetFrom: areaConfig.match!.startCell?.offsetFrom,\n        position: {\n            x: areaConfig.match!.startCell?.offsetX,\n            y: areaConfig.match!.startCell?.offsetY\n        },\n        traverse: {\n            xDirection: areaConfig.match!.traverse?.xDirection,\n            yDirection: areaConfig.match!.traverse?.yDirection\n        },\n        size: {\n            width: areaConfig.match!.size?.width,\n            height: areaConfig.match!.size?.height\n        }\n    };\n}\n\n\n/* ---------- Draggable ---------- */\nconst open = computed(() => tableStore.spec.dragConfigOpen)\nconst modalTitleRef = ref<HTMLElement>();\n\nconst { x, y, isDragging } = useDraggable(modalTitleRef);\nconst handleCancel = () => {\n    tableStore.spec.dragConfigOpen = false;\n    tableStore.spec.selectAreaFromNode = \"\";\n};\nconst startX = ref<number>(0);\nconst startY = ref<number>(0);\nconst startedDrag = ref(false);\nconst transformX = ref(0);\nconst transformY = ref(0);\nconst preTransformX = ref(0);\nconst preTransformY = ref(0);\nconst dragRect = ref({ left: 0, right: 0, top: 0, bottom: 0 });\nwatch([x, y], () => {\n    if (!startedDrag.value) {\n        startX.value = x.value;\n        startY.value = y.value;\n        const bodyRect = document.body.getBoundingClientRect();\n        const titleRect = modalTitleRef.value!.getBoundingClientRect();\n        dragRect.value.right = bodyRect.width - titleRect.width;\n        dragRect.value.bottom = bodyRect.height - titleRect.height;\n        preTransformX.value = transformX.value;\n        preTransformY.value = transformY.value;\n    }\n    startedDrag.value = true;\n});\nwatch(isDragging, () => {\n    if (!isDragging) {\n        startedDrag.value = false;\n    }\n});\n\nwatchEffect(() => {\n    if (startedDrag.value) {\n        transformX.value =\n            preTransformX.value +\n            Math.min(Math.max(dragRect.value.left, x.value), dragRect.value.right) -\n            startX.value;\n        transformY.value =\n            preTransformY.value +\n            Math.min(Math.max(dragRect.value.top, y.value), dragRect.value.bottom) -\n            startY.value;\n    }\n});\nconst transformStyle = computed<CSSProperties>(() => {\n    return {\n        transform: `translate(${transformX.value}px, ${transformY.value}px)`,\n    };\n});\n</script>","import script from \"./DraggableModal.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DraggableModal.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, unref as _unref, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { id: \"panel\" }\nconst _hoisted_2 = { class: \"system-name\" }\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"span\", { id: \"system_name\" }, \"TableCanoniser\", -1)\nconst _hoisted_4 = { style: {\"left\":\"20px\",\"position\":\"absolute\"} }\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"font-size\":\"16px\",\"font-weight\":\"normal\",\"margin-right\":\"5px\"} }, \"Cases:\", -1)\nconst _hoisted_6 = { style: {\"right\":\"20px\",\"position\":\"absolute\"} }\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"margin-left\":\"5px\"} }, \"Undo\", -1)\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"span\", { style: {\"margin-left\":\"5px\"} }, \"Redo\", -1)\nconst _hoisted_9 = { class: \"main-views\" }\nconst _hoisted_10 = {\n  class: \"column\",\n  style: {\"flex\":\"12\"}\n}\nconst _hoisted_11 = { style: {\"flex\":\"1\",\"display\":\"flex\",\"min-height\":\"0px\"} }\nconst _hoisted_12 = { style: {\"flex\":\"1\",\"display\":\"flex\",\"min-height\":\"0px\"} }\nconst _hoisted_13 = {\n  class: \"column\",\n  style: {\"flex\":\"5\"}\n}\nconst _hoisted_14 = { class: \"view\" }\nconst _hoisted_15 = { class: \"view-content\" }\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"span\", null, \"Run\", -1)\nconst _hoisted_17 = /*#__PURE__*/_createElementVNode(\"span\", {\n  style: {\"font-size\":\"15px\"},\n  title: \"The mapping specification that transforms the input table to the output table\"\n}, \" Specification \", -1)\nconst _hoisted_18 = {\n  style: {\"font-size\":\"15px\"},\n  title: \"A tree data structure that contains the AreaInfo of the matched instances\"\n}\n\nimport { computed, onMounted, ref } from \"vue\";\n\nimport InOutTable from \"@/components/InOutTable.vue\";\nimport CodeView from \"@/components/CodeView.vue\";\n// import Minimap from \"@/components/Minimap.vue\";\nimport PatternVis from \"@/components/PatternVis.vue\";\nimport DraggableModal from \"@/components/DraggableModal.vue\";\n// import ChatBot from \"@/components/ChatBot.vue\";\n\nimport { typeMapColor, TypeColor } from '@/utils/style';\nimport { getNeighborEls, onDrag, endDrag } from '@/utils/dragLayout';\n\nimport { useTableStore } from \"@/store/table\";\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'PanelView',\n  setup(__props) {\n\nfor (const key in typeMapColor) {\n  document.documentElement.style.setProperty(`--color-${key}`, typeMapColor[key as TypeColor]);\n}\ndocument.documentElement.style.setProperty('--custom-cursor', 'default');\n\nconst tableStore = useTableStore();\n\n// let caseOption: Ref<{ value: string; label: string; }[]> = ref([]);\n// let caseOption = ref<{ value: string; label: string }[]>([]);\n\nconst caseOption = computed(() => {\n  return tableStore.caseList.map((v) => {\n    return { value: v, label: v };\n  });\n})\n\nconst currentCase = computed(() => tableStore.currentCase);\n\nconst codePanel = ref(\"1\");\n// const loading = ref<boolean>(false);\n\nconst undoFlag = computed(() => tableStore.spec.undoHistory.length === 0);\nconst redoFlag = computed(() => tableStore.spec.redoHistory.length === 0);\n\n// \nfunction undo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastSpec = tableStore.spec.undoHistory.pop();\n  if (lastSpec !== undefined) {\n    tableStore.spec.redoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastSpec;\n  }\n}\n\n// \nfunction redo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastUndo = tableStore.spec.redoHistory.pop();\n  if (lastUndo !== undefined) {\n    tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastUndo;\n  }\n}\n\n//  PatternVis \nconst patternVis = ref();\nfunction transformTablebyCode() {\n  // loading.value = true;\n  // tableStore.transformTablebyCode();\n  // triggerRef(ref(tableStore.editor.mappingSpec.code));\n  //  watch\n  // PatternVis.methods!.handleCodeChange(tableStore.editor.mappingSpec.code);\n  patternVis.value.handleCodeChange(true); // handleCodeChange();\n  // loading.value = false;\n}\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Escape') {\n    //  ESC \n    tableStore.editor.mappingSpec.decorations?.clear();\n    tableStore.input_tbl.instance.deselectCell();\n    tableStore.output_tbl.instance.deselectCell();\n    tableStore.input_tbl.instance.updateSettings({ cell: [] });\n    tableStore.output_tbl.instance.updateSettings({ cell: [] });\n    tableStore.highlightMinimapCells([]);\n\n    tableStore.clearStatus(\"tree\");\n    tableStore.clearStatus(\"matchArea\");\n    tableStore.clearStatus(\"miniHighlight\");\n\n  }\n}\n\nfunction handleCaseChange(value: string) {\n  tableStore.currentCase = value;\n  isDropdownOpen.value = false;\n}\n\nconst isDropdownOpen = ref(false);\nlet timeHandler: any = null;\nlet dropdownListEle: any = null;\n\nfunction selectEnter(e: any, v: any) {\n  isDropdownOpen.value = true;\n  if (dropdownListEle === null) {\n    setTimeout(() => {\n      dropdownListEle = document.querySelector(\".rc-virtual-list-holder-inner\");\n      dropdownListEle?.addEventListener('mouseenter', () => {\n        if (timeHandler !== null) {\n          clearTimeout(timeHandler);\n          timeHandler = null;\n        }\n        isDropdownOpen.value = true;\n      })\n      dropdownListEle?.addEventListener('mouseleave', () => {\n        isDropdownOpen.value = false;\n      })\n    }, 100)\n  }\n}\n\nfunction selectLeave(e: any, v: any) {\n  timeHandler = setTimeout(() => {\n    isDropdownOpen.value = false;\n  }, 200);\n}\n\nonMounted(() => {\n  tableStore.loadCaseData(tableStore.currentCase);\n  document.addEventListener('keydown', handleKeydown);\n  document.addEventListener(\"mousemove\", onDrag);\n  document.addEventListener(\"mouseup\", endDrag);\n});\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_a_select = _resolveComponent(\"a-select\")!\n  const _component_v_icon = _resolveComponent(\"v-icon\")!\n  const _component_a_button = _resolveComponent(\"a-button\")!\n  const _component_a_button_group = _resolveComponent(\"a-button-group\")!\n  const _component_a_tab_pane = _resolveComponent(\"a-tab-pane\")!\n  const _component_a_tabs = _resolveComponent(\"a-tabs\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _hoisted_3,\n      _createElementVNode(\"span\", _hoisted_4, [\n        _hoisted_5,\n        _createVNode(_component_a_select, {\n          value: currentCase.value,\n          options: caseOption.value,\n          size: \"small\",\n          onChange: handleCaseChange,\n          onMouseenter: selectEnter,\n          onMouseleave: selectLeave,\n          open: isDropdownOpen.value,\n          style: {\"width\":\"124px\"}\n        }, null, 8, [\"value\", \"options\", \"open\"])\n      ]),\n      _createElementVNode(\"span\", _hoisted_6, [\n        _createVNode(_component_a_button_group, null, {\n          default: _withCtx(() => [\n            _createVNode(_component_a_button, {\n              size: \"small\",\n              onClick: undo,\n              disabled: undoFlag.value\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, {\n                  name: \"io-arrow-undo-outline\",\n                  scale: \"0.9\"\n                }),\n                _hoisted_7\n              ]),\n              _: 1\n            }, 8, [\"disabled\"]),\n            _createVNode(_component_a_button, {\n              size: \"small\",\n              onClick: redo,\n              disabled: redoFlag.value\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_v_icon, {\n                  name: \"io-arrow-redo-outline\",\n                  scale: \"0.9\"\n                }),\n                _hoisted_8\n              ]),\n              _: 1\n            }, 8, [\"disabled\"])\n          ]),\n          _: 1\n        })\n      ])\n    ]),\n    _createElementVNode(\"div\", _hoisted_9, [\n      _createElementVNode(\"div\", _hoisted_10, [\n        _createElementVNode(\"div\", _hoisted_11, [\n          _createVNode(InOutTable)\n        ]),\n        _createElementVNode(\"div\", {\n          class: \"divider-h\",\n          onMousedown: _cache[0] || (_cache[0] = ($event: any) => (_unref(getNeighborEls)($event, 'height'))),\n          title: \"Drag to resize\"\n        }, null, 32),\n        _createElementVNode(\"div\", _hoisted_12, [\n          _createVNode(PatternVis, {\n            ref_key: \"patternVis\",\n            ref: patternVis\n          }, null, 512)\n        ])\n      ]),\n      _createElementVNode(\"div\", {\n        class: \"divider-w\",\n        onMousedown: _cache[1] || (_cache[1] = ($event: any) => (_unref(getNeighborEls)($event, 'width'))),\n        title: \"Drag to resize\"\n      }, null, 32),\n      _createElementVNode(\"div\", _hoisted_13, [\n        _createElementVNode(\"div\", _hoisted_14, [\n          _createElementVNode(\"div\", _hoisted_15, [\n            _createVNode(_component_a_tabs, {\n              activeKey: codePanel.value,\n              \"onUpdate:activeKey\": _cache[2] || (_cache[2] = ($event: any) => ((codePanel).value = $event)),\n              type: \"card\"\n            }, {\n              rightExtra: _withCtx(() => [\n                _createVNode(_component_a_button, {\n                  size: \"small\",\n                  style: {\"margin-right\":\"10px\",\"margin-bottom\":\"10px\"},\n                  onClick: transformTablebyCode\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_v_icon, {\n                      name: \"la-rocket-solid\",\n                      scale: \"0.85\"\n                    }),\n                    _hoisted_16\n                  ]),\n                  _: 1\n                })\n              ]),\n              default: _withCtx(() => [\n                _createVNode(_component_a_tab_pane, { key: \"1\" }, {\n                  tab: _withCtx(() => [\n                    _hoisted_17\n                  ]),\n                  default: _withCtx(() => [\n                    _createVNode(CodeView, { codeType: \"mappingSpec\" })\n                  ]),\n                  _: 1\n                }),\n                _createVNode(_component_a_tab_pane, { key: \"2\" }, {\n                  tab: _withCtx(() => [\n                    _createElementVNode(\"span\", _hoisted_18, \" Matched Instances [\" + _toDisplayString(_unref(tableStore).spec.matchedInstNum) + \"] \", 1)\n                  ]),\n                  default: _withCtx(() => [\n                    _createVNode(CodeView, { codeType: \"rootArea\" })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }, 8, [\"activeKey\"])\n          ])\n        ])\n      ])\n    ]),\n    _createVNode(DraggableModal)\n  ]))\n}\n}\n\n})","<template>\n  <div id=\"panel\">\n    <div class=\"system-name\">\n      <span id=\"system_name\">TableCanoniser</span>\n      <span style=\"left: 20px; position: absolute;\">\n        <span style=\"font-size: 16px; font-weight: normal; margin-right: 5px\">Cases:</span>\n        <!-- @mouseenter=\"selectEnter\" @mouseleave=\"selectLeave\"  :open=\"isDropdownOpen\" :getPopupContainer=\"(triggerNode: any) => triggerNode.parentNode\" -->\n        <a-select :value=\"currentCase\" :options=\"caseOption\" size=\"small\" @change=\"handleCaseChange\"\n          @mouseenter=\"selectEnter\" @mouseleave=\"selectLeave\" :open=\"isDropdownOpen\" style=\"width: 124px;\"></a-select>\n      </span>\n      <span style=\"right: 20px; position: absolute;\">\n        <a-button-group>\n          <a-button size=\"small\" @click=\"undo\" :disabled=\"undoFlag\">\n            <v-icon name=\"io-arrow-undo-outline\" scale=\"0.9\"></v-icon>\n            <span style=\"margin-left: 5px\">Undo</span>\n          </a-button>\n          <a-button size=\"small\" @click=\"redo\" :disabled=\"redoFlag\">\n            <v-icon name=\"io-arrow-redo-outline\" scale=\"0.9\"></v-icon>\n            <span style=\"margin-left: 5px\">Redo</span>\n          </a-button>\n        </a-button-group>\n      </span>\n    </div>\n    <!-- <ChatBot /> -->\n    <div class=\"main-views\">\n      <div class=\"column\" style=\"flex: 12\">\n        <div style=\"flex: 1; display: flex; min-height: 0px;\">\n          <InOutTable />\n        </div>\n        <div class=\"divider-h\" @mousedown=\"getNeighborEls($event, 'height')\" title=\"Drag to resize\"></div>\n        <div style=\"flex: 1; display: flex; min-height: 0px;\">\n          <PatternVis ref=\"patternVis\" />\n        </div>\n      </div>\n      <div class=\"divider-w\" @mousedown=\"getNeighborEls($event, 'width')\" title=\"Drag to resize\"></div>\n      <div class=\"column\" style=\"flex: 5;\">\n        <div class=\"view\">\n          <div class=\"view-content\">\n            <a-tabs v-model:activeKey=\"codePanel\" type=\"card\">\n              <template #rightExtra>\n                <a-button size=\"small\" style=\"margin-right: 10px; margin-bottom: 10px;\" @click=\"transformTablebyCode\">\n                  <v-icon name=\"la-rocket-solid\" scale=\"0.85\"></v-icon>\n                  <span>Run</span>\n                </a-button>\n              </template>\n\n              <a-tab-pane key=\"1\">\n                <template #tab>\n                  <span style=\"font-size: 15px\"\n                    title=\"The mapping specification that transforms the input table to the output table\">\n                    Specification\n                  </span>\n                </template>\n                <CodeView codeType=\"mappingSpec\" />\n              </a-tab-pane>\n              <a-tab-pane key=\"2\">\n                <template #tab>\n                  <span style=\"font-size: 15px\"\n                    title=\"A tree data structure that contains the AreaInfo of the matched instances\">\n                    Matched Instances [{{ tableStore.spec.matchedInstNum }}]\n                  </span>\n                </template>\n                <CodeView codeType=\"rootArea\" />\n              </a-tab-pane>\n              <!-- <a-tab-pane key=\"3\">\n                <template #tab>\n                  <span>\n                    Transformation Script\n                  </span>\n                </template>\n                <CodeView codeType=\"transformScript\" />\n              </a-tab-pane> -->\n            </a-tabs>\n          </div>\n        </div>\n      </div>\n    </div>\n    <DraggableModal />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, onMounted, ref } from \"vue\";\n\nimport InOutTable from \"@/components/InOutTable.vue\";\nimport CodeView from \"@/components/CodeView.vue\";\n// import Minimap from \"@/components/Minimap.vue\";\nimport PatternVis from \"@/components/PatternVis.vue\";\nimport DraggableModal from \"@/components/DraggableModal.vue\";\n// import ChatBot from \"@/components/ChatBot.vue\";\n\nimport { typeMapColor, TypeColor } from '@/utils/style';\nfor (const key in typeMapColor) {\n  document.documentElement.style.setProperty(`--color-${key}`, typeMapColor[key as TypeColor]);\n}\ndocument.documentElement.style.setProperty('--custom-cursor', 'default');\n\nimport { getNeighborEls, onDrag, endDrag } from '@/utils/dragLayout';\n\nimport { useTableStore } from \"@/store/table\";\nconst tableStore = useTableStore();\n\n// let caseOption: Ref<{ value: string; label: string; }[]> = ref([]);\n// let caseOption = ref<{ value: string; label: string }[]>([]);\n\nconst caseOption = computed(() => {\n  return tableStore.caseList.map((v) => {\n    return { value: v, label: v };\n  });\n})\n\nconst currentCase = computed(() => tableStore.currentCase);\n\nconst codePanel = ref(\"1\");\n// const loading = ref<boolean>(false);\n\nconst undoFlag = computed(() => tableStore.spec.undoHistory.length === 0);\nconst redoFlag = computed(() => tableStore.spec.redoHistory.length === 0);\n\n// \nfunction undo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastSpec = tableStore.spec.undoHistory.pop();\n  if (lastSpec !== undefined) {\n    tableStore.spec.redoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastSpec;\n  }\n}\n\n// \nfunction redo() {\n  tableStore.editor.mappingSpec.errorMark = null\n  const lastUndo = tableStore.spec.redoHistory.pop();\n  if (lastUndo !== undefined) {\n    tableStore.spec.undoHistory.push(tableStore.editor.mappingSpec.code);\n    tableStore.editor.mappingSpec.code = lastUndo;\n  }\n}\n\n//  PatternVis \nconst patternVis = ref();\nfunction transformTablebyCode() {\n  // loading.value = true;\n  // tableStore.transformTablebyCode();\n  // triggerRef(ref(tableStore.editor.mappingSpec.code));\n  //  watch\n  // PatternVis.methods!.handleCodeChange(tableStore.editor.mappingSpec.code);\n  patternVis.value.handleCodeChange(true); // handleCodeChange();\n  // loading.value = false;\n}\n\nfunction handleKeydown(event: KeyboardEvent) {\n  if (event.key === 'Escape') {\n    //  ESC \n    tableStore.editor.mappingSpec.decorations?.clear();\n    tableStore.input_tbl.instance.deselectCell();\n    tableStore.output_tbl.instance.deselectCell();\n    tableStore.input_tbl.instance.updateSettings({ cell: [] });\n    tableStore.output_tbl.instance.updateSettings({ cell: [] });\n    tableStore.highlightMinimapCells([]);\n\n    tableStore.clearStatus(\"tree\");\n    tableStore.clearStatus(\"matchArea\");\n    tableStore.clearStatus(\"miniHighlight\");\n\n  }\n}\n\nfunction handleCaseChange(value: string) {\n  tableStore.currentCase = value;\n  isDropdownOpen.value = false;\n}\n\nconst isDropdownOpen = ref(false);\nlet timeHandler: any = null;\nlet dropdownListEle: any = null;\n\nfunction selectEnter(e: any, v: any) {\n  isDropdownOpen.value = true;\n  if (dropdownListEle === null) {\n    setTimeout(() => {\n      dropdownListEle = document.querySelector(\".rc-virtual-list-holder-inner\");\n      dropdownListEle?.addEventListener('mouseenter', () => {\n        if (timeHandler !== null) {\n          clearTimeout(timeHandler);\n          timeHandler = null;\n        }\n        isDropdownOpen.value = true;\n      })\n      dropdownListEle?.addEventListener('mouseleave', () => {\n        isDropdownOpen.value = false;\n      })\n    }, 100)\n  }\n}\n\nfunction selectLeave(e: any, v: any) {\n  timeHandler = setTimeout(() => {\n    isDropdownOpen.value = false;\n  }, 200);\n}\n\nonMounted(() => {\n  tableStore.loadCaseData(tableStore.currentCase);\n  document.addEventListener('keydown', handleKeydown);\n  document.addEventListener(\"mousemove\", onDrag);\n  document.addEventListener(\"mouseup\", endDrag);\n});\n\n</script>\n\n<style lang=\"less\">\n#panel {\n  font-family: \"Arial\", sans-serif;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100vh;\n  margin: 0;\n  padding: 0;\n  background-color: #f0f0f0;\n  /* Background color for the whole panel */\n}\n\n.system-name {\n  font-size: 23px;\n  font-weight: bold;\n  width: calc(100vw - 40px);\n  margin-top: 2px;\n  //   margin: 20px 0;\n  padding: 10px 15px;\n  background-color: #3498db;\n  /* System name background color */\n  color: white;\n  /* System name text color */\n  //   border-radius: 8px;\n  text-align: center;\n\n  .el-switch__label {\n    color: #fff;\n    // font-size: 30px;\n  }\n\n  .el-switch__label.is-active {\n    color: #7bed9f;\n  }\n}\n\n.main-views {\n  display: flex;\n  justify-content: space-between;\n  width: calc(100vw - 10px);\n  padding: 1px;\n  box-sizing: border-box;\n  border: 1px solid #ccc;\n\n  // \n  svg.ov-icon+span {\n    margin-left: 5px;\n  }\n\n  .column {\n    height: calc(100vh - 56px);\n  }\n\n  .view {\n\n    // // height: calc(100vh - 80px);\n    .ant-tabs {\n      height: 100%;\n\n      .ant-tabs-content {\n        height: 100%;\n      }\n    }\n  }\n\n}\n\n.column {\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n\n.view {\n  //   margin: 8px 2px 2px 8px;\n  padding: 10px 8px 5px 8px;\n  // border: 1px solid #ccc;\n  //   border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  background-color: #ffffff;\n  /* View background color */\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n}\n\n.view-title {\n  font-size: 18px;\n  font-weight: bold;\n  margin-bottom: 10px;\n  color: #2c3e50;\n  overflow: auto;\n  /* View title text color */\n}\n\n.view-content {\n  // overflow-y: auto;\n  // overflow: hidden;\n  // height: calc(100% - 40px);\n  min-height: 0px;\n  flex: auto;\n}\n\n.mapping-details {\n  display: flex;\n  flex-direction: column;\n}\n\n\n.ant-message-notice-content {\n  white-space: pre-wrap;\n  /*  \\n  */\n  text-align: left;\n  /*  */\n  max-width: 700px;\n}\n\n.ant-btn-default {\n  transition: 0s;\n}\n\n.ant-btn-default:hover {\n  svg path {\n    stroke: #4494fc;\n  }\n}\n\n.ant-btn-default:disabled {\n  background-color: #ffffff;\n  border-color: #d9d9d9;\n  box-shadow: 0 2px 0 rgba(0, 0, 0, 0.02);\n  cursor: not-allowed;\n  color: rgba(0, 0, 0, 0.25);\n\n  svg path {\n    stroke: rgba(0, 0, 0, 0.25);\n  }\n}\n\n.divider-w {\n  width: 2px;\n  cursor: col-resize;\n  background-color: #ccc;\n}\n\n.divider-h {\n  height: 2px;\n  cursor: row-resize;\n  background-color: #ccc;\n}\n</style>\n","import script from \"./PanelView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./PanelView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./PanelView.vue?vue&type=style&index=0&id=62d42882&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { render } from \"./App.vue?vue&type=template&id=771c1db7&ts=true\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=771c1db7&lang=less\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\nimport { createPinia } from 'pinia'\n\nconst pinia = createPinia()\nconst app = createApp(App)\n\nimport { Select, Upload, Button, Tabs, Tooltip, Popover, Input, Modal, Space, Dropdown, Menu, Form, Row, Col, Radio, Divider, Flex, InputNumber } from \"ant-design-vue\";\n// import 'ant-design-vue/dist/reset.css';\n\napp.use(pinia).use(Select).use(Tabs).use(Button).use(Upload)\n    .use(Tooltip).use(Popover).use(Input).use(Modal).use(Space).use(Dropdown).use(Menu).use(Form).use(Row).use(Col).use(Radio).use(Divider).use(Flex).use(InputNumber);\n\n// A Vue component for including inline SVG icons from different popular iconpacks easily.\n// https://oh-vue-icons.js.org/docs   // MdFitscreenOutlined\nimport { OhVueIcon, addIcons } from \"oh-vue-icons\";\nimport { BiUpload, BiDownload, LaRocketSolid, BiArrowClockwise, IoArrowUndoOutline, IoArrowRedoOutline, BiChevronLeft, BiChevronRight } from \"oh-vue-icons/icons\";\n\naddIcons(BiUpload, BiDownload, LaRocketSolid, BiArrowClockwise, IoArrowUndoOutline, IoArrowRedoOutline, BiChevronLeft, BiChevronRight);\n\n// app.config.globalProperties.$basePath = process.env.BASE_URL;\n\napp.component(\"v-icon\", OhVueIcon);\n\n// import ElementPlus from 'element-plus'\n// app.use(ElementPlus)\n// import { ElButton, ElDropdown, ElSwitch } from 'element-plus'\n// app.use(ElButton).use(ElDropdown).use(ElSwitch)\n\n// import 'element-plus/dist/index.css'\n\napp.mount('#app')","import { defineStore } from 'pinia'\nimport Handsontable from \"handsontable\";\nimport * as d3 from 'd3';\nimport { shallowRef } from 'vue';\n\nimport { Table2D, TableCanoniserTemplate, TableCanoniserKeyWords, CellInfo, CellValueType, AreaInfo, completeCellConstraint } from \"@/table-canoniser/dist/grammar\"\nimport { transformTable, serialize, getCellBySelect } from \"@/table-canoniser/dist/parser\"\nimport { TreeChart, NodeData } from '@/utils/drawTree';\nimport { CustomError } from \"@/types\";\n\nimport { message } from 'ant-design-vue';\n\nimport * as monaco from \"monaco-editor\";\nimport * as ts from \"typescript\";\nimport { typeMapColor, TypeColor } from '@/utils/style';\n// import { colorConfig } from '@/tree/style';\n// import { cloneDeep } from 'lodash';\n\nfunction replaceEvenSpaces(str: string) {\n  // \n  return str.replace(/ {2,}/g, (match) => {\n    // \n    const length = match.length;\n\n    // \n    const halfLength = length / 2;\n\n    // \n    return ' '.repeat(halfLength);\n  });\n}\n\n// \nfunction removeWhitespace(str: string) {\n  return str.replace(/ /g, '') // .replace(/\\s+/g, '');  \n}\n\nfunction csvToMatrix(csvText: string) {\n  // \n  const rows = csvText.trim().split('\\n');\n\n  // \n  const matrix: Table2D = rows.map(row => row.split(','));\n\n  return matrix;\n}\n\nconst removeSpaceType = {\n  even: replaceEvenSpaces,\n  all: removeWhitespace,\n}\n\nexport interface TblCell {\n  row: number;\n  col: number;\n  className?: string;\n}\n\nexport interface TblPatternGrid {\n  row: number;\n  col: number;\n  text?: any; // string\n  textColor?: string;\n  bgColor?: string;\n}\n\n/** startRow, startCol, endRow, endCol */\nexport type Selection = [number, number, number, number];\n\ninterface TreeNode {\n  [key: string]: any,\n  children?: TreeNode[];\n}\n\nexport interface AreaBox {\n  width: number,\n  height: number,\n  x: number,\n  y: number,\n  instIndex?: number,\n  isDefinedFromSpec?: boolean\n}\n\n// type CoordinateMap = Map<number, Map<number, any>>;  // \n\nexport interface VisTreeNode extends TableCanoniserTemplate, AreaBox {\n  id?: number,\n  type?: \"position\" | \"value\" | \"context\" | \"null\",\n  path?: number[],\n  matchs?: AreaBox[],\n  currentMatchs?: AreaBox[],\n  // currentAreas?: AreaInfo[],\n  constrsInfo?: { x: number, y: number, isDefinedFromSpec: boolean, instIndex: number }[][],\n  children?: VisTreeNode[]\n}\n\nexport interface AreaForm {\n  offsetLayer: any,\n  offsetFrom: any,\n  position: {\n    x: any,\n    y: any\n  },\n  traverse: {\n    xDirection: any,\n    yDirection: any\n  },\n  size: {\n    width: any,\n    height: any\n  }\n}\n\nexport type ColInfo = {\n  width: number,  // column width\n  index: number, // column index\n  string: number[],\n  number: number[],\n  none: number[]\n}\n\n// define and expose a store\nexport const useTableStore = defineStore('table', {\n  // data\n  state() {\n    return {\n      caseList: shallowRef<string[]>([\"1. university\", \"2. university2\", \"3. model\", \"4. phone\", \"5. bank\", \"6. payroll\", \"7. York\"]),\n      currentCase: \"1. university\", // caseList[0],\n      currentInitData: shallowRef<Table2D>([]),\n      spec: {\n        undoHistory: [] as string[],  //  shallowRef computed \n        redoHistory: [] as string[],\n        rawSpecs: shallowRef<TableCanoniserTemplate[]>([]),\n        visTree: shallowRef<VisTreeNode>({ id: 0, width: 0, height: 0, x: 0, y: 0, type: \"null\", path: [], children: [] }),\n        visTreeMatchPath: shallowRef<{ [key: string]: VisTreeNode }>({}),\n        selectNode: shallowRef<NodeData | null>(null),\n        selectConstrIndex: -1,\n        constrNodeRectClickId: \"\",\n        selectAreaFromNode: \"\" as \"\" | \"0\" | \"1\" | \"2-0\" | \"2-1\" | \"2-2\" | \"3\" | \"4\",\n        selectAreaFromLegend: shallowRef<TypeColor[]>([]),\n        selectionsAreaFromLegend: shallowRef<Selection[]>([]),\n        selectionsPath: shallowRef<number[][]>([]),  // selectionrawSpecspath\n        dragConfigOpen: false,\n        // disableGoToInstFlag: true,\n        matchedInstNum: 0,\n        areaConfig: shallowRef<TableCanoniserTemplate>({\n          match: {\n            startCell: {},\n            size: {},\n            traverse: {},\n            constraints: [],\n          },\n          extract: null,\n          fill: '',\n          children: [],\n        }),\n        areaFormData: shallowRef<AreaForm>({\n          offsetLayer: null,\n          offsetFrom: null,\n          position: {\n            x: null,\n            y: null\n          },\n          traverse: {\n            xDirection: null,\n            yDirection: null\n          },\n          size: {\n            width: null,\n            height: null\n          }\n        }),\n      },\n      editor: {\n        mappingSpec: {\n          code: '',\n          codePref: 'const option: TableCanoniserTemplate[] = ',\n          codeSuff: '\\nreturn option;',\n          errorMark: null as monaco.editor.IMarker | null,\n          decorations: shallowRef<monaco.editor.IEditorDecorationsCollection | null>(null),\n          highlightCode: null as [number, number, string] | null,  // [startLine, endLine, color]\n          // language: 'typescript',\n          instance: shallowRef<monaco.editor.IStandaloneCodeEditor | null>(null),\n          triggerCodeChange: true,\n          codeUpdateFromEditor: false\n        },\n        rootArea: {\n          code: '',\n          codePref: 'const matchedResult: AreaInfo = ',\n          object: shallowRef<AreaInfo | null>(null),\n          // language: 'json',\n          instance: shallowRef<monaco.editor.IStandaloneCodeEditor | null>(null)\n        },\n      },\n      input_tbl: {\n        instance: {} as Handsontable,\n        // cells: [] as [number, number][],  // highlighted cells\n        tbl: shallowRef<Table2D>([]),  //  shallowRef  watch tbl watch  tbl ref \n        in2out: shallowRef<{ [key: string]: string[] }>({}),\n        in2nodes: shallowRef<{ [key: string]: Set<number> }>({}),  // 'x-y-width-height' -> {node.id} \n        colInfo: shallowRef<ColInfo[]>([]),\n      },\n      output_tbl: {\n        instance: {} as Handsontable,\n        // cells: [] as [number, number][], // highlighted cells\n        tbl: shallowRef<Table2D>([]),\n        cols: shallowRef<string[]>([]),\n        out2in: shallowRef<{ [key: string]: string[] }>({}),\n        colInfo: shallowRef<ColInfo[]>([]),\n      },\n      tree: {\n        contextMenuVisible: false,\n        instanceIndex: -1,\n        offset: {\n          left: { x: 0, y: 0 },\n          right: { x: 0, y: 0 }\n        },\n        visInst: shallowRef<TreeChart | null>(null),\n        tblVisHighlight: null as d3.Selection<SVGGElement, unknown, null, undefined> | null,\n        tblVisInfo: shallowRef<AreaBox | null>(null),  // tblTemplateinput tbl(x, y)(width, height)\n        minimapInstHighlight: null as d3.Selection<SVGGElement, unknown, null, undefined> | null,\n        minimapVisInfo: {\n          width: 0,\n          height: 0\n        },\n        menuAllList: [\n          //   {\n          //   key: \"0\",\n          //   label: \"Reset Area\",\n          //   title: \"Reset Area\",\n          //   // icon: () => h(MailOutlined),\n          // }, \n          {\n            key: \"3\",\n            label: \"Add Sub-Pattern\",\n            title: \"Add Sub-Pattern\",\n            // disabled: true\n            // icon: () => h(MailOutlined),\n          }, {\n            key: \"1\",\n            label: \"Add Constraint\",\n            title: \"Add Constraint\",\n            // icon: () => h(MailOutlined),\n            // disabled: true\n          }, {\n            key: \"2\",\n            label: \"Reset Target Cols\",\n            title: \"Reset Target Cols\",\n            children: [{\n              key: \"2-0\",\n              label: \"Position\",\n              title: \"Match and Extract by Position\",\n              // class: \"legend-position\",\n              style: { color: typeMapColor['position'] },  //  style \n            }, {\n              key: \"2-1\",\n              label: \"Context\",\n              title: \"Match and Extract by Context\",\n              style: { color: typeMapColor['context'] },\n            }, {\n              key: \"2-2\",\n              label: \"Value\",\n              title: \"Match and Extract by Value\",\n              style: { color: typeMapColor['value'] },\n            }, {\n              key: \"2-3\",\n              label: \"Region\",\n              title: \"Match Without Extraction\",\n              style: { color: typeMapColor['null'] },\n            }],\n          }, {\n            key: \"4\",\n            label: \"Delete This Pattern\",\n            title: \"Delete This Pattern\",\n            // disabled: true\n            // icon: () => h(MailOutlined),\n          }, {\n            key: \"5\",\n            label: \"Delete Constraint\",\n            title: \"Delete Constraint\",\n          }],\n        menuList: [] as Array<{ [key: string]: any }>,\n      }\n    }\n  },\n  // methods\n  actions: {\n    async loadCaseData(caseN: string) {\n      let prompt: string[] = [];\n      let case_path = `./${caseN}/`;\n      // const begin = Date.now();\n      try {\n        // Parallel processing of all fetch requests ==> faster: 0.678s vs 0.275s\n        const [data_res, spec_res] = await Promise.all([   // , script_res\n          fetch(case_path + 'data.csv'),  // 'data.json'\n          fetch(case_path + 'spec.js'),\n          // fetch(case_path + 'script.py')\n        ]);\n\n        // Parallel processing of all text extraction\n        const [dataText, specText] = await Promise.all([    // , scriptText\n          data_res.ok ? data_res.text() : Promise.resolve(null),\n          spec_res.ok ? spec_res.text() : Promise.resolve(null),\n          // script_res.ok ? script_res.text() : Promise.resolve(null)\n        ]);\n\n        this.initTblInfo();\n        this.clearStatus(\"matchArea\");\n        this.editor.mappingSpec.errorMark = null;\n        this.tree.instanceIndex = -1; // 0;\n        this.spec.selectNode = null;\n        this.editor.mappingSpec.highlightCode = null;\n\n        if (dataText !== null) {\n          this.input_tbl.tbl = csvToMatrix(dataText) // JSON.parse(dataText).input_tbl;\n          this.input_tbl.instance.updateData(this.input_tbl.tbl);\n          this.currentInitData = csvToMatrix(dataText);\n          // /50widthwidth\n          // HandsontableVueHandsontable\n          this.input_tbl.instance.render();\n          // document.getElementById('system_name')?.click();\n        } else {\n          prompt.push(`Failed to load data from ${caseN}`);\n        }\n\n        if (specText !== null) {\n          this.spec.undoHistory = [];\n          this.spec.redoHistory = [];\n          this.editor.mappingSpec.code = specText;\n          // this.transformTblUpdateRootArea();\n        } else {\n          prompt.push(`Failed to load spec from ${caseN}`);\n        }\n\n        // if (scriptText !== null) {\n        //   this.editor.transformScript.code = scriptText;\n        // } else {\n        //   prompt.push(`Failed to load script from ${caseN}`);\n        // }\n      } catch (error) {\n        prompt.push(`Error loading data: ${error}`);\n      }\n      // const end = Date.now();\n      // console.log(`Loaded case ${caseN} in seconds: ${(end - begin) / 1000}`);\n      this.currentCase = caseN;\n      prompt.forEach((msg) => {\n        message.error(msg);\n      })\n    },\n\n    /**\n     * Update visTree's matchs\n     */\n    traverseTree4UpdateMatchs(nodes: AreaInfo[], instIndex: number = -1) {\n      let visNode: VisTreeNode | null = null;\n      nodes.forEach((node, index) => {\n        const path = node.templateRef.toString()\n        const firstLayerFlag = node.templateRef.length === 1;\n        const isDefinedFromSpec = firstLayerFlag || node.isDefinedFromSpec\n        if (firstLayerFlag) instIndex = index;\n        if (!this.spec.visTreeMatchPath.hasOwnProperty(path)) {\n          visNode = this.getNodebyPath(this.spec.visTree.children!, node.templateRef) as VisTreeNode;\n          if (visNode === null) return;\n          this.spec.visTreeMatchPath[path] = visNode;\n          visNode.matchs = [{\n            x: node.x,\n            y: node.y,\n            width: node.width,\n            height: node.height,\n            instIndex,\n            isDefinedFromSpec\n          }];\n          // visNode.currentAreas = [node];\n          visNode.constrsInfo = [];\n          visNode.match?.constraints?.forEach((constraint) => {\n            const cellInfoSelections = [];\n            const allConstr = completeCellConstraint(constraint);\n            const cellInfo = getCellBySelect(allConstr, node, this.editor.rootArea.object!, true);\n            if (cellInfo) {\n              cellInfoSelections.push({ x: cellInfo.x, y: cellInfo.y, isDefinedFromSpec, instIndex });\n            }\n            visNode!.constrsInfo!.push(cellInfoSelections);\n          })\n        } else {\n          this.spec.visTreeMatchPath[path].matchs!.push({\n            x: node.x,\n            y: node.y,\n            width: node.width,\n            height: node.height,\n            instIndex,\n            isDefinedFromSpec\n          });\n          // this.spec.visTreeMatchPath[path].currentAreas!.push(node);\n          visNode = this.spec.visTreeMatchPath[path];\n          visNode.match?.constraints?.forEach((constraint, ci) => {\n            const cellInfoSelections = visNode!.constrsInfo![ci];\n            const allConstr = completeCellConstraint(constraint);\n            const cellInfo = getCellBySelect(allConstr, node, this.editor.rootArea.object!, true);\n            if (cellInfo) {\n              cellInfoSelections.push({ x: cellInfo.x, y: cellInfo.y, isDefinedFromSpec, instIndex });\n            }\n          })\n        }\n        this.traverseTree4UpdateMatchs(node.children, instIndex);\n      })\n    },\n\n    /**\n     * Update visTree's AreaBox properties\n     */\n    updateVisTreeAreaBox(node: VisTreeNode | null = null) {\n      if (node === null) {\n        if (this.spec.visTree.children!.length === 0) return;\n        node = this.spec.visTree.children![0];\n      }\n      if (node.matchs === undefined) return;\n      const matchedInsts = node.matchs.filter((match) => match.instIndex === this.tree.instanceIndex);\n      node.currentMatchs = [];\n      let isDefinedFromSpecInst: any = null;\n      matchedInsts.forEach((match) => {\n        if (node!.currentMatchs!.some((cm) => cm.x === match.x && cm.y === match.y)) return;\n        const newMatch: AreaBox = { ...match };\n        if (match.isDefinedFromSpec) {\n          if (isDefinedFromSpecInst === null) {\n            isDefinedFromSpecInst = newMatch;\n          } else {\n            newMatch.isDefinedFromSpec = false;\n          }\n        }\n        node!.currentMatchs!.push(newMatch);\n      })\n\n      if (isDefinedFromSpecInst !== null) {\n        node.x = isDefinedFromSpecInst.x;\n        node.y = isDefinedFromSpecInst.y;\n        node.width = isDefinedFromSpecInst.width;\n        node.height = isDefinedFromSpecInst.height;\n      } else {\n        const areaBox = node.currentMatchs[0];\n        node.x = areaBox.x;\n        node.y = areaBox.y;\n        node.width = areaBox.width;\n        node.height = areaBox.height;\n      }\n\n      if (node.children) {\n        node.children.forEach((child) => {\n          this.updateVisTreeAreaBox(child);\n        })\n      }\n    },\n\n    goToInstance(instance: number) {\n      if (this.spec.matchedInstNum === 0) {\n        // message.error(\"No matched instance!\");\n        return;\n      }\n      if (isNaN(instance)) {\n        message.error(\"The input number is invalid!\");\n        return;\n      }\n      instance = Math.round(instance);\n      const maxInst = this.spec.visTree.children![0].matchs!.length;\n      if (instance < 0 || instance >= maxInst) {\n        message.error(`The input number is out of range: [1, ${maxInst}]`);\n        return;\n      }\n      this.tree.instanceIndex = instance;\n      this.updateVisTreeAreaBox();\n      this.hightlightViewsAfterClickNode(this.spec.selectNode!.data);\n\n      if (this.tree.minimapInstHighlight && this.tree.minimapInstHighlight.selectAll('rect').size() === 0) {\n        this.highlightMinimapInsts();\n      };\n\n      const hightlight = this.tree.minimapInstHighlight!;\n      hightlight.selectAll('rect').attr('stroke', 'none');\n      hightlight.select(`rect:nth-child(${this.tree.instanceIndex + 1})`).attr('stroke', typeMapColor.selection);\n\n      this.updateCurve();\n\n    },\n    highlightMinimapInsts() {\n      const hightlight = this.tree.minimapInstHighlight!;\n      const visInfo = this.tree.minimapVisInfo!;\n      const tableStore = this;\n\n      hightlight.selectAll('rect').remove();\n      if (this.spec.visTree.children!.length === 0 || this.spec.visTree.children![0].matchs === undefined) return;\n      hightlight.raise().selectAll('rect').data(this.spec.visTree.children![0].matchs!.map((d, i) => ({ x: d.x, y: d.y, width: d.width, height: d.height, index: i })))\n        .enter().append('rect') // .classed('grid-inst', true)\n        .attr('x', d => d.x * visInfo.width)\n        .attr('y', d => d.y * visInfo.height)\n        .attr('width', d => d.width * visInfo.width)\n        .attr('height', d => d.height * visInfo.height)\n        .attr('fill', 'rgba(0, 0, 0, 0)')  //  none\n        .attr('stroke', (d, i) => {\n          if (i === this.tree.instanceIndex) {\n            return typeMapColor.selection;\n          } else {\n            return 'none';\n          }\n        })\n        .attr('stroke-width', 1.5)\n        .on('mouseover', function (event: any, d) {\n          d3.select(this).attr('stroke', typeMapColor.selection);\n        })\n        .on('mouseout', function (event, d) {\n          if (d.index !== tableStore.tree.instanceIndex)\n            d3.select(this).attr('stroke', 'none');\n        })\n        .on('click', function (event: any, d) {\n          // tableStore.goToInstance(d.index - tableStore.tree.instanceIndex);\n          tableStore.goToInstance(d.index);\n        })\n        .append('svg:title').text((d, i) => `The ${tableStore.numberToOrdinal(i + 1)} instance.\\nArea Box:\\n  x: ${d.x}\\n  y: ${d.y}\\n  width: ${d.width}\\n  height: ${d.height}`);\n    },\n\n    optimizeMiniTempDistance(maxDistance: number = 120) {\n      try {\n        const miniG = d3.select('g.left g.matrix')\n        const miniWidth = (miniG.node() as SVGGraphicsElement).getBBox().width\n        const distanceGap = this.tree.offset.right.x - this.tree.offset.left.x - miniWidth - maxDistance;\n\n        if (distanceGap > 0) {\n          this.tree.offset.left.x += distanceGap;\n          miniG.attr('transform', `translate(${this.tree.offset.left.x}, ${this.tree.offset.left.y})`);\n        }\n      } catch (e) {\n        console.error(e);\n      }\n    },\n\n    updateCurve() {\n      try {\n        const currentInstRect = this.tree.minimapInstHighlight!.select(`rect:nth-child(${this.tree.instanceIndex + 1})`);\n        const instRightX = +currentInstRect.attr('x') + +currentInstRect.attr('width');\n\n        const instTopY = +currentInstRect.attr('y');\n        const instBottomY = +currentInstRect.attr('y') + +currentInstRect.attr('height');\n\n\n        const tempRect = d3.select('rect.tbl-template-cell')\n        const tempLeftX = +tempRect.attr('x');\n        const tempTopY = +tempRect.attr('y');\n        const tempBottomY = +tempRect.attr('y') + +tempRect.attr('height') * this.spec.visTree.children![0].height;\n\n        const miniG = d3.select('g.left g.matrix')\n        const tempG = d3.select('g.right g.tbl-template')\n\n        // \n        const instTransform = (miniG.node() as SVGGraphicsElement).getCTM()!;\n        const tempTransform = (tempG.node() as SVGGraphicsElement).getCTM()!;\n\n        const applyTransform = (x: number, y: number, transform: DOMMatrix) => {\n          return {\n            x: transform.a * x + transform.e,\n            y: transform.d * y + transform.f\n          }\n        }\n\n        // \n        const rectTopRight = applyTransform(instRightX, instTopY, instTransform);\n        const rectBottomRight = applyTransform(instRightX, instBottomY, instTransform);\n        const rectRightTopLeft = applyTransform(tempLeftX, tempTopY, tempTransform);\n        const rectRightBottomLeft = applyTransform(tempLeftX, tempBottomY, tempTransform);\n\n        const lineGenerator = d3.line().curve(d3.curveCatmullRom);\n        // \n        const pathData1 = lineGenerator([\n          [rectTopRight.x, rectTopRight.y],\n          [rectRightTopLeft.x, rectRightTopLeft.y]\n        ]);\n\n        const pathData2 = lineGenerator([\n          [rectBottomRight.x, rectBottomRight.y],\n          [rectRightBottomLeft.x, rectRightBottomLeft.y]\n        ]);\n\n        d3.select('path.top-line').attr(\"d\", pathData1);\n        d3.select('path.bottom-line').attr(\"d\", pathData2);\n      }\n      catch (e) {\n        d3.select('path.top-line').attr(\"d\", \"\");\n        d3.select('path.bottom-line').attr(\"d\", \"\");\n      }\n    },\n\n    /**\n     * Update in2nodes and selectionsAreaFromLegend and selectAreaFromLegend of each node\n     */\n    traverseTree4UpdateIn2Nodes(nodes: VisTreeNode[], parentPath: number[] = [], idCounter: [number] = [1]) {\n      const in2nodes = this.input_tbl.in2nodes;\n      nodes.forEach((node, index) => {\n        node.id = idCounter[0]++;\n        //  path\n        const currentPath = [...parentPath, index];\n        node.path = currentPath;\n\n        const areaKey = `${node.x}-${node.y}-${node.width}-${node.height}`;\n\n        // nodetypeselectionsAreaFromLegendselectAreaFromLegend\n        node.type = \"null\";\n        if (node.extract !== undefined && node.extract != null) {\n          let extractKeys = 0;\n          if (node.extract.byValue !== undefined) {\n            node.type = \"value\";\n            extractKeys++; // extractKeys.push('byValue');\n          }\n          if (node.extract.byContext !== undefined) {\n            node.type = \"context\";\n            extractKeys++; // extractKeys.push('byContext');\n          }\n          if (node.extract.byPositionToTargetCols !== undefined) {\n            node.type = \"position\";\n            extractKeys++; // extractKeys.push('byPositionToTargetCols');\n          }\n\n          if (this.editor.mappingSpec.highlightCode === null && extractKeys > 1) {\n            this.editor.mappingSpec.highlightCode = [...this.getHighlightCodeStartEndLine(node.extract, this.getNodebyPath(this.spec.rawSpecs, node.path!)), 'selectionShallow'];\n\n            const startLine = this.editor.mappingSpec.highlightCode[0];\n            const endLine = this.editor.mappingSpec.highlightCode[1];\n            message.warning(`Multiple keys (${Object.keys(node.extract)}) detected in 'extract' (lines ${startLine}-${endLine}). We'll prioritize and parse in this order: byPositionToTargetCols, byContext, byValue. Any others will be ignored.\\nPlease provide only one key for accurate processing.`)\n            this.editor.mappingSpec.triggerCodeChange = false; //  handleCodeChange \n            this.stringifySpec();\n          }\n        }\n        this.spec.selectionsAreaFromLegend.push([node.y, node.x, node.y + node.height - 1, node.x + node.width - 1]);\n        this.spec.selectAreaFromLegend.push(node.type)\n        this.spec.selectionsPath.push(node.path);\n\n        if (in2nodes.hasOwnProperty(areaKey)) {\n          in2nodes[areaKey].add(node.id!);\n        } else {\n          in2nodes[areaKey] = new Set([node.id!]);\n        }\n        node.matchs?.forEach((match) => {\n          const { x, y, width, height } = match;\n          const areaKey = `${x}-${y}-${width}-${height}`;\n          if (in2nodes.hasOwnProperty(areaKey)) {\n            in2nodes[areaKey].add(node.id!);\n          } else {\n            in2nodes[areaKey] = new Set([node.id!]);\n          }\n        })\n        if (node.children) this.traverseTree4UpdateIn2Nodes(node.children, currentPath, idCounter);\n      })\n    },\n\n    transformTblUpdateRootArea(specs: TableCanoniserTemplate[] = []) {\n      const { rootArea, tidyData } = transformTable(this.input_tbl.tbl, specs);\n      // this.editor.rootArea.codePref + JSON.stringify(rootArea)\n      this.editor.rootArea.object = rootArea;\n      const strSpec = serialize(rootArea);\n      //  JSON \n      const removeQuotesFromKeysRegex = /\"(\\w+)\":/g;\n      this.editor.rootArea.code = this.editor.rootArea.codePref + strSpec.replace(removeQuotesFromKeysRegex, '$1:');\n      // this.editor.rootArea.instance!.setValue(this.editor.rootArea.code);\n      this.traverseTree4UpdateMatchs(rootArea.children);\n      this.tree.instanceIndex = 0;\n      this.updateVisTreeAreaBox();\n      this.input_tbl.in2nodes = {};\n      this.spec.selectAreaFromLegend = []\n      this.spec.selectionsAreaFromLegend = []\n      this.spec.selectionsPath = []\n      this.editor.mappingSpec.highlightCode = null;\n      this.traverseTree4UpdateIn2Nodes(this.spec.visTree.children!);\n      return tidyData;\n    },\n\n    generateHighlightCells(selected: Selection[], classNames: string[] = []): TblCell[] {\n      const cells: TblCell[] = [];\n      if (classNames.length === 0) {\n        classNames = Array(selected.length).fill(\"null\");\n      }\n      selected.forEach((range, ri) => {\n        for (let row = range[0]; row <= range[2]; row++) {\n          for (let col = range[1]; col <= range[3]; col++) {\n            cells.push({ row, col, className: classNames[ri] });\n          }\n        }\n      });\n      return cells;\n    },\n\n    highlightTblCells(tbl: \"input_tbl\" | \"output_tbl\", cells: TblCell[], coords: [number, number][] | null = null, rowFlag = true, colFlag = true) {\n      this[tbl].instance.updateSettings({ cell: cells });\n      if (coords === null) {\n        coords = cells!.map((c) => [c.row, c.col] as [number, number]);\n      }\n      if (coords.length) {\n        let { topLeft, rowSize, colSize } = this.startPoint(coords);\n        // \n        const visibleRows = this[tbl].instance.countVisibleRows();\n        const visibleCols = this[tbl].instance.countVisibleCols();\n        this[tbl].instance.scrollViewportTo({\n          row: rowFlag ? (rowSize === 1 ? Math.max(0, topLeft[0] - Math.floor(visibleRows / 2)) : Math.max(0, topLeft[0] - 2)) : undefined,\n          col: colFlag ? (colSize === 1 ? Math.max(0, topLeft[1] - Math.floor(visibleCols / 2)) : Math.max(0, topLeft[1] - 1)) : undefined,\n          verticalSnap: \"top\",\n          horizontalSnap: \"start\",\n        });\n      }\n    },\n\n    highlightMinimapCells(cells: TblCell[], clear = true) {\n      if (clear) d3.selectAll('g.matrix rect.grid-cell').attr('class', 'grid-cell');\n      cells.forEach((cell) => {\n        if (cell.className) {\n          d3.select(`g.matrix #grid-${cell.row}-${cell.col}`).raise()\n            .classed(cell.className, true)\n        }\n      });\n    },\n\n\n\n    hightlightViewsAfterClickNode(visData: VisTreeNode) {\n      const matchArea: Array<[number, number, number, number]> = [];\n      visData.matchs?.forEach((match) => {\n        const { x, y, width, height } = match;\n        matchArea.push([y, x, y + height - 1, x + width - 1]);\n      })\n      let allHightedInCells: TblCell[] = [];\n      let allHightedOutCells: TblCell[] = [];\n      if (matchArea.length > 0) {\n        const { selectedCoords, hightedCells } = this.getHightlightedCells(matchArea, `${visData.type}Shallow`);\n        allHightedInCells = allHightedInCells.concat(hightedCells);\n        const cells = this.in_out_mapping(selectedCoords, \"input_tbl\", `${visData.type}Shallow`);\n        allHightedOutCells = allHightedOutCells.concat(cells);\n        this.highlightMinimapCells(hightedCells);\n      }\n\n      const selected: Array<[number, number, number, number]> = [[visData.y, visData.x, visData.y + visData.height - 1, visData.x + visData.width - 1]];\n      const { selectedCoords, hightedCells } = this.getHightlightedCells(selected, visData.type!);\n      allHightedInCells = allHightedInCells.concat(hightedCells);\n      this.highlightTblCells(\"input_tbl\", allHightedInCells, Object.values(selectedCoords)[0]);\n      const cells = this.in_out_mapping(selectedCoords, \"input_tbl\", visData.type);\n      allHightedOutCells = allHightedOutCells.concat(cells);\n      const coordsOut = cells.map((c) => [c.row, c.col] as [number, number]);\n      this.highlightTblCells(\"output_tbl\", allHightedOutCells, coordsOut);\n      this.highlightMinimapCells(hightedCells, matchArea.length === 0);\n      //  D3.js  .classed() CSS  CSS  D3.js \n\n      this.input_tbl.instance.deselectCell();\n      this.output_tbl.instance.deselectCell();\n    },\n\n    in_out_mapping(selectedCoords: { [key: string]: [number, number][] }, type: \"input_tbl\" | \"output_tbl\", className: string = \"selection\") {\n      const posi_mapping = type === \"input_tbl\" ? this.input_tbl.in2out : this.output_tbl.out2in;\n      if (Object.keys(posi_mapping).length === 0) {\n        return [];\n      }\n      let cells: TblCell[] = [];\n      let posi: string[] = [];\n      for (let range in selectedCoords) {\n        selectedCoords[range].forEach((pi) => {\n          posi = posi.concat(posi_mapping[`[${pi[0]},${pi[1]}]`]);\n        });\n      }\n      // console.log(posi, posi_mapping);\n      if (posi) {\n        posi.forEach((pi) => {\n          if (pi && pi.startsWith(\"[\") && pi.endsWith(\"]\")) {\n            let pi_n = JSON.parse(pi) as [number, number];\n            cells.push({ row: pi_n[0], col: pi_n[1], className });\n          }\n        });\n      }\n      return cells;\n    },\n\n    doRectanglesIntersect(rect1: AreaBox, rect2: AreaBox): boolean {\n      return (\n        rect1.x < rect2.x + rect2.width &&\n        rect1.x + rect1.width > rect2.x &&\n        rect1.y < rect2.y + rect2.height &&\n        rect1.y + rect1.height > rect2.y\n      );\n    },\n\n    //  A  B\n    isRectanglesContained(parent: Selection, child: Selection): boolean {\n      const [pStartRow, pStartCol, pEndRow, pEndCol] = parent;\n      const [cStartRow, cStartCol, cEndRow, cEndCol] = child;\n\n      return (\n        pStartRow <= cStartRow &&\n        pStartCol <= cStartCol &&\n        pEndRow >= cEndRow &&\n        pEndCol >= cEndCol\n      );\n    },\n\n    findMaxCNumber(arr: any[] | null = null) {\n      if (arr === null) arr = this.output_tbl.cols;\n\n      let maxNumber = 0;\n\n      arr.forEach(ele => {\n        //  \"C\" \n        if (typeof ele !== 'string') return;\n        const match = ele.match(/^C(\\d+)$/);\n        if (match) {\n          const number = parseInt(match[1], 10);\n          if (number > maxNumber) {\n            maxNumber = number;\n          }\n        }\n      });\n\n      //  null  -1 \n      return maxNumber;\n    },\n\n    buildTree(selections: Selection[], types: string[], paths: number[][]) {\n      const rootNodes: TreeNode[] = [];\n\n      const insertNode = (parent: TreeNode, child: TreeNode): boolean => {\n        if (!parent.children) {\n          parent.children = [];\n        }\n        // \n        for (const existingChild of parent.children) {\n          if (this.isRectanglesContained(existingChild.selection, child.selection)) {\n            return insertNode(existingChild, child);\n          }\n        }\n        // \n        parent.children.push(child);\n        return true;\n      }\n\n      for (let i = 0; i < selections.length; i++) {\n        const selection = selections[i];\n        const newNode: TreeNode = { type: types[i], selection, path: paths[i] };\n\n        let added = false;\n        for (const rootNode of rootNodes) {\n          if (this.isRectanglesContained(rootNode.selection, selection)) {\n            added = insertNode(rootNode, newNode);\n            break;\n          }\n        }\n\n        if (!added) {\n          rootNodes.push(newNode);\n        }\n      }\n      const specs: TableCanoniserTemplate[] = [];\n      const addedSpec: [any] = [null];\n      this.traverseTree4buildSpecs(rootNodes, specs, [0, 0, this.input_tbl.tbl.length - 1, this.input_tbl.tbl[0].length - 1], addedSpec);\n      return { rootNodes, specs, newSpec: addedSpec[0] };\n    },\n\n    traverseTree4buildSpecs(nodes: TreeNode[], specs: TableCanoniserTemplate[], pSelection: Selection, addedSpec: [any]) {\n      const px = pSelection[1], py = pSelection[0];\n      const pw = pSelection[3] - px + 1, ph = pSelection[2] - py + 1;\n      nodes.forEach((node) => {\n\n        const newSpec: TableCanoniserTemplate = {};\n        const { selection, type } = node;\n\n        if (node.path.length > 0) {\n          const targetNode = this.getNodebyPath(this.spec.rawSpecs, node.path);\n          this.copyAttributes(targetNode!, newSpec, ['match', 'extract', 'fill']);\n        } else {\n\n          const [startRow, startCol, endRow, endCol] = selection;\n          const width = endCol - startCol + 1;\n          const height = endRow - startRow + 1;\n          const traverse = {\n            xDirection: pw >= 2 * width ? 'after' as const : undefined,\n            yDirection: ph >= 2 * height ? 'after' as const : undefined\n          }\n          if (nodes.length > 1) {\n            traverse.xDirection = undefined;\n            traverse.yDirection = undefined;\n          }\n          newSpec.match = {\n            startCell: { offsetX: startCol - px, offsetY: startRow - py },\n            size: { width, height },\n            traverse\n          }\n\n          const maxCNum = this.findMaxCNumber() + 1;\n\n          switch (type) {\n            case \"position\":\n              newSpec.extract = {\n                // byPositionToTargetCols: Array.from({ length: width * height }, (_, _i) => `C${++colCount}`)\n                byPositionToTargetCols: Array.from({ length: width * height }, (_, i) => `C${maxCNum + i}`)\n              }\n              break;\n            case \"context\":\n              newSpec.extract = {\n                byContext: {\n                  position: 'above'\n                }\n              }\n              break;\n            case \"value\":\n              const createExtract = () => {\n                return eval(`currentAreaTbl => {\n                  // Please replace the default code with the necessary implementation to complete the function.\n                  return currentAreaTbl.flat().map((cell, i) => 'C' + (${maxCNum} + i))\n                  }`)\n              }\n              newSpec.extract = {\n                byValue: createExtract()\n              }\n              break;\n            // case \"null\": \n            // default:\n            //   break;\n          }\n          addedSpec[0] = newSpec;\n        }\n\n        if (node.children) {\n          newSpec.children = [];\n          this.traverseTree4buildSpecs(node.children, newSpec.children, selection, addedSpec);\n        }\n        specs.push(newSpec);\n      })\n    },\n\n\n\n    highlightNodes(selected: Selection[]) {\n      const highlightNodesId: Set<number> = new Set();\n      selected.forEach(range => {\n        const y = range[0];\n        const x = range[1];\n        const height = range[2] - range[0] + 1;\n        const width = range[3] - range[1] + 1;\n\n        const rect1: AreaBox = { x, y, width, height };\n\n        for (let keyArea in this.input_tbl.in2nodes) {\n          const [x, y, width, height] = keyArea.split('-').map((n) => Number(n));\n          // console.log(rect1, keyArea, this.doRectanglesIntersect(rect1, { x, y, width, height }));\n          if (this.doRectanglesIntersect(rect1, { x, y, width, height })) {\n            this.input_tbl.in2nodes[keyArea].forEach((id) => {\n              highlightNodesId.add(id);\n            })\n          }\n        }\n      });\n      d3.selectAll('.type-node').classed('selection', false);\n      for (let id of highlightNodesId) {\n        // console.log(`.type-node.node-rect-${id}`);\n        d3.select(`.type-node.node-rect-${id}`).classed(\"selection\", true);\n      }\n      return highlightNodesId;\n    },\n\n    highlightTblTemplate(areas: AreaBox[]) {\n      try {\n        const highlight = this.tree.tblVisHighlight!;  // .tbl-container .tbl-template-highlight\n        const tblVisInfo = this.tree.tblVisInfo!;\n\n        areas.forEach((area) => {\n          if (area.x === undefined || area.y === undefined || area.width === undefined || area.height === undefined) {\n            return\n          }\n          highlight.raise().append('rect')\n            .attr('x', (area.x - tblVisInfo.x) * tblVisInfo.width)\n            .attr('y', (area.y - tblVisInfo.y) * tblVisInfo.height)\n            .attr('width', area.width * tblVisInfo.width)\n            .attr('height', area.height * tblVisInfo.height)\n            .attr('fill', 'none')\n            .attr('stroke', typeMapColor.selection)\n            .attr('stroke-width', 3)\n            .attr(\"stroke-dasharray\", area.isDefinedFromSpec ? \"0\" : \"6,6\");\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    },\n\n    /*\n    highlightNodes(selected: Selection[]) {\n      const highlightNodesId: Set<number> = new Set();\n      selected.forEach(range => {\n        let startRow = range[0] < 0 ? 0 : range[0];\n        let startCol = range[1] < 0 ? 0 : range[1];\n        let endRow = range[2];\n        let endCol = range[3];\n    \n        // \n        for (let row = startRow; row <= endRow; row++) {\n          // \n          for (let col = startCol; col <= endCol; col++) {\n            //  visTree\n            const nodes = JSON.parse(JSON.stringify(this.spec.visTree.children!));\n            while (nodes.length) {\n              const node = nodes.shift()\n              if (!node) continue;\n              console.log(row, col, node.y, node.height, node.x, node.width);\n              if (row >= node.y && row < node.y + node.height && col >= node.x && col < node.x + node.width) {\n                highlightNodesId.add(node.id);\n              }\n              if (node.children) nodes.push(...node.children);\n            }\n          }\n        }\n      })\n      d3.selectAll('.type-node').classed('selection', false);\n      for (let id of highlightNodesId) {\n        console.log(`.type-node.node-rect-${id}`);\n        d3.select(`.type-node.node-rect-${id}`).classed(\"selection\", true);\n      }\n    },\n    */\n\n    getHightlightedCells(selected: Selection[], className: string = \"selection\") {\n      let selectedCoords: { [key: string]: [number, number][] } = {};\n      let hightedCells: { row: number, col: number, className: string }[] = [];\n      // \n      selected.forEach(range => {\n        const startRow = range[0];\n        const startCol = range[1];\n        const endRow = range[2];\n        const endCol = range[3];\n\n        selectedCoords[range.toString()] = [];\n        // \n        for (let row = startRow; row <= endRow; row++) {\n          // \n          for (let col = startCol; col <= endCol; col++) {\n            // \n            selectedCoords[range.toString()].push([row, col]);\n            hightedCells.push({ row, col, className });\n          }\n        }\n      });\n      return { selectedCoords, hightedCells };\n    },\n\n    grid_cell_click(cell: TblCell, className: string = \"selection\") {\n      const cells: TblCell[] = [{ ...cell, className }];\n      this.highlightTblCells(\"input_tbl\", cells);\n      const outTblCells = this.in_out_mapping({ \"0\": [[cell.row, cell.col]] }, \"input_tbl\", className);\n      this.highlightTblCells(\"output_tbl\", outTblCells);\n    },\n\n    startPoint(points: [number, number][]) {\n      let topLeft = points[0];\n      const rows = new Set([topLeft[0]]);\n      const cols = new Set([topLeft[1]]);\n\n      for (let i = 1; i < points.length; i++) {\n        let current = points[i];\n        rows.add(current[0]);\n        cols.add(current[1]);\n        if (\n          current[0] < topLeft[0] ||\n          (current[0] === topLeft[0] && current[1] < topLeft[1])\n        ) {\n          topLeft = current;\n        }\n      }\n\n      return {\n        topLeft,\n        rowSize: rows.size,\n        colSize: cols.size,\n      };\n    },\n\n    prepareDataAfterCodeChange() {\n      const codeFormat = \"Example format:\\n\" + this.editor.mappingSpec.codePref + \"[\\n // Please write the specification here\\n];\"\n      try {\n        // Step 1: update specs, including rawSpecs and visTree\n        // let code = this.editor.mappingSpec.instance!.getValue();\n        let code = this.editor.mappingSpec.code;\n        if (code.trim() === \"\") {\n          message.error(\"Empty code!\\nPlease provide your code input. \" + codeFormat);\n          return false;\n        };\n        code += this.editor.mappingSpec.codeSuff;\n        const result = ts.transpileModule(code, {\n          compilerOptions: {\n            target: ts.ScriptTarget.ES2015,\n            module: ts.ModuleKind.CommonJS\n          }\n        })\n        // console.log(result.outputText);\n        // const specification: TableCanoniserTemplate = eval(code);\n        const evalFunction = new Function('TableCanoniserKeyWords', result.outputText);\n        const specs: TableCanoniserTemplate[] = evalFunction(TableCanoniserKeyWords);\n        if (Array.isArray(specs) === false) {\n          message.error(\"Invalid code!\\nPlease provide your code input. \" + codeFormat);\n          return false;\n        }\n        this.spec.rawSpecs = specs;\n        this.spec.visTree.children = JSON.parse(JSON.stringify(specs, (key, value) => typeof value === 'function' ? 'function' : value)); // cloneDeep(specs);\n        // this.spec.visTree.children!.forEach((spec) => {\n        //   if (!spec.hasOwnProperty('children')) {\n        //     spec.children = [];\n        //   }\n        // })\n\n\n        // Step 2: highlightCode\n        // if (this.editor.mappingSpec.highlightCode) {\n        //   console.log('prepareDataAfterCodeChange-highlightCode', this.editor.mappingSpec.highlightCode);\n        //   this.highlightCode(...this.editor.mappingSpec.highlightCode);\n        //   this.editor.mappingSpec.highlightCode = null;\n        // }\n\n        // Step 3: update visTree's AreaBox properties\n        // const { rootArea } = transformTable(this.input_tbl.tbl, this.spec.rawSpecs, false);\n        // console.log(rootArea);\n        // console.log(rootArea, this.spec.visTree, this.spec.rawSpecs, this.input_tbl.tbl[0]);\n        // this.copyTreeAttributes(rootArea, this.spec.visTree);\n        // console.log(rootArea, this.spec.visTree);\n\n        // Step 4: update in2nodes\n        /*\n        this.input_tbl.in2nodes = {};\n        this.spec.selectAreaFromLegend = []\n        this.spec.selectionsAreaFromLegend = []\n        this.spec.selectionsPath = []\n        this.traverseTree4UpdateIn2Nodes(this.spec.visTree.children!);*/\n        return true\n      }\n      catch (e: any) {\n        if (e.message.includes(\"option\")) {\n          message.error(e + \"\\n\" + codeFormat);\n        }\n        else message.error(`Failed to parse the specification:\\n ${e}`);\n        return false;\n      }\n    },\n\n    numberToOrdinal(num: number) {\n      let suffix = \"th\";\n\n      if (num % 100 >= 11 && num % 100 <= 13) {\n        suffix = \"th\";\n      } else {\n        switch (num % 10) {\n          case 1:\n            suffix = \"st\";\n            break;\n          case 2:\n            suffix = \"nd\";\n            break;\n          case 3:\n            suffix = \"rd\";\n            break;\n        }\n      }\n\n      return num + suffix;\n    },\n\n    checkGrammarError() {\n      const markers = monaco.editor.getModelMarkers({});\n      if (markers.length > 0) {\n        markers.forEach((marker) => {\n          if (marker.code != \"6133\") {\n            // \"<name> is declared but its value is never read\" \n            this.editor.mappingSpec.errorMark = marker;\n            return\n          }\n        })\n      } else {\n        this.editor.mappingSpec.errorMark = null\n      }\n    },\n\n    transformTablebyCode() {\n      if (this.editor.mappingSpec.errorMark !== null) {\n        const marker = this.editor.mappingSpec.errorMark;\n        message.error(`Invalid syntax at Line ${marker.startLineNumber}, Column ${marker.startColumn}:\\n ${marker.message}`);\n        return;\n      }\n      let messageContent = ''\n      try {\n        const specs = this.spec.rawSpecs;\n        // this.stringifySpec(); // () editor.mappingSpec.code\n        this.spec.visTreeMatchPath = {};\n        const tidyData = this.transformTblUpdateRootArea(specs);\n        this.initTblInfo(false);\n        // this.tree.visInst?.render();\n\n        this.spec.matchedInstNum = 0;\n        this.spec.visTree.children?.forEach((spec, index) => {\n          if (index) messageContent += '\\n';\n          else if (spec.matchs) {\n            this.spec.matchedInstNum = spec.matchs.length;\n          }\n          if (spec.matchs) {\n            if (spec.matchs.length > 1) {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, ${spec.matchs.length} instances are matched.`\n            } else if (spec.matchs.length === 1) {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, only one instance is matched.`\n            } else {\n              messageContent += `For the ${this.numberToOrdinal(index + 1)} template, no instance is matched.`\n            }\n          } else {\n            messageContent += `For the ${this.numberToOrdinal(index + 1)} template, no instance is matched.`\n          }\n        })\n\n        if (Object.keys(tidyData).length === 0) {\n          if (messageContent) messageContent += '\\n';\n          messageContent += 'The output table is empty based on the specification.';\n          // this.tree.instanceIndex = -1;\n          // return;\n        }\n        message.info(messageContent)\n\n        // tidyDataoutput_tbl.tbl\n        this.derivePosiMapping(tidyData);\n        // console.log(this.output_tbl.tbl, this.output_tbl.cols);\n        this.output_tbl.instance.updateData(this.output_tbl.tbl);\n        this.output_tbl.instance.updateSettings({ colHeaders: this.output_tbl.cols });\n        // this.output_tbl.instance.render();\n\n        // this.tree.minimapInstHighlight!.select('rect:nth-child(1)').attr('stroke', typeMapColor.selection);\n        this.highlightMinimapInsts();\n      } catch (e) {\n        if (e instanceof CustomError) {\n          messageContent = `Failed to transform the table based on the specification:\\n ${e}`\n        } else {\n          messageContent = `Failed to parse the specification:\\n ${e}`\n        }\n        message.error(messageContent);\n        console.error(e);\n      }\n    },\n\n    derivePosiMapping(outTbl: { [key: string]: CellInfo[] }) {\n      const cols = Object.keys(outTbl);\n      this.output_tbl.cols = cols;\n      // const numRows = outTbl[cols[0]].length;\n      const numRows = Math.max(...cols.map(col => outTbl[col].length));\n\n      // Create the in_out mapping\n      for (let i = 0; i < numRows; i++) {\n        const row: CellValueType[] = [];\n        // this.output_tbl.out2in.rows.push([]);\n        for (let j = 0; j < cols.length; j++) {\n          const col = cols[j];\n          let cell: CellInfo;\n          if (outTbl[col].length <= i) {\n            cell = { x: -1, y: -1, value: undefined };\n          } else {\n            cell = outTbl[col][i];\n          }\n          row.push(cell.value);\n          let inPosi = `[${cell.y},${cell.x}]`;\n          const outPosi = `[${i},${j}]`;\n          // console.log(inPosi, outPosi);\n          if (cell.x < 0 || cell.y < 0) {\n            inPosi = '';\n          } else {\n            if (this.input_tbl.in2out.hasOwnProperty(inPosi)) {\n              this.input_tbl.in2out[inPosi].push(outPosi);\n            } else {\n              this.input_tbl.in2out[inPosi] = [outPosi];\n            }\n          }\n\n          if (this.output_tbl.out2in.hasOwnProperty(outPosi)) {\n            this.output_tbl.out2in[outPosi].push(inPosi);\n          } else {\n            this.output_tbl.out2in[outPosi] = [inPosi];\n          }\n        }\n        this.output_tbl.tbl.push(row);\n      }\n    },\n\n    generateGrid(rows: number, cols: number): TblPatternGrid[] {\n      const grid: TblPatternGrid[] = [];\n      for (let i = 0; i < rows; i++) {\n        for (let j = 0; j < cols; j++) {\n          grid.push({ row: i, col: j });\n        }\n      }\n      return grid;\n    },\n\n    computeTblPatternGrid() {\n      // const firstNode: VisTreeNode = JSON.parse(JSON.stringify(this.spec.visTree.children![0], function (key, value) {\n      //   if (key === 'currentAreas') return undefined;\n      //   return value;\n      // }));\n      // const firstNode: VisTreeNode = JSON.parse(JSON.stringify(this.spec.visTree.children![0]));\n      const firstNode = this.spec.visTree.children![0];\n\n      const grids = this.generateGrid(firstNode.height, firstNode.width);\n      const nodes = [firstNode];\n      // const box: AreaBox = { width: firstNode.width, height: firstNode.height, x: firstNode.x, y: firstNode.y };\n      // const box: AreaBox = (({ width, height, x, y }) => ({ width, height, x, y }))(firstNode); // { ...firstNode };\n      const box: Selection = [firstNode.x, firstNode.y, firstNode.x + firstNode.width, firstNode.y + firstNode.height];\n\n      while (nodes.length) {\n        const node = nodes.shift() as VisTreeNode;\n\n        // const xDirection = node.match?.traverse?.xDirection;\n        // const yDirection = node.match?.traverse?.yDirection;\n        // if ((xDirection === undefined || xDirection === null) && (yDirection === undefined || yDirection === null)) {};\n\n\n        // if (!(node.x >= box[0] && node.y >= box[1] && node.x + node.width <= box[2] && node.y + node.height <= box[3])) continue;\n\n        // \n        // node.matchs!.forEach(match => {});\n        if (node.matchs === undefined) continue;\n        for (const match of node.matchs) {\n          const { x, y, width, height } = match;\n          const offsetX = x - box[0];\n          const offsetY = y - box[1];\n\n          if (!(offsetX >= 0 && offsetY >= 0 && x + width <= box[2] && y + height <= box[3])) continue;\n\n          let bgColor: TypeColor = node.type!;\n          let textColor: TypeColor = \"cellFill\";\n          if (bgColor !== 'position') {\n            textColor = \"ambiguousText\"\n          }\n          // if (!(x === node.x && y === node.y && width === node.width && height === node.height)) {\n          if (node.path!.length > 1 && match.isDefinedFromSpec === false) {\n            bgColor += \"Shallow\";\n          }\n          for (let i = 0; i < height; i++) {\n            for (let j = 0; j < width; j++) {\n              const cell = grids[(offsetY + i) * firstNode.width + (offsetX + j)]\n              cell.bgColor = bgColor; // typeMapColor[bgColor as TypeColor];\n              cell.text = new Set();\n              cell.textColor = textColor; // typeMapColor[textColor];\n              if (this.input_tbl.in2out.hasOwnProperty(`[${y + i},${x + j}]`)) {\n                const outPosi = this.input_tbl.in2out[`[${y + i},${x + j}]`];\n                outPosi.forEach(posi => {\n                  const [outY, outX] = JSON.parse(posi);\n                  cell.text.add(this.output_tbl.cols[outX]);\n                })\n              }\n              cell.text = Array.from(cell.text);\n            }\n          }\n        }\n        if (node.children && node.children.length) nodes.push(...node.children);\n      }\n\n      return grids; // { grids, box: (({ width, height, x, y }) => ({ width, height, x, y }))(firstNode) };\n    },\n\n    initTblInfo(inputFlag = true) {\n      if (inputFlag) {\n        this.input_tbl.tbl = []\n        this.input_tbl.instance.updateData(this.input_tbl.tbl);\n      }\n\n      this.input_tbl.in2out = {};\n\n      this.output_tbl.tbl = [];\n      this.output_tbl.cols = [];\n      this.output_tbl.out2in = {};\n      this.output_tbl.instance.updateData(this.output_tbl.tbl);\n      this.output_tbl.instance.updateSettings({ colHeaders: this.output_tbl.cols });\n    },\n\n    deleteChildByPath(nodes: TreeNode[], path: number[], constrIndex: number = -1) {\n      if (path.length === 0) {\n        // \n        return;\n      }\n\n      if (constrIndex !== -1) {\n        // \n        const currentNode = this.getNodebyPath(nodes, path) as TableCanoniserTemplate;\n        if (currentNode) {\n          currentNode.match!.constraints!.splice(constrIndex, 1);\n          if (currentNode.match!.constraints!.length === 0) {\n            delete currentNode.match!.constraints;\n          }\n        }\n        return\n      }\n\n      // \n      const parentPath = path.slice(0, -1);\n      const lastIndex = path[path.length - 1];\n\n      if (parentPath.length === 0) {\n        // \n        nodes.splice(lastIndex, 1);\n        return;\n      }\n\n      const parentNode = this.getNodebyPath(nodes, parentPath);\n\n      // \n      if (parentNode && parentNode.children) {\n        parentNode.children.splice(lastIndex, 1);\n        // children\n        if (parentNode.children.length === 0) {\n          delete parentNode.children;\n        }\n      }\n    },\n\n    getNodebyPath(nodes: TreeNode[], path: number[]) {\n      if (path.length === 0) return null; // null\n\n      let currentNodes = nodes\n      for (let i = 0; i < path.length; i++) {\n        const index = path[i];\n        // \n        if (!currentNodes[index]) {\n          return null; // \n        }\n        // \n        if (i === path.length - 1) {\n          return currentNodes[index];\n        }\n        // \n        currentNodes = currentNodes[index].children || [];\n      }\n      //  null\n      return null;\n    },\n    /**\n     * rawSpecseditor.mappingSpec.code\n     */\n    stringifySpec(specs: any = null, replaceSpace: \"even\" | \"all\" = \"even\", replaceCode = true) {\n      let fnList: string[] = [];\n      if (specs === null) specs = this.spec.rawSpecs;\n      let strSpec = JSON.stringify(specs, replacer, 2);\n      fnList.forEach((fn) => {\n        strSpec = strSpec.replace(`\"$TableCanoniser$\"`, fn);\n      })\n\n      //  JSON \n      const removeQuotesFromKeysRegex = /\"(\\w+)\":/g;\n      strSpec = strSpec.replace(removeQuotesFromKeysRegex, '$1:');\n\n      const replaceTableCanoniserKeyWordsRegex = /\"TableCanoniserKeyWords\\.(\\w+)\"/g;\n      strSpec = strSpec.replace(replaceTableCanoniserKeyWordsRegex, 'TableCanoniserKeyWords.$1');\n\n      if (replaceSpace === \"all\") {\n        strSpec = removeSpaceType.all(strSpec);\n      }\n\n      if (replaceCode) {\n        this.spec.undoHistory.push(this.editor.mappingSpec.code);\n        // \n        this.spec.redoHistory = [];\n        this.editor.mappingSpec.code = this.editor.mappingSpec.codePref + strSpec;\n        // this.editor.mappingSpec.instance?.setValue(this.editor.mappingSpec.code);\n        // this.editor.mappingSpecinstance?.getAction('editor.action.formatDocument')?.run();\n        // this.editor.mappingSpec.instance?.trigger('editor', 'editor.action.formatDocument', null);\n      }\n\n      function replacer(key: string, value: any) {\n        if (typeof value === 'function') {\n          fnList.push(removeSpaceType[replaceSpace](value.toString()));\n          return \"$TableCanoniser$\" // value.toString(); // \n        }\n        return value;\n      }\n\n      return strSpec;\n    },\n\n    selectArea() {\n      const visNode = this.spec.selectNode!.data;\n      const formData = this.spec.areaFormData\n      const newSpec: TableCanoniserTemplate = {\n        match: {\n          startCell: {\n            offsetLayer: formData.offsetLayer,\n            offsetFrom: formData.offsetFrom,\n            offsetX: formData.position.x,\n            offsetY: formData.position.y,\n          },\n          size: {\n            width: formData.size.width,\n            height: formData.size.height,\n          },\n          traverse: {\n            xDirection: formData.traverse.xDirection,\n            yDirection: formData.traverse.yDirection,\n          }\n        }\n      }\n      if (visNode.path!.length === 0) {\n        // \n        this.spec.rawSpecs.push(newSpec);\n      } else {\n        const currentSpec = this.getNodebyPath(this.spec.rawSpecs, visNode.path!);\n        if (currentSpec === null) {\n          message.error(\"The node path is invalid\");\n          return;\n        }\n        if (currentSpec.hasOwnProperty('children') && currentSpec.children != undefined) {\n          currentSpec.children.push(newSpec)\n        } else {\n          currentSpec.children = [newSpec];\n        }\n      }\n      this.stringifySpec();\n    },\n\n    insertNodeOrPropertyIntoSpecs(nodeOrProperty: any, property: \"children\" | \"match\" | \"constraints\" | \"extract\", visNode: VisTreeNode | null = null) {\n      if (visNode === null) {\n        visNode = this.spec.selectNode!.data;\n      }\n      if (visNode.path!.length === 0) {\n        // \n        this.spec.rawSpecs.push({ match: nodeOrProperty });\n      } else {\n        const currentSpec = this.getNodebyPath(this.spec.rawSpecs, visNode.path!);\n        if (currentSpec === null) {\n          message.error(\"The node path is invalid\");\n          return;\n        }\n        switch (property) {\n          case \"children\":\n            if (currentSpec.hasOwnProperty('children') && currentSpec.children != undefined) {\n              currentSpec.children.push({ match: nodeOrProperty });\n            } else {\n              currentSpec.children = [{ match: nodeOrProperty }];\n            }\n            break;\n          case \"match\":\n            if (currentSpec.hasOwnProperty('match') && currentSpec.match != undefined) {\n              Object.assign(currentSpec.match, nodeOrProperty);\n            } else {\n              currentSpec.match = nodeOrProperty;\n            }\n            break;\n          case \"constraints\":\n            if (currentSpec.hasOwnProperty('match') && currentSpec.match != undefined) {\n              if (currentSpec.match.hasOwnProperty('constraints') && currentSpec.match.constraints != undefined) {\n                currentSpec.match.constraints.push(nodeOrProperty);\n              } else {\n                currentSpec.match.constraints = [nodeOrProperty];\n              }\n            } else {\n              currentSpec.match = {\n                constraints: [nodeOrProperty]\n              };\n            }\n            break;\n          case \"extract\":\n            currentSpec.extract = nodeOrProperty;\n            break;\n        }\n      }\n      this.stringifySpec();\n    },\n\n\n    // \n    copyAttributes(source: TreeNode, target: TreeNode, attributes: string[]) {\n      for (const attr of attributes) {\n        if (source.hasOwnProperty(attr)) {\n          target[attr] = source[attr];\n        }\n      }\n    },\n\n    // \n    copyTreeAttributes(tree1: TreeNode, tree2: TreeNode, attributes = ['width', 'height', 'x', 'y']) {\n      this.copyAttributes(tree1, tree2, attributes);\n\n      if (tree1.children && tree2.children) {\n        // if (tree1.children.length > tree2.children.length) {\n        //   console.log(tree1.children);\n        //   console.log(tree2.children);\n        // }\n        for (let i = 0; i < tree1.children.length; i++) {\n          // console.log(tree1.children[i], tree2.children[i]);\n          this.copyTreeAttributes(tree1.children[i], tree2.children[i], attributes);\n        }\n      }\n    },\n\n    getHighlightCodeStartEndLine(sonData: any, sonParentData: any = null, rootData: any = null): [number, number] {\n      if (rootData === null) {\n        rootData = this.spec.rawSpecs\n      }\n      const rootStr = this.stringifySpec(rootData, \"all\", false)\n      const sonStr = this.stringifySpec(sonData, \"all\", false)\n\n      if (sonParentData === null) {\n        const startIndex = rootStr.indexOf(sonStr);\n        const strBefore = rootStr.slice(0, startIndex);\n        const startLine = (strBefore.match(/\\n/g) || []).length + 1;\n        const endLine = startLine + (sonStr.match(/\\n/g) || []).length;\n        return [startLine, endLine]\n      } else {\n        const [startParentLine, _] = this.getHighlightCodeStartEndLine(sonParentData);\n        const [startConstLine, endConstLine] = this.getHighlightCodeStartEndLine(sonData, null, sonParentData);\n        const startLine = startParentLine + startConstLine - 1;\n        const endLine = startParentLine + endConstLine - 1;\n        return [startLine, endLine]\n      }\n    },\n\n    highlightCode(startLine: number, endLine: number = startLine, className: string = \"nullShallow\") {\n      const editor = this.editor.mappingSpec.instance\n      const decorationsCollection = this.editor.mappingSpec.decorations\n      if (editor && decorationsCollection) {\n        const range = new monaco.Range(startLine, 1, endLine, 1);\n        const newDecorations: monaco.editor.IModelDeltaDecoration[] = [\n          {\n            range,\n            options: {\n              isWholeLine: true,\n              className: className  // 'myLineDecoration',\n            },\n          },\n        ];\n        // \n        decorationsCollection.set(newDecorations);\n        // editor.revealLineInCenter(startLine);\n        // editor.revealLineNearTop(startLine);\n        // editor.revealRangeNearTopIfOutsideViewport(range);\n        // editor.setSelection(range);  // \n        editor.revealRangeAtTop(range);\n      }\n    },\n    computeColInfo(tblType: 'input_tbl' | 'output_tbl' = 'input_tbl') {\n      const table = this[tblType].tbl;\n      this[tblType].colInfo = [];\n      if (table.length === 0) return;\n      const hot = this[tblType].instance;\n      const colCount = table[0].length;\n\n      for (let col = 0; col < colCount; col++) {\n        const colInfo: ColInfo = {\n          index: col,\n          width: hot.getColWidth(col),\n          string: [],\n          number: [],\n          none: []\n        };\n\n        if (colInfo.width === null) colInfo.width = 60; // truncated  min-width  60\n\n        for (let row = 0; row < table.length; row++) {\n          const cell = table[row][col];\n          const type = this.getCellDataType(cell);\n          switch (type) {\n            case TableCanoniserKeyWords.String:\n              colInfo.string.push(row);\n              break;\n            case TableCanoniserKeyWords.Number:\n              colInfo.number.push(row);\n              break;\n            case TableCanoniserKeyWords.None:\n              colInfo.none.push(row);\n              break;\n          }\n        }\n        this[tblType].colInfo.push(colInfo);\n      }\n    },\n\n    getCellDataType(value: CellValueType) {\n      if (value === '' || value === null || value === undefined) {\n        return TableCanoniserKeyWords.None;\n      }\n      if (!isNaN(Number(value))) {\n        return TableCanoniserKeyWords.Number;\n      }\n      if (typeof value === 'string') {\n        return TableCanoniserKeyWords.String;\n      }\n      return TableCanoniserKeyWords.NotNone;\n    },\n    clearStatus(type: string) {\n      switch (type) {\n        case \"matchArea\":\n          document.body.style.cursor = 'default';\n          document.documentElement.style.setProperty('--custom-cursor', 'default');\n          d3.selectAll('.legend').classed('legend-selection', false);\n          // this.spec.selectAreaFromLegend = []\n          // this.spec.selectionsAreaFromLegend = []\n          break;\n        case \"tree\":\n          /*\n          const typeNodes = document.querySelectorAll('.type-node');\n          typeNodes.forEach((node) => {\n            (node as HTMLElement).classList.remove('selection');\n          });\n          const constraintRects = document.querySelectorAll('.node-constraint-rect');\n          constraintRects.forEach((rect) => {\n            // (rect as HTMLElement).style.visibility = 'hidden';\n            (rect as HTMLElement).setAttribute('visibility', 'hidden');\n          });\n          */\n          this.spec.constrNodeRectClickId = '';\n          d3.selectAll('.type-node').classed('selection', false);\n          d3.selectAll('.node-constraint-rect').attr('visibility', 'hidden');\n          break;\n        case \"miniHighlight\":\n          this.tree.minimapInstHighlight!.selectAll('rect').remove();\n          d3.select('path.top-line').attr(\"d\", \"\");\n          d3.select('path.bottom-line').attr(\"d\", \"\");\n          break\n      }\n    },\n    debounce<T extends (...args: any[]) => void>(func: T, wait: number): (...args: Parameters<T>) => void {\n      let timeout: any = null;\n      return function (...args: Parameters<T>) {\n        if (timeout) clearTimeout(timeout);\n        timeout = setTimeout(() => {\n          func(...args);\n        }, wait);\n      };\n    }\n  },\n  // computed\n  getters: {}\n})\n\n\nexport type TableStore = ReturnType<typeof useTableStore>;","export interface ChatMessage {\n    role: string\n    content: string\n}\n\nexport class CustomError extends Error {\n    constructor(message: string, name: string = \"CustomError\") {\n        super(message);\n        this.name = name;\n        Object.setPrototypeOf(this, new.target.prototype);\n    }\n}\n\n\n// The Declarative Grammar v0.2\n\n/**\n * PositionFn: (pi: Position2D, areaCells: AreaCellInfo[])\n * For startCell and endCell:\n *   pi is the instance index that matches this template (pi.row means traverse in the row direction, pi.col means traverse in the col direction)\n *   areaCells contains all the selected cells of parent template area\n * For context:\n *   pi is the cell index position of this template area\n *   areaCells contains all the selected cells of this template area\n */\ntype PositionFn = (pi: Position2D, areaCells: AreaCellInfo[]) => Position\n\n/**\n * Set rules for value, if return false, means the value does not meet the rule\n */\ntype CheckValueFn = (value: string) => boolean\n\n/**\n * Derive the target variable based on the selected/context cells\n * vi: the cell index of this template area\n * areaCells: all selected cells of this template area\n * contextCells: the context cells corresponding to the selected cells of this template area (Note that there may be multiple context cells for each selected cell, so contextCells is a 2D array)\n */\ntype DeriveTargetFn = (vi: number, areaCells: AreaCellInfo[], contextCells: AreaCellInfo[][]) => string | string[]\n\ninterface Position {\n    // If null, means no rule for row/col\n    row?: number | null,\n    col?: number | null\n}\n\ninterface Position2D {\n    row: number\n    col: number\n}\n\n/**\n * For startCell and endCell:\n * if position is not null, means involving position-based selection\n * if value is not null, means involving value-based selection\n */\ntype CellInfo = {\n    position: Position | PositionFn,\n    value?: CheckValueFn | string // | number | null\n}\n\ntype AreaCellInfo = {\n    position: Position2D,\n    value: string // string | number | null\n}\n\ninterface TableTidierMapping {\n    startCell?: CellInfo,\n    endCell?: CellInfo,\n    // if context is not null, means involving value-based selection\n    context?: CellInfo[],\n    subMapping?: TableTidierMapping[],\n    // if target is string or string[], means position-based mapping;\n    // if target is function, means value-based or context-based mapping;\n    target?: string | string[] | DeriveTargetFn\n}\n\n\n// The Declarative Grammar v0.3\n\ntype cellValueType = string | number;\n\nenum TableTidierKeyWords {\n    String,\n    Number,\n    None\n}\n\n// Function types\n\n/**\n * A function type that calculates an offset based on the current area information and the root area information.\n * @param currentAreaInfo - The current area information.\n * @param rootAreaInfo - The root area information.\n * @returns The calculated offset.\n */\ntype offsetFn = (currentAreaInfo: AreaInfo, rootAreaInfo: AreaInfo) => number;\n\n/**\n * A function type that checks if a cell value meets a custom condition.\n * @param value - The value of the cell.\n * @returns A boolean indicating whether the cell value meets the condition.\n */\ntype checkValueFn = (value: cellValueType) => boolean;\n\n/**\n * A function type that maps the cells in an area to their corresponding target columns.\n * @param currentAreaCells - The cells in the current area.\n * @returns An array of target column names or null values.\n */\ntype mapColsFn = (currentAreaCells: AreaCell[]) => (string | null)[];\n\n/**\n * A function type that maps a context value to a target column.\n * @param contextValue - The value of the context cell.\n * @returns The name of the target column or null.\n */\ntype mapColbyContextFn = (contextValue: cellValueType) => string | null;\n\n/**\n * A function type that selects a range of cells based on the current area information and the root area information.\n * @param currentAreaInfo - The current area information.\n * @param rootAreaInfo - The root area information.\n * @returns An array of cell selections.\n */\ntype contextPosiFn = (currentAreaInfo: AreaInfo, rootAreaInfo: AreaInfo) => CellSelection[];\n\n/**\n * A function type that determines the layer of an area based on its current area information.\n * @param currentAreaInfo - The current area information.\n * @returns The layer number of the area.\n */\ntype areaLayerFn = (currentAreaInfo: AreaInfo) => number;\n\n// Represents a single cell within an area\ninterface AreaCell {\n    xOffset: number;   // The x-axis offset of the cell within the area\n    yOffset: number;   // The y-axis offset of the cell within the area\n    value: cellValueType;  // The value of the cell\n}\n\n// Represents a selected area within the table\ninterface AreaInfo {\n    parent: AreaInfo | null;  // The parent area of this area\n    areaLayer: number;        // The layer level of this area within the root area\n    templateIndex: number;    // The template index of this area within the parent area\n    xIndex: number;           // The x-axis index of this area within the parent area\n    yIndex: number;           // The y-axis index of this area within the parent area\n    xOffset: number;          // The x-axis offset of this area within the parent area\n    yOffset: number;          // The y-axis offset of this area within the parent area\n    x: number;                // The x-coordinate of this area within the entire table\n    y: number;                // The y-coordinate of this area within the entire table\n    width: number;            // The width of this area\n    height: number;           // The height of this area\n    areaCells: AreaCell[];    // All cells within this area\n    children: AreaInfo[];     // The child areas of this area\n}\n\n// Represents the selection of a cell within the table\ninterface CellSelection {\n    referenceAreaLayer?: 'current' | 'parent' | 'root' | areaLayerFn;  // The reference area layer for selection, default is 'current'\n    referenceAreaPosi?: 'topLeft' | 'bottomLeft' | 'topRight' | 'bottomRight';  // The reference area position for selection, default is 'topLeft'\n    xOffset?: number | offsetFn;  // The x-axis offset relative to the reference area, default is 0\n    yOffset?: number | offsetFn;  // The y-axis offset relative to the reference area, default is 0\n}\n\n/**\n* Represents a constraint on a cell's value\n* - `valueCstr`: The value constraint.\n*   - `cellValueType`: Specifies that the cell's value must be equal to the provided value.\n*   - `TableTidierKeyWords`: Specifies that the cell's value must be of the specified type (`String` or `Number`).\n*   - `checkValueFn`: Specifies a custom function to check if the cell's value meets certain conditions.\n*/\ninterface CellConstraint extends CellSelection {\n    // The value constraint can be a specific value, a type (string or number), or a custom check function\n    valueCstr: cellValueType | TableTidierKeyWords | checkValueFn;\n}\n\n/**\n * ContextTransform specifies how to derive the target column for a cell based on its context cell.\n * \n * - `position`: Defines the location of the context cell relative to the current cell.\n *   - 'above': The context cell is located directly above the current cell.\n *   - 'below': The context cell is located directly below the current cell.\n *   - 'left': The context cell is located directly to the left of the current cell.\n *   - 'right': The context cell is located directly to the right of the current cell.\n *   - `contextPosiFn`: A custom function to determine the position of the context cell.\n * \n * - `targetCol`: Determines how to derive the target column based on the context cell's value.\n *   - null: Uses the context cell's value as the target column. If the context cell's value is null or empty, the target column will be null, and this cell will not be transformed to the output table.\n *   - `mapColbyContextFn`: A custom function to map the context cell's value to a specific target column. If the function returns null, the cell will not be transformed to the output table.\n */\ninterface ContextTransform {\n    position: 'above' | 'below' | 'left' | 'right' | contextPosiFn;\n    targetCol: null | mapColbyContextFn;\n}\n\n\n// The main template for defining the transformation rules\ninterface TableTidierTemplate {\n    startCell: CellSelection;  // The starting cell for the selection\n    size?: {\n        width?: number | 'toParentX' | undefined;  // The width of the selection area, 'toParentX' means the distance from the startCell to the parent's x-axis end; undefined means no width constraint, default is 1\n        height?: number | 'toParentY' | undefined; // The height of the selection area, 'toParentY' means the distance from the startCell to the parent's y-axis end; undefined means no height constraint, default is 1\n    };\n    constraints?: CellConstraint[];  // Constraints to apply to the cells within the selection area\n    traverse?: {\n        // The traversal direction for the selection area: 'after' means traversing after the startCell; 'before' means traversing before the startCell; 'whole' means traversing the entire area; default is 'none', meaning no traversal\n        xDirection?: 'none' | 'after' | 'before' | 'whole';  // The x-axis traversal direction \n        yDirection?: 'none' | 'after' | 'before' | 'whole';  // The y-axis traversal direction\n    };\n    transform?: {\n        context?: ContextTransform;  // The context-based transformation for the selection area\n        // The target columns for the transformation, which can be an array (position-based transformation), 'context' (context-based transformation), or a custom function (value-based transformation)\n        targetCols: (string | null)[] | 'context' | mapColsFn;\n    };\n    children?: TableTidierTemplate[];  // The child templates for nested selections\n}\n\n\n\ntype Pair = { value: number, originalIndex: number, correspondingValue: string };\n\nfunction sortWithCorrespondingArray(A: any[], B: string[], sortOrder: 'asc' | 'desc'): string[] {\n    // Create a combined array of objects\n    let combined: Pair[] = A.map((value, index) => ({\n        value: value,\n        originalIndex: index,\n        correspondingValue: B[index]\n    }));\n\n    // Sort the combined array based on the value in the specified order\n    combined.sort((a, b) => {\n        if (sortOrder === 'asc') {\n            return a.value - b.value;\n        } else {\n            return b.value - a.value;\n        }\n    });\n\n    // Extract the sorted corresponding values based on the original indices\n    let sortedB: string[] = new Array(B.length);\n    combined.forEach((pair, index) => {\n        sortedB[pair.originalIndex] = pair.correspondingValue;\n    });\n\n    return sortedB;\n}","/* eslint-disable no-param-reassign */\nimport * as d3 from 'd3';\n// import { useTableStore } from '@/store/table';  // pinia store\n\nimport {\n  typeMapColor, TypeColor,\n  typeNodeStyle,\n  nodeTextStyle,\n} from './style';\nimport {\n  Point, RectDef, KV,\n} from './types';\nimport letterAspectRatio from './letterAspectRatio';\nimport { VisTreeNode, TableStore, Selection } from \"@/store/table\";\nimport { CellConstraint, TableCanoniserKeyWords } from '@/table-canoniser/dist/grammar';\n\n\nexport type NodeData = {\n  [key: string]: any,\n  children: NodeData[],\n  parent: NodeData | null,\n  data: VisTreeNode\n}\n\n/** Escape */\nconst escapeEvent = new KeyboardEvent('keydown', {\n  key: 'Escape',\n  code: 'Escape',\n  keyCode: 27,\n  charCode: 27,\n  which: 27,\n  bubbles: true,\n  cancelable: true\n});\n\n\nconst getLetterWidth = (\n  letter: string,\n  fontSize: number,\n) => fontSize * (letterAspectRatio[letter as keyof typeof letterAspectRatio] || 1);\n\nconst getTextSize = (text: string, fontSize: number) => {\n  let width = 0;\n  // eslint-disable-next-line prefer-regex-literals\n  const pattern = new RegExp('[\\u4E00-\\u9FFF]+');\n  text.split('')\n    .forEach((letter) => {\n      if (pattern.test(letter)) {\n        // \n        width += fontSize;\n      } else {\n        width += getLetterWidth(letter, fontSize);\n      }\n    });\n  return [width, fontSize];\n};\n\nconst fittingString = (input: string, maxWidth: any, fontSize: any) => {\n  const ellipsis = '...';\n  const ellipsisLength = getTextSize(ellipsis, fontSize)[0];\n  let currentWidth = 0;\n  let result = input;\n  // eslint-disable-next-line prefer-regex-literals\n  const pattern = new RegExp('[\\u4E00-\\u9FFF]+');\n  input.split('')\n    .forEach((letter: string, i) => {\n      if (currentWidth > maxWidth - ellipsisLength) {\n        return;\n      }\n      if (pattern.test(letter)) {\n        // Chinese charactors\n        currentWidth += fontSize;\n      } else {\n        // get the width of single letter according to the fontSize\n        currentWidth += getLetterWidth(letter, fontSize);\n      }\n      if (currentWidth > maxWidth - ellipsisLength) {\n        result = `${input.slice(0, i)}${ellipsis}`;\n      }\n    });\n  return result;\n};\n\nfunction diagonal(source: Point, target: Point) {\n  const { x, y } = source;\n  const { x: ex, y: ey } = target;\n\n  const xrvs = ex - x < 0 ? -1 : 1;\n  const yrvs = ey - y < 0 ? -1 : 1;\n\n  const rdef = 15;\n  let r = Math.abs(ex - x) / 2 < rdef ? Math.abs(ex - x) / 2 : rdef;\n\n  r = Math.abs(ey - y) / 2 < r ? Math.abs(ey - y) / 2 : r;\n\n  const h = Math.abs(ey - y) / 2 - r;\n  const w = Math.abs(ex - x) - r * 2;\n  // w=0;\n  const path = `\n      M ${x} ${y}\n      L ${x} ${y + h * yrvs}\n      C  ${x} ${y + h * yrvs + r * yrvs} ${x} ${y + h * yrvs + r * yrvs} ${x + r * xrvs} ${y + h * yrvs + r * yrvs}\n      L ${x + w * xrvs + r * xrvs} ${y + h * yrvs + r * yrvs}\n      C  ${ex}  ${y + h * yrvs + r * yrvs} ${ex}  ${y + h * yrvs + r * yrvs} ${ex} ${ey - h * yrvs}\n      L ${ex} ${ey}\n`;\n  return path;\n}\n\nfunction hdiagonal(source: Point, target: Point) {\n  const { x, y } = source;\n  const { x: ex, y: ey } = target;\n\n  // Values in case of top reversed and left reversed diagonals\n  const xrvs = ex - x < 0 ? -1 : 1;\n  const yrvs = ey - y < 0 ? -1 : 1;\n\n  // Define preferred curve radius\n  const rdef = 15;\n\n  // Reduce curve radius, if source-target x space is smaller\n  let r = Math.abs(ex - x) / 2 < rdef ? Math.abs(ex - x) / 2 : rdef;\n\n  // Further reduce curve radius, is y space is more small\n  r = Math.abs(ey - y) / 2 < r ? Math.abs(ey - y) / 2 : r;\n\n  // Defin width and height of link, excluding radius\n  const h = Math.abs(ey - y) / 2 - r;\n  const w = Math.abs(ex - x) / 2 - r;\n\n  // Build and return custom arc command\n  return `\n      M ${x} ${y}\n      L ${x + w * xrvs} ${y}\n      C ${x + w * xrvs + r * xrvs} ${y}\n        ${x + w * xrvs + r * xrvs} ${y}\n        ${x + w * xrvs + r * xrvs} ${y + r * yrvs}\n      L ${x + w * xrvs + r * xrvs} ${ey - r * yrvs}\n      C ${x + w * xrvs + r * xrvs}  ${ey}\n        ${x + w * xrvs + r * xrvs}  ${ey}\n        ${ex - w * xrvs}  ${ey}\n      L ${ex} ${ey}\n  `;\n}\n\nfunction customRectCorner(rectInfo: RectDef) {\n  const {\n    startx, starty, rectWidth, rectHeight, rounded, radius,\n  } = rectInfo;\n  let path;\n\n  switch (rounded) {\n    case 'left':\n      path = `\n      M${startx + radius},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - radius}\n      v${rectHeight}\n      h${-rectWidth + radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z\n      `;\n      break;\n    case 'right':\n      path = `\n      M${startx},${starty}\n      h${rectWidth - radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - 2 * radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h ${radius - rectWidth}\n      z\n      `;\n      break;\n    case 'top':\n      path = `\n      M${startx},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - 2 * radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - radius}\n      h${-rectWidth}\n      z`;\n      break;\n    case 'bottom':\n      path = `\n      M${startx},${starty}\n      h${rectWidth}\n      v${rectHeight - radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h${-rectWidth + 2 * radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z`;\n      break;\n    case 'all': // 936\n      path = `\n      M${startx},${starty + radius}\n      a${radius},${radius} 0 0 1 ${radius},-${radius}\n      h${rectWidth - 2 * radius}\n      a${radius},${radius} 0 0 1 ${radius},${radius}\n      v${rectHeight - 2 * radius}\n      a${radius},${radius} 0 0 1 ${-radius},${radius}\n      h${-rectWidth + 2 * radius}\n      a${radius},${radius} 0 0 1 -${radius},-${radius}\n      z`;\n      break;\n    default: {\n      path = `\n      M${startx}${starty}\n      h${rectWidth}\n      v${rectHeight}\n      h${-rectWidth}\n      v${-rectHeight}\n      z\n      `;\n      break;\n    }\n  }\n\n  return path;\n}\n\nfunction declareContextMenu(tableStore: TableStore, node: NodeData, constrIndex: number, event: MouseEvent) {\n  event.preventDefault();\n  // event.stopPropagation();\n  // console.log(tableStore, node, constrIndex, event);  //  this\n  event.preventDefault();\n\n  if (node.parent === null) {\n    tableStore.tree.menuList = [tableStore.tree.menuAllList[3]];\n  } else if (constrIndex === -1) {\n    tableStore.tree.menuList = tableStore.tree.menuAllList.slice(0, -1);\n  } else {\n    tableStore.tree.menuList = tableStore.tree.menuAllList.slice(-1);\n    tableStore.spec.selectConstrIndex = constrIndex;\n  }\n  // console.log(\"node\", node);\n  tableStore.spec.selectNode = node;\n  tableStore.tree.contextMenuVisible = true;\n}\n\nexport class TreeChart {\n  svgWidth: number;\n  svgHeight: number;\n  margins: Array<number>;\n  container: string;\n  data: any;\n  zoomLevel: number;\n  resetZoom: any;\n  depth: number;\n  calculated: KV; // SVG\n  treeLayout: any; // layout\n  realChart: any;\n  previousTransform: any;\n  centerG: any;\n  centerX: number;\n  root: any; // children\n  allNodes: any; // rootlayout\n  defaultFont: string;\n  duration: number;\n  store: TableStore;\n  orient: 'h' | 'v';\n\n  constructor(\n    _margins: Array<number>,\n    _container: string,\n    _data: any,\n    _store: any,\n    _zoomLevel = 1.0,\n    _orient: 'h' | 'v' = 'h' as const,\n  ) {\n    this.svgWidth = 500;\n    this.svgHeight = 500;\n    this.margins = _margins;\n    this.container = _container;\n    this.zoomLevel = _zoomLevel;\n    this.orient = _orient;\n    this.depth = 10;\n    this.calculated = {};\n    this.treeLayout = null;\n    this.realChart = null;\n    this.previousTransform = null;\n    this.centerX = 0;\n    this.root = null;\n    this.allNodes = null;\n    this.defaultFont = 'Helevtica';\n    this.duration = 600;\n    this.data = _data;\n    this.store = _store;\n\n    this.setZoomFactor.bind(this);\n    this.batchEnterExitUpdate();\n  }\n\n  // \n  public setZoomFactor() {\n    const currentWidth = this.centerG.node()\n      .getBoundingClientRect().width;\n    let targetZoomLevel = this.svgWidth / currentWidth;\n    targetZoomLevel = targetZoomLevel > 1 ? 1 : targetZoomLevel;\n    this.zoomLevel = targetZoomLevel;\n\n    if (this.orient === 'h') {\n      this.centerG.attr('transform', `translate(${this.calculated.nodeMaxWidth / 2}, ${this.calculated.centerY}) scale(${targetZoomLevel})`);\n    } else {\n      this.centerG.attr('transform', `translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight / 2}) scale(${targetZoomLevel})`);\n    }\n  }\n\n  /*\n  private handleCircleClick(_: any, d: any) {\n    if (d.children) {\n      d.hiddenChildren = d.children;\n      d.children = null;\n    } else {\n      if (d.hiddenChildren) d.children = d.hiddenChildren;\n      d.hiddenChildren = null;\n    }\n\n    this.update(d);\n  }\n\n  private handleRectClick(\n    _: any,\n    parent: any,\n    childrenToToggle: Array<any>,\n  ) {\n    // childrenToToggle children\n    if (parent.children && AincludeB(parent.children, childrenToToggle)) {\n      if (!parent.hiddenChildren) {\n        parent.hiddenChildren = [];\n      }\n      parent.hiddenChildren = parent.hiddenChildren.concat(childrenToToggle);\n      parent.children = parent.children.filter((cd) => !childrenToToggle.includes(cd));\n      // d3 tree.js read properties of undefined (reading 'z') at firstWalk\n      // childrennull\n      if (!parent.children.length) {\n        parent.children = null;\n      }\n    } else if (parent.hiddenChildren && AincludeB(parent.hiddenChildren, childrenToToggle)) {\n      if (!parent.children) {\n        parent.children = [];\n      }\n      parent.children = parent.children.concat(childrenToToggle);\n      parent.hiddenChildren = parent.hiddenChildren.filter((cd) => !childrenToToggle.includes(cd));\n      if (!parent.hiddenChildren.length) parent.hiddenChildren = null;\n    }\n\n    this.update(parent);\n  }\n    */\n\n\n  private batchEnterExitUpdate() {\n    d3.selection.prototype.patternify = function (selectedTag:\n      { tag: string, selector: string, targetData?: any }) {\n      const { tag, selector } = selectedTag;\n      const tmpData = selectedTag.targetData || [selector];\n      const batchSelection = this.selectAll(`.${selector}`)\n        .data(tmpData, (d: any, i: any) => {\n          if (typeof d === 'object') {\n            if (d.id) {\n              return d.id;\n            }\n          }\n          return i;\n        });\n\n      batchSelection.exit()\n        .remove();\n      const mergedSelection = batchSelection.enter()\n        .append(tag)\n        .merge(batchSelection);\n      mergedSelection.attr('class', selector);\n      return mergedSelection;\n    };\n  }\n\n  public render() {\n    // svgsvg\n    const drawingContainer = d3.select(this.container);\n    // \n    (drawingContainer.node() as HTMLElement).replaceChildren();\n\n    const drawingContainerBoundry = (drawingContainer.node() as HTMLElement)\n      .getBoundingClientRect();\n    if (drawingContainerBoundry.width > 0) {\n      this.svgWidth = drawingContainerBoundry.width;\n      this.svgHeight = drawingContainerBoundry.height;\n    }\n\n\n    const nodeMaxWidth = typeNodeStyle.nodeWidth; // d3.max(this.data, (({ nodeWidth }) => nodeWidth));\n    const nodeMaxHeight = typeNodeStyle.nodeHeight; // d3.max(this.data, (({ nodeHeight }) => nodeHeight));\n    this.calculated = {\n      id: `ID${Math.floor(Math.random() * 1000000)}`,\n      chartVerticalMargin: this.margins[0],\n      chartHorizontalMargin: this.margins[1],\n      chartWidth: this.svgWidth - this.margins[0] * 2,\n      chartHeight: this.svgHeight - this.margins[1] * 2,\n      nodeMaxWidth,\n      nodeMaxHeight,\n      centerX: (this.svgWidth - this.margins[0] * 2) / 2,\n      centerY: (this.svgHeight - this.margins[1] * 2) / 2,\n    };\n\n    this.depth = this.orient === 'h' ? nodeMaxWidth / 2 : nodeMaxHeight + 20;\n\n    this.treeLayout = d3.tree()\n      .size([this.calculated.chartWidth, this.calculated.chartHeight]);\n    // console.log(\"layout:\", this.treeLayout);\n    // console.log(this.calculated);\n\n\n    if (this.orient === 'h') {\n      this.treeLayout.nodeSize([this.calculated.nodeMaxHeight + typeNodeStyle.nodeSpacing,\n      this.calculated.nodeMaxWidth + this.depth]);\n    } else {\n      this.treeLayout.nodeSize([this.calculated.nodeMaxWidth + typeNodeStyle.nodeSpacing,\n      this.calculated.nodeMaxHeight + this.depth]);\n    }\n\n    if (Array.isArray(this.data)) {\n      this.root = d3.stratify()\n        .id((d: any) => d.nodeId)\n        .parentId((d: any) => d.parentNodeId)(this.data);\n    } else {\n      this.root = d3.hierarchy(this.data, (d: any) => d.children);\n      //  id \n      // let idCounter = 0;\n      //  id\n      this.root.each((node: NodeData) => {\n        // node.id = idCounter++;\n        // node.data.id = node.id;\n        node.id = node.data.id;\n      });\n    }\n\n    this.root.x0 = 0;\n    this.root.y0 = 0;\n\n    /*\n    this.allNodes = this.treeLayout(this.root)\n      .descendants()\n      .forEach((d: any) => {\n        Object.assign(d.data, {\n          directSubordinates: d.children ? d.children.length : 0, // \n          totalSubordinates: d.descendants().length - 1,  // \n        });\n      });\n    */\n\n    // pan & zoom handler\n    // this.zoomfunc = (d3.zoom() as any).on('zoom', this.zoomed.bind(this))\n    //   .bind(this);\n    const zoomfunc = (d3.zoom() as any).on('zoom', (e: any) => {\n      chart.attr('transform', e.transform);\n    })\n\n\n    // this.centerG.attr('transform', `translate(${offsetX}, ${offsetY})`);\n\n\n\n    // svg\n    // @ts-ignore\n    const svg = drawingContainer.patternify({ tag: 'svg', selector: 'svg-chart-container' })\n      .attr('width', this.svgWidth)\n      .attr('height', this.svgHeight)\n      .attr('font-family', this.defaultFont)\n      // .attr('cursor', 'move')\n      // .attr('viewBox', `${this.margins[0]} ${this.margins[1]} ${this.svgWidth} ${this.svgHeight}`)\n      // .tween(\"resize\", window.ResizeObserver ? null : () => () => svg.dispatch(\"toggle\"))\n      .call(zoomfunc).on('dblclick.zoom', null)  // \n\n\n    this.resetZoom = () => {\n      svg.transition().duration(750).call(zoomfunc.transform, d3.zoomIdentity);\n    }\n\n    // svg \n    const chart = svg.patternify({ tag: 'g', selector: 'chart' })\n      .attr('transform', `translate(${this.calculated.chartHorizontalMargin}, ${this.calculated.chartVerticalMargin})`);\n    this.realChart = chart;\n\n    // node link\n    const centerG = chart.patternify({ tag: 'g', selector: 'center-group' })\n    // .attr('transform', this.orient === 'h' ? `translate(${this.calculated.chartHorizontalMargin}, ${this.calculated.centerY}) scale(${this.zoomLevel})` : `translate(${this.calculated.centerX}, ${this.calculated.nodeMaxHeight / 2}) scale(${this.zoomLevel})`);\n    this.centerG = centerG;\n\n    // \n\n    // node link\n    this.update(this.root);\n    return this;\n  }\n\n  private update(data: any) {\n    const tableStore = this.store;\n    const treeData = this.treeLayout(this.root);\n    const linksData = treeData.descendants()\n      .slice(1);\n    const nodesData = treeData.descendants();\n    if (this.orient === 'h') {\n      nodesData.forEach((d: any, index: number) => {\n        const originalX = d.x;\n        d.x = d.y;\n        d.y = originalX;\n        if (index === 0) {\n          d.x = typeNodeStyle.nodeCircleRadius * 2;\n        }\n      });\n    }\n    // nodesDatatransition bug\n    const {\n      x0, y0, x, y,\n    } = data;\n\n    // ************************************link************************************\n    const linksSelection = this.centerG.selectAll('path.link')\n      .data(linksData, (d: any) => d.id);\n\n    const linkGen = d3.linkHorizontal();\n\n    const linksEnter = linksSelection.enter()\n      .insert('path', 'g')\n      .attr('class', 'link')\n      .attr('d', () => {\n        const o: d3.DefaultLinkObject = {\n          source: [x0, y0],\n          target: [x0, y0],\n        };\n        return linkGen(o);\n      });\n\n    const linkUpdate = linksEnter.merge(linksSelection);\n\n    linkUpdate.attr('fill', 'none')\n      .attr('stroke-width', typeNodeStyle.connectorLineWidth)\n      .attr('stroke', typeNodeStyle.connectorLineColor)\n    // .attr('stroke-width', ((d: any) => d.data.connectorLineWidth || 2))\n    // .attr('stroke', (d: any) => (d.data.connectorLineColor ? d.data.connectorLineColor : 'black'));\n\n    let realChartWidth = 0\n    linkUpdate.transition()\n      .duration(this.duration)\n      .attr('d', (d: any) => {\n        if (this.orient === 'h') {\n          let xshiftStart = typeNodeStyle.nodeWidth / 2;\n          const yshiftStart = 0;\n          const xshiftEnd = -typeNodeStyle.nodeWidth / 2;\n          const yshiftEnd = 0;\n\n          if (d.parent.id == \"0\") {\n            xshiftStart = typeNodeStyle.nodeCircleRadius\n          }\n\n          const chartWidth = d.x + xshiftStart;\n          if (chartWidth > realChartWidth) {\n            realChartWidth = chartWidth;\n          }\n\n          const o: d3.DefaultLinkObject = {\n            source: [d.parent.x + xshiftStart, d.parent.y + yshiftStart],\n            target: [d.x + xshiftEnd, d.y + yshiftEnd],\n          };\n          return linkGen(o);\n        }\n\n        const o: d3.DefaultLinkObject = {\n          source: [d.parent.x, d.parent.y + typeNodeStyle.nodeHeight / 2],\n          target: [d.x, d.y - typeNodeStyle.nodeHeight / 2],\n        };\n        return linkGen(o);\n        return diagonal({ x: d.x, y: d.y }, { x: d.parent.x, y: d.parent.y });\n      });\n\n\n\n    // \n    const linkExit = linksSelection.exit()\n      .transition()\n      .duration(this.duration)\n      .attr('d', () => {\n        const o: d3.DefaultLinkObject = {\n          source: [x, y],\n          target: [x, y],\n        };\n        return linkGen(o);\n      })\n      .remove();\n\n    // ************************************node************************************\n    const nodesSelection = this.centerG.selectAll('g.node')\n      .data(nodesData, (d: any) => d.id);\n\n\n\n    const nodeEnter = nodesSelection.enter()\n      .append('g')\n      .attr('class', 'node')\n      .attr('transform', () => `translate(${x0}, ${y0})`)\n      .attr('cursor', 'pointer');\n\n\n\n    // ****************************************************************\n    const nodeGroups = nodeEnter.patternify({ tag: 'g', selector: 'node-group', targetData: (d: any) => [d] });\n    // const nodeRectText = nodeEnter.patternify({ tag: 'text', selector: 'node-text', targetData: (d: any) => [d] });\n\n    // const nodeRectText = nodeGroups.patternify({ tag: 'g', selector: 'node-text-g', targetData: (d: any) => [d] });\n    // nodeRectText.patternify({ tag: 'text', selector: 'node-text' });\n    // nodeRectText.patternify({ tag: 'svg:title', selector: 'node-tooltip' });\n\n    // const edgeText = nodeEnter.patternify({ tag: 'text', selector: 'edge-text', targetData: (d: any) => [d] });\n\n    const nodeUpdate = nodeEnter.merge(nodesSelection);\n\n    nodeUpdate.transition()\n      .attr('opaicty', 0)\n      .duration(this.duration)\n      .attr('transform', (d: any) => {\n        // console.log(d);\n        return `translate(${d.x}, ${d.y})`\n      })\n      .attr('opacity', 1);\n\n    // console.log(data);\n\n    // \n    // nodeGroups\n    //   // .on('click', this.handleNodeMultipleSelect.bind(this))\n    //   .on('contextmenu', this.declareContextMenu.bind(this));\n\n    // nodeGroups.attr('transform', ({ data: info }: any) => `translate(${-info.nodeWidth / 2}, ${-info.nodeHeight / 2})`);\n    nodeGroups.attr('transform', () => `translate(${-typeNodeStyle.nodeWidth / 2}, ${-typeNodeStyle.nodeHeight / 2})`);\n\n    nodeGroups.each(function (this: any, node: NodeData) {\n      const current = d3.select(this);\n      /** circle + rect */\n      if (node.parent === null) { // array\n        // @ts-ignore\n        current.patternify({ tag: 'circle', selector: `node-circle-${node.id}` });\n        nodeGroups.select(`.node-circle-${node.id}`)\n          .attr('class', `node-circle-${node.id} type-node`)\n          .attr('r', typeNodeStyle.nodeCircleRadius)\n          .attr('fill', '#f5f5f5') // typeMapColor[node.data.type!]\n          .attr('stroke', typeNodeStyle.connectorLineColor)\n          .attr('stroke-width', typeNodeStyle.connectorLineWidth)\n          .attr('transform', `translate(${typeNodeStyle.nodeWidth / 2}, ${typeNodeStyle.nodeHeight / 2})`)\n          .attr('cursor', 'pointer')\n        return;\n      }\n\n      if (node.data.id === 1) {\n        tableStore.spec.selectNode = node  // \n        if (document.body.style.cursor !== 'cell') {\n          tableStore.goToInstance(0);\n        }\n      }\n\n      const nodeRectData = {\n        \"rectHeight\": typeNodeStyle.nodeHeight,\n        \"rectWidth\": typeNodeStyle.nodeWidth,\n        \"starty\": 0,\n        \"startx\": 0,\n        \"radius\": 5,\n        \"rounded\": \"all\"\n      }\n      // @ts-ignore\n      const singleNodeG = current.patternify({ tag: 'g', selector: `single-node-g`, targetData: (d: any) => [d] });\n      singleNodeG.patternify({ tag: 'path', selector: `node-rect-${node.id}` });\n      singleNodeG.select(`.node-rect-${node.id}`)\n        .attr('class', `node-rect-${node.id} type-node`)\n        .attr('d', customRectCorner(nodeRectData as RectDef))\n        .attr('fill', typeMapColor[node.data.type!])\n        // .attr('fill', nodeRectData.rectColor)\n        // .attr('cursor', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'pointer'))\n        .attr('cursor', 'pointer')\n      // .attr('pointer-events', (d: any) => (!d.children && !d.hiddenChildren ? 'none' : 'all'));\n\n      let tooltipText: any = node.data.matchs?.length;\n      tooltipText = tooltipText === undefined ? \"\\nDon't match any instances\" : `\\nMatch: ${tooltipText} instances`;\n\n      singleNodeG.patternify({ tag: 'svg:title', selector: 'node-tooltip' });\n      singleNodeG.select('.node-tooltip')\n        // .filter(({ data: info }: any) => info.dataTypeText !== info.dataTypeTextTruncated)\n        .text(\"Pattern Path: \" + JSON.stringify(node.data.path) + tooltipText);\n      // .text(\"Pattern Path: \" + JSON.stringify(node.data.path) + \"\\nPattern Id: \" + node.data.id + tooltipText);\n\n      /** constraints */\n      node.data.match?.constraints?.forEach((_constraint, i) => {\n        // console.log('hhh', constraint, i, dataBindToThis.id, dataBindToThis);\n        const iconsz = typeNodeStyle.iconsize;\n        const constrId = `${node.id}-${i}`;\n        // @ts-ignore\n        current.patternify({ tag: 'rect', selector: `node-constraint-rect-${constrId}` });\n        const constrNodeRect = nodeGroups.select(`.node-constraint-rect-${constrId}`);\n\n        const subTemplate = tableStore.getNodebyPath(tableStore.spec.rawSpecs, node.data.path!);\n        const constraint: CellConstraint = subTemplate!.match.constraints![i];\n\n        constrNodeRect.classed('node-constraint-rect', true)\n          .attr('transform', `translate(${(iconsz + typeNodeStyle.iconPadding) * i}, ${-typeNodeStyle.nodeHeight / 2 - 3})`)\n          .attr(\"visibility\", \"hidden\")\n          .attr('width', iconsz + 2)\n          .attr('height', iconsz + 2)\n          .attr(\"stroke\", typeMapColor.selection)\n          .attr(\"stroke-width\", 1.5)\n          .attr(\"fill\", \"none\")\n\n        let constrIndex = 0;\n\n        // @ts-ignore\n        current.patternify({ tag: 'image', selector: `node-constraint-icon-${constrId}` });\n        nodeGroups.select(`.node-constraint-icon-${constrId}`)\n          .attr('transform', `translate(${1 + (iconsz + typeNodeStyle.iconPadding) * i}, ${-typeNodeStyle.nodeHeight / 2 - 2})`)\n          .attr('xlink:xlink:href', () => {\n            // eslint-disable-next-line\n            const valueCstr = constraint.valueCstr;\n            let iconPath: any;\n            if (typeof valueCstr === 'function') {\n              iconPath = require('@/assets/function.png');\n            } else {\n              switch (valueCstr) {\n                case TableCanoniserKeyWords.String:\n                  iconPath = require('@/assets/string.png');\n                  break;\n                case TableCanoniserKeyWords.Number:\n                  iconPath = require('@/assets/number.png');\n                  break;\n                case TableCanoniserKeyWords.None:\n                  iconPath = require('@/assets/minus.png');\n                  break;\n                case TableCanoniserKeyWords.NotNone:\n                  iconPath = require('@/assets/plus.png');\n                  break;\n                default:\n                  iconPath = require('@/assets/equal3.png');  // letter-w (3)\n              }\n            }\n            // const iconPath = require('@/assets/constraint.png');\n            return iconPath;\n          })\n          .attr('width', iconsz)\n          .attr('height', iconsz)\n          .on('mouseover', (_e: any, d: NodeData) => {\n            // console.log('mouseover', d);\n            try {\n              constrNodeRect.attr('visibility', 'visible');\n              // let cellInfo;\n              // if (d.data.path?.length === 1) {\n              //   cellInfo = d.data.constrsInfo![i][tableStore.tree.instanceIndex]\n              //   constrIndex = tableStore.tree.instanceIndex\n              // } else {\n              //   cellInfo = d.data.constrsInfo![i].map((ele, index) => ({ ele, index })).filter((info) => info.ele.isDefinedFromSpec)[tableStore.tree.instanceIndex];\n              //   constrIndex = cellInfo.index;\n              //   cellInfo = cellInfo.ele;\n              // }\n              let cellInfo = d.data.constrsInfo![i].map((ele, index) => ({ ele, index })).filter(info => info.ele.instIndex === tableStore.tree.instanceIndex);\n              if (cellInfo === undefined) return;\n              tableStore.highlightTblTemplate(cellInfo.map((info) => {\n                if (info.ele.isDefinedFromSpec) constrIndex = info.index;\n                return {\n                  x: info.ele.x,\n                  y: info.ele.y,\n                  width: 1,\n                  height: 1,\n                  isDefinedFromSpec: info.ele.isDefinedFromSpec\n                }\n              }));\n            } catch (e) {\n              console.log('Constraint mouseover error: \\n', e)\n            }\n          })\n          .on('mouseout', (_e: any, d: NodeData) => {\n            if (tableStore.spec.constrNodeRectClickId !== constrId)\n              constrNodeRect.attr('visibility', 'hidden');\n            d3.select('.tbl-container .tbl-template-highlight').selectAll('rect').remove();\n          })\n          .on('contextmenu', declareContextMenu.bind(null, tableStore, node, i))  // bind  this event\n          .on('click', (_e: any, d: NodeData) => {\n            try {\n              // console.time('constraint click');\n              // console.log(constraint, tableStore);  // constraint  d.data.constraints![i]\n              tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.codePref + tableStore.stringifySpec(null, \"even\", false));\n              // \n              document.dispatchEvent(escapeEvent);\n\n              tableStore.spec.constrNodeRectClickId = constrId;\n              constrNodeRect.attr('visibility', 'visible');\n\n              const [startLine, endLine] = tableStore.getHighlightCodeStartEndLine(constraint, subTemplate);\n              tableStore.highlightCode(startLine, endLine, 'selectionShallow');\n              const cellInfoSelections = d.data.constrsInfo![i].map((cellInfo) => [cellInfo.y, cellInfo.x, cellInfo.y, cellInfo.x] as Selection);\n              const classNames = Array(cellInfoSelections.length).fill(\"selectionShallow\");\n              const cells = tableStore.generateHighlightCells(cellInfoSelections, classNames);\n              let { row, col } = cells.slice(-1)[0];\n              if (constrIndex < classNames.length) {\n                // classNames[tableStore.tree.instanceIndex] = 'selection';\n                cells[constrIndex].className = 'selection';\n                row = cells[constrIndex].row;\n                col = cells[constrIndex].col;\n              }\n              tableStore.highlightTblCells(\"input_tbl\", cells, [[row, col]]);\n              tableStore.highlightMinimapCells(cells);\n              // console.timeEnd('constraint click');\n            } catch (e) {\n              console.log('Constraint click error: \\n', e)\n            }\n          })\n          .append('svg:title').text(() => {\n            const valueCstr = constraint.valueCstr;\n            if (typeof valueCstr === 'function') {\n              return \"The cell is constrained by a custom function:\\nClick to see details in the Code Panel.\";\n            } else {\n              switch (valueCstr) {\n                case TableCanoniserKeyWords.String:\n                  return \"The cell's data type should be a string.\";\n                case TableCanoniserKeyWords.Number:\n                  return \"The cell's data type should be a number.\";\n                case TableCanoniserKeyWords.None:\n                  return \"The cell should be an empty string, null, or undefined.\";\n                case TableCanoniserKeyWords.NotNone:\n                  return \"The cell should not be an empty string, null, or undefined.\";\n                default:\n                  return \"The cell should be \" + valueCstr;\n              }\n            }\n          })\n      });\n    });\n\n    // const nodeRectText = nodeUpdate.patternify({ tag: 'g', selector: 'node-text-g', targetData: (d: any) => [d] });\n    nodeUpdate.patternify({ tag: 'text', selector: 'node-text' });\n\n\n    nodeUpdate.select('.node-text')\n      .attr('text-anchor', 'middle')\n      .attr('alignment-baseline', 'middle')\n      .attr('fill', nodeTextStyle.color)\n      .attr('font-size', nodeTextStyle.fontSize)\n      // .attr('y', ({ data: info }: any) => nodeTextStyle.yAxisAdjust + info.shiftFromEndCenter)\n      .attr('y', () => nodeTextStyle.yAxisAdjust)\n      .attr('cursor', 'pinter')\n      .attr('pointer-events', 'none')  // .style('pointer-events', 'auto');\n      .text((d: NodeData) => {\n        if (d.id === 0) {\n          // console.log(d.data.size);\n          return \"\";\n        } else {\n          let width: any = d.data.width;\n          let height: any = d.data.height;\n          let specWidth = d.data.match?.size?.width;\n          let specHeight = d.data.match?.size?.height;\n          if (specWidth === undefined) {\n            specWidth = 1\n          }\n          if (specHeight === undefined) {\n            specHeight = 1\n          }\n          if (width === undefined) width = specWidth;\n          else if (specWidth === null) width = null;\n          if (height === undefined) height = specHeight;\n          else if (specHeight === null) height = null;\n          return `(${width}, ${height})`;\n        }\n      })\n    // .on('click', (event: any, d: any) => {\n    //   // \n    //   // event.stopPropagation();\n    //   // event.preventDefault();\n    //   console.log(\"click\", d);\n    // })\n    // .append(\"svg:title\").text(\"(d: any) => d.data.id\");\n\n\n\n    // circlerect\n    // d3.selectAll('.type-node, .node-text-g')\n    d3.selectAll<SVGElement, NodeData>('.type-node')\n      .on('contextmenu', (e, d) => {\n        declareContextMenu(tableStore, d, -1, e);\n      })\n      .on('mouseover', function (event, node) {  //  function  this this \n        // console.log('mouseover', node);  // event: any, node: any\n        if (node.id) tableStore.highlightTblTemplate(node.data.currentMatchs!);\n      })\n      .on('mouseout', function () {\n        d3.select('.tbl-container .tbl-template-highlight').selectAll('rect').remove();\n      })\n      .on('click', function (event, d) {\n        event.stopPropagation();\n        // d3.selectAll('.type-node').classed('selection', false);\n        tableStore.clearStatus(\"tree\");\n        if (d.id) {\n          tableStore.editor.mappingSpec.instance?.setValue(tableStore.editor.mappingSpec.codePref + tableStore.stringifySpec(null, \"even\", false));\n          // if (tableStore.spec.selectNode === null || tableStore.spec.selectNode.data.id !== node.data.id) {}\n          tableStore.spec.selectNode = d;\n          // tableStore.tree.instanceIndex = 0;\n          d3.select(this).classed('selection', true);\n\n          tableStore.highlightMinimapInsts();\n\n          // console.log(event, d);\n          // [startRow, startCol, endRow, endCol]\n          const visData = d.data;\n          tableStore.goToInstance(0);  // \n\n          /**************  monaco editor  ***************/\n          const subTemplate = tableStore.getNodebyPath(tableStore.spec.rawSpecs, visData.path!);\n          const [startLine, endLine] = tableStore.getHighlightCodeStartEndLine(subTemplate);\n          tableStore.highlightCode(startLine, endLine, `${visData.type}Shallow`);\n        } else {\n          // tableStore.editor.mappingSpec.decorations?.clear();\n          // \n          document.dispatchEvent(escapeEvent);\n          // d3.select(this).classed('selection', true);\n        }\n        return;\n        // this.handleCircleClick(event, d);  // \n      });\n\n\n    /*\n    nodeUpdate.select('.edge-text')\n      .attr('fill', edgeTextStyle.color)\n      .attr('font-size', edgeTextStyle.fontSize)\n      .text(({ data: info }: any) => typeFeatureMapIcon(info.dataTypeFeature))\n      .attr('x', ({ data: info }: any) => {\n        if (this.orient === 'h') {\n          return (info.dataTypeText ? -info.nodeWidth / 2 : -info.nodeCircleRadius) - 15;\n        }\n        return edgeTextStyle.distFromEdge;\n      })\n      .attr('y', ({ data: info }: any) => (this.orient === 'h' ? -edgeTextStyle.distFromEdge + info.shiftFromEndCenter : -info.nodeHeight / 2 - 2));\n    */\n    // ************************************exit ************************************\n    const nodeExitTransition = nodesSelection.exit()\n      .attr('opacity', 1)\n      .transition()\n      .duration(this.duration)\n      .attr('transform', `translate(${x},${y})`)\n      .on('end', function (this: any) {\n        d3.select(this)\n          .remove();\n      })\n      .attr('opacity', 0);\n\n    // Store the old positions for transition.\n    nodesData.forEach((d: any) => {\n      d.x0 = d.x;\n      d.y0 = d.y;\n    });\n\n    const offsetX = Math.max((this.svgWidth - realChartWidth) / 2, 0) - typeNodeStyle.nodeCircleRadius;\n    const offsetY = Math.max((this.svgHeight - this.realChart.node()!.getBBox().height) / 2, 0) + typeNodeStyle.nodeCircleRadius;\n    this.centerG.attr('transform', `translate(${offsetX}, ${offsetY})`); // Center the matrix\n  }\n}\n","import { TableStore } from '@/store/table';\nimport * as d3 from 'd3';\n\n\nexport let miniZoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\nexport const drawMinimap = (rows: number, cols: number, container: SVGSVGElement | null, tableStore: TableStore, percentWidth: number = 0.2) => {\n    if (!container) return;\n\n    const svg = d3.select(container);\n    // Clear any existing SVG\n    svg.select('g.left').remove();\n\n    if (rows === 0 || cols === 0) return;\n\n    const containerWidth = container.clientWidth * percentWidth;\n    const containerHeight = container.clientHeight;\n    let cellWidth = Math.max(5, Math.min(45, Math.floor(containerWidth / cols)));\n    let cellHeight = Math.max(5, Math.min(20, Math.floor(containerHeight / rows)));\n    cellWidth = cellHeight = Math.min(cellWidth, cellHeight)\n\n    miniZoom = d3.zoom<SVGSVGElement, unknown>()\n        // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n        .on('zoom', function (event) {\n            // svg.attr('transform', event.transform);  // svgtransformpansvgg\n            // d3.select('g.matrix').attr('transform', event.transform);\n            // console.log('minimap', event.transform, event);\n            matrix.attr('transform', `translate(${tableStore.tree.offset.left.x + event.transform.x}, ${tableStore.tree.offset.left.y + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n            tableStore.updateCurve();\n            // updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n            // transformStatue = event.transform;\n            // window.d3 = d3;\n        })\n\n\n    const g = svg.append('g').classed(\"left\", true)\n        .call(miniZoom as any).on('dblclick.zoom', null)  // \n\n    const matrix = g.append('g').classed(\"matrix\", true);  // Append a 'g' element for better transform management to avoid jittering\n    // let texts: any = null;\n\n    //  zoom \n    // matrix.on('mouseover', () => {\n    //     svg.call(zoom as any);\n    //     // const transform = d3.zoomTransform(matrix.node() as SVGSVGElement);\n    //     // console.log(transform);\n    // });\n\n    // //  zoom \n    // matrix.on('mouseout', () => {\n    //     svg.on('.zoom', null);  //  zoom \n    //     // const transform = d3.zoomTransform(matrix.node() as SVGSVGElement);\n    //     // console.log(transform);\n    // });\n\n    const grids = tableStore.generateGrid(rows, cols);\n\n    const cells = matrix.append('g').selectAll('rect')\n        .data(grids)\n        .enter().append('rect').classed('grid-cell', true)\n        .attr('x', d => d.col * cellWidth)\n        .attr('y', d => d.row * cellHeight)\n        .attr('id', d => `grid-${d.row}-${d.col}`)\n        .attr('width', cellWidth)\n        .attr('height', cellHeight)\n        // .on('mouseover', function () {\n        //     d3.select(this).raise() // Bring the cell to the front \n        //         // .attr('fill', '#ece9e6')\n        //         // .attr('stroke', '#4b8aff')\n        //         .attr('stroke-width', 2);\n        //     if (texts) {\n        //         texts.raise();\n        //     }\n        // })\n        // .on('mouseout', function () {\n        //     d3.select(this)\n        //         // .attr('fill', '#f9f7ff')\n        //         // .attr('stroke', '#cccccc')\n        //         .attr('stroke-width', 1);\n        // })\n        .on('click', function (event, d) {\n            d3.selectAll('rect.grid-cell').attr('class', 'grid-cell');\n            d3.select(this).raise().classed('selection', true);\n            tableStore.grid_cell_click({ row: d.row, col: d.col })\n            tableStore.input_tbl.instance.deselectCell();\n            tableStore.output_tbl.instance.deselectCell();\n        })\n        .append('title').text(d => `Position: (${d.row}, ${d.col})`);\n\n    // Calculate the offset to center the matrix in the SVG container\n    tableStore.tree.offset.left.x = Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n    tableStore.tree.offset.left.y = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n    matrix.attr('transform', `translate(${tableStore.tree.offset.left.x}, ${tableStore.tree.offset.left.y})`); // Center the matrix\n\n    tableStore.tree.minimapInstHighlight = matrix.append('g').classed('tbl-minimap-highlight', true);\n    tableStore.tree.minimapVisInfo = {\n        width: cellWidth,\n        height: cellHeight\n    }\n\n    /*\n    const updateCellTextVisibility = (scale: number) => {\n        const scaledCellWidth = cellWidth * scale;\n        const scaledCellHeight = cellHeight * scale;\n        // const cellArea = scaledCellWidth * scaledCellHeight;\n        if (scaledCellWidth >= 45 && scaledCellHeight >= 20) {\n            if (texts) {\n                texts.style('display', 'block');\n            } else {\n                texts = matrix.selectAll('text')\n                    .data(grids)\n                    .enter().append('text').classed('grid-text', true)\n                    .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                    .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                    .attr('id', d => `text-${d.row}-${d.col}`)\n                    .attr('dy', '.30em')\n                    .attr('font-size', 15 / scale)\n                    .attr('fill', '#000')\n                    .attr('text-anchor', 'middle')\n                    .text(d => `(${d.row}, ${d.col})`)\n                    .style('display', 'block')\n                    .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n            }\n        } else {\n            if (texts) {\n                texts.style('display', 'none');\n            }\n        }\n    };\n\n    updateCellTextVisibility(1); // Initial update for default scale 1\n    */\n};","export const typeMapColor = {\n  // Pattern selection\n  position: 'rgba(106, 176, 76)',    // '#6ab04c',\n  positionShallow: 'rgba(106, 176, 76, 0.65)',// '#badc58'\n  context: 'rgba(240, 147, 43)', // '#f0932b', \n  contextShallow: 'rgba(240, 147, 43, 0.65)', // '#ffbe76'\n  value: 'rgba(34, 166, 179)', // '#22a6b3',\n  valueShallow: 'rgba(34, 166, 179, 0.65)', // '#7ed6df'\n  // value: 'rgba(140, 122, 230)', // '#8c7ae6',\n  // valueShallow: 'rgba(140, 122, 230, 0.65)', // '#a29bfe'\n  null: 'rgba(131, 149, 167)', // '#8395a7',\n  nullShallow: 'rgba(131, 149, 167, 0.65)', // '#c8d6e5',\n  // Table selection\n  selection: 'rgba(9, 132, 227)',  // '#0984e3',\n  selectionShallow: 'rgba(9, 132, 227, 0.65)',\n\n  positionRGBA: 'rgba(106, 176, 76, 0.5)',\n  contextRGBA: 'rgba(240, 147, 43, 0.5)',\n  valueRGBA: 'rgba(34, 166, 179, 0.5)',\n  nullRGBA: 'rgba(131, 149, 167, 0.5)',\n  selectionRGBA: 'rgba(9, 132, 227, 0.5)',\n\n  ambiguousText: '#f9f7ff', // 'rgba(233, 16, 16, 0.5)',\n\n  // Minimap\n  cellFill: '#f9f7ff',\n  cellStroke: '#cccccc',\n};\n\nexport type TypeColor = keyof typeof typeMapColor;\n\n// Dictionary: '#83b5ed',\n// Array: '#7EAA55',\n// String: '#D07C94',\n// Number: '#EEB189',\n// Boolean: '#926EB8',\n// Null: '#E7D6D6',\n\n/*\nexport const colorConfig = {\n  \"posi-mapping\": {\n    fill: '#0984e3',\n    stroke: '#0984e3',\n    text: '#fff',\n  },\n  \"posi-mapping-shallow\": {\n    fill: '#74b9ff',\n    stroke: '#74b9ff',\n    text: '#fff',\n  },\n  \"ambiguous-cell\": {\n    fill: '#83e4aa',\n    stroke: '#83e4aa',\n    text: '#e91010',\n  },\n  \"determined-cell\": {\n    fill: '#37bc6c',\n    stroke: '#37bc6c',\n    text: '#e91010',\n    weight: 'bold',\n  },\n  \"default\": {\n    fill: '#f9f7ff',\n    stroke: '#cccccc',\n    text: '#000',\n  }\n}\n*/\n\nexport const typeNodeStyle = {\n  nodeWidth: 96, // 100,\n  nodeHeight: 30,\n  nodeRectFillColor: \"#7EAA55\",\n  nodeCircleFillColor: \"#83b5ed\",\n  nodeCircleRadius: 15,\n  nodeBorderRadius: 5,\n  verticalLineLength: 40,\n  verticalLineWidth: 5,\n  nodeSpacing: 34,\n  connectorLineColor: '#0000004D', // link\n  connectorLineWidth: 1.5,\n  iconsize: 15, // nodeconstraint icon\n  iconPadding: 6,  // nodeconstraint icon\n};\n\nexport const nodeTextStyle = {\n  color: 'white',\n  fontSize: 15,\n  yAxisAdjust: 2,\n};","import { TableStore, TblCell } from \"@/store/table\";\nimport { TypeColor, typeMapColor } from \"./style\";\nimport * as d3 from 'd3';\n\nexport let tempZoom: d3.ZoomBehavior<SVGSVGElement, unknown> | null = null;\n\n\nexport const drawTblTemplate = (container: SVGSVGElement | null, tableStore: TableStore, percentWidth: number = 0.8) => {\n    if (!container) return;\n    // Clear any existing SVG\n    const svg = d3.select(container);\n    // Clear any existing SVG\n    svg.select('g.right').remove();\n\n    try {\n        const visChildren = tableStore.spec.visTree.children\n        if (visChildren === undefined || visChildren.length === 0 || visChildren[0].width === 0 || visChildren[0].height === 0) return;\n\n        const containerWidth = container.clientWidth * percentWidth;\n        const containerHeight = container.clientHeight;\n\n\n        let cellWidth = Math.max(5, Math.min(90, Math.floor(containerWidth / visChildren[0].width)));\n        let cellHeight = Math.max(5, Math.min(30, Math.floor(containerHeight / visChildren[0].height)));\n        // const cellWidth = 90;\n        // const cellHeight = 30;\n\n        tempZoom = d3.zoom<SVGSVGElement, unknown>()\n            // .scaleExtent([0.5, 3.5])  // set the zoom scale range\n            .on('zoom', function (event) {\n                // svg.attr('transform', event.transform);  // svgtransformpansvgg\n                matrix.attr('transform', `translate(${tableStore.tree.offset.right.x + event.transform.x}, ${tableStore.tree.offset.right.y + event.transform.y}) scale(${event.transform.k})`); // Update the matrix transform based on the zoom event\n                updateCellTextVisibility(event.transform.k); // Update cell text visibility based on the current scale\n                // transformStatue = event.transform;\n                tableStore.updateCurve();\n            })\n            .filter(function (event) {\n                // \n                return !event.ctrlKey && !event.button && event.type !== 'dblclick';\n            });\n        const g = svg.append('g').classed(\"right\", true)\n            .call(tempZoom as any) // .on('dblclick.zoom', null)  // \n\n        const matrix = g.append('g').classed(\"tbl-template\", true);  // Append a 'g' element for better transform management to avoid jittering\n\n        //  zoom \n        matrix.on('mouseover', () => {\n            svg.call(tempZoom as any);\n            // const transform = d3.zoomTransform(matrix.node() as SVGSVGElement);\n            // console.log(transform);\n        });\n\n        //  zoom \n        matrix.on('mouseout', () => {\n            svg.on('.zoom', null);  //  zoom \n            // const transform = d3.zoomTransform(matrix.node() as SVGSVGElement);\n            // console.log(transform);\n        });\n\n\n        let texts: any = null;\n\n        const grids = tableStore.computeTblPatternGrid();\n        // console.log(\"grids\", grids);\n\n        const cells = matrix.selectAll('rect')\n            .data(grids)\n            .enter().append('rect').classed('tbl-template-cell', true)\n            .attr('x', d => d.col * cellWidth)\n            .attr('y', d => d.row * cellHeight)\n            // .attr('id', d => `tbl-template-${d.row}-${d.col}`)\n            .attr('width', cellWidth)\n            .attr('height', cellHeight)\n            .attr('fill', (d) => d.bgColor ? typeMapColor[d.bgColor as TypeColor] : typeMapColor.cellFill)\n            .attr('stroke', '#cccccc')\n            .on('mouseover', function (this: SVGRectElement) {\n                d3.select(this).raise() // Bring the cell to the front \n                    // .attr('fill', '#ece9e6')\n                    // .attr('stroke', '#4b8aff')\n                    .attr('stroke-width', 2);\n                if (texts) {\n                    texts.raise();\n                }\n            })\n            .on('mouseout', function () {\n                d3.select(this)\n                    // .attr('fill', '#f9f7ff')\n                    // .attr('stroke', '#cccccc')\n                    .attr('stroke-width', 1);\n            })\n            .on('click', function (event, d: TblCell) {\n                // tableStore.grid_cell_click({ row: d.row + visChildren[0].y, col: d.col + visChildren[0].x });\n                const row = d.row + visChildren[0].y;\n                const col = d.col + visChildren[0].x;\n                d3.select(`#grid-${row}-${col}`).dispatch('click');\n                tableStore.highlightNodes([[row, col, row, col]]);\n                tableStore.input_tbl.instance.deselectCell();\n                tableStore.output_tbl.instance.deselectCell();\n            })\n            .append('title').text(d => {\n                if (d.text && d.text.length) {\n                    return \"The cell's Target Column is:\\n\" + d.text.toString();\n                    /*\n                    if (d.bgColor === typeMapColor.position || d.bgColor === typeMapColor.positionShallow) {\n                        return \"The cell's Target Column is:\\n\" + d.text.toString();\n                    } else {\n                        return \"The cell's Target Column may be:\\n\" + d.text.toString();\n                    }*/\n                } else {\n                    return \"No Target Column\";\n                }\n            });\n\n        // Calculate the offset to center the matrix in the SVG container\n        tableStore.tree.offset.right.x = container.clientWidth * (1 - percentWidth) + Math.max((containerWidth - matrix.node()!.getBBox().width) / 2, 0);\n        tableStore.tree.offset.right.y = Math.max((containerHeight - matrix.node()!.getBBox().height) / 2, 0);\n        matrix.attr('transform', `translate(${tableStore.tree.offset.right.x}, ${tableStore.tree.offset.right.y})`); // Center the matrix\n\n\n        const updateCellTextVisibility = (scale: number) => {\n            const scaledCellWidth = cellWidth * scale;\n            const scaledCellHeight = cellHeight * scale;\n            // const cellArea = scaledCellWidth * scaledCellHeight;\n            if (scaledCellWidth >= 90 || scaledCellHeight >= 30) {\n                if (texts) {\n                    texts.style('display', 'block');\n                } else {\n                    texts = matrix.selectAll('text')\n                        .data(grids)\n                        .enter().append('text').classed('tbl-template-text', true)\n                        .attr('x', d => d.col * cellWidth + cellWidth / 2)\n                        .attr('y', d => d.row * cellHeight + cellHeight / 2)\n                        .attr('dy', '.30em')\n                        .attr('font-size', 15 / scale)\n                        .attr('fill', (d) => d.textColor ? typeMapColor[d.textColor as TypeColor] : typeMapColor.cellFill)\n                        .attr('text-anchor', 'middle')\n                        .text(d => d.text ? d.text[0] : '')\n                        .each(function (d) {\n                            const textElement = d3.select(this);\n                            let text = textElement.text();\n                            let textLength = this.getComputedTextLength();\n                            // \n                            while (textLength > cellWidth && text.length > 0) {\n                                text = text.slice(0, -1);\n                                textElement.text(text + '');\n                                textLength = this.getComputedTextLength();\n                            }\n                        })\n                        .style('display', 'block')\n                        .style('pointer-events', 'none'); // Ensure text does not capture mouse events, in order to allow clicking on the cells\n                }\n            } else {\n                if (texts) {\n                    texts.style('display', 'none');\n                }\n            }\n        };\n\n        updateCellTextVisibility(1); // Initial update for default scale 1\n\n        tableStore.tree.tblVisHighlight = matrix.append('g').classed('tbl-template-highlight', true);\n        tableStore.tree.tblVisInfo = {\n            x: visChildren[0].x,\n            y: visChildren[0].y,\n            width: cellWidth,\n            height: cellHeight\n        }\n\n    }\n    catch (e) {\n        console.error(e);\n    }\n}",null,null,"function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 89387;\nmodule.exports = webpackEmptyContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.amdO = {};","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".\" + {\"9\":\"f0d0ce5c\",\"293\":\"6d8dd432\",\"703\":\"0d1f9c9d\",\"1034\":\"f6b3e245\",\"1157\":\"2beaf0f8\",\"1461\":\"fb0059e9\",\"1477\":\"ffc266e5\",\"1813\":\"6ef079f7\",\"1915\":\"e21bd83b\",\"2149\":\"158a201f\",\"2365\":\"bc8f5817\",\"2412\":\"58f99ca3\",\"2501\":\"55fd872c\",\"2591\":\"ff39a05e\",\"2689\":\"688f7bd6\",\"2709\":\"3469afb1\",\"2799\":\"c63987be\",\"2965\":\"29d2a306\",\"2999\":\"d3f9dba9\",\"3051\":\"77e50c86\",\"3061\":\"482c606b\",\"3071\":\"89465fe3\",\"3445\":\"435e8a35\",\"3473\":\"0bab0d67\",\"3577\":\"6bef9c0d\",\"3691\":\"484ae4ed\",\"3717\":\"768e8e27\",\"3753\":\"b0442b7b\",\"3765\":\"d615a011\",\"3775\":\"d917e1e1\",\"3948\":\"345948b3\",\"4205\":\"5e5ebbf5\",\"4261\":\"169ed9f2\",\"4341\":\"78a4ab37\",\"4373\":\"ac90adaa\",\"4485\":\"bef2dca3\",\"4605\":\"266b8468\",\"4621\":\"870c28e6\",\"4805\":\"cf594d89\",\"4977\":\"838037ee\",\"5077\":\"c02ac641\",\"5081\":\"14f2d800\",\"5083\":\"27c26858\",\"5093\":\"00755c35\",\"5282\":\"c990c8e3\",\"5285\":\"132b11de\",\"5287\":\"283969a6\",\"5303\":\"8f9f9293\",\"5365\":\"dd4e4d8e\",\"5521\":\"2a9a635c\",\"5589\":\"2bda62e9\",\"5609\":\"d5afb7e8\",\"5653\":\"f8f91ca2\",\"5749\":\"e6f60040\",\"5841\":\"bd5e10f3\",\"6059\":\"b1f436f9\",\"6121\":\"dd2816d2\",\"6181\":\"e7ca2241\",\"6229\":\"3ac5fa3b\",\"6309\":\"1ba0b728\",\"6325\":\"abe102ec\",\"6613\":\"370f0a13\",\"6757\":\"689d8cb6\",\"6821\":\"aa9a31f0\",\"6845\":\"e880c126\",\"7045\":\"25718108\",\"7217\":\"f7f0263e\",\"7219\":\"ba6a1f42\",\"7449\":\"3864266f\",\"7461\":\"69958a2b\",\"7525\":\"5eb1403e\",\"7623\":\"05ce3550\",\"7641\":\"d0033e39\",\"8175\":\"cc24a080\",\"8285\":\"b5f431a8\",\"8329\":\"2dbd08aa\",\"8387\":\"a20b1f1d\",\"8533\":\"bb0c91d4\",\"8653\":\"866ac1be\",\"8981\":\"57ed1260\",\"9009\":\"cd2170ef\",\"9437\":\"f09192df\",\"9445\":\"0e4c637b\",\"9626\":\"6f86ed1e\",\"9717\":\"5d0c3836\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var inProgress = {};\nvar dataWebpackPrefix = \"TableCanoniser:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = function(url, done, key, chunkId) {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = function(prev, event) {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach(function(fn) { return fn(event); });\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t3524: 0\n};\n\n__webpack_require__.f.j = function(chunkId, promises) {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise(function(resolve, reject) { installedChunkData = installedChunks[chunkId] = [resolve, reject]; });\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = function(event) {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkTableCanoniser\"] = self[\"webpackChunkTableCanoniser\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [504], function() { return __webpack_require__(52753); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","_hoisted_1","class","_hoisted_2","_hoisted_3","_createElementVNode","style","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_defineComponent","__name","setup","__props","expose","__expose","tableStore","useTableStore","instanceContent","ref","menuList","computed","tree","contextMenuVisible","length","contextMenuVisibleChange","value","closeContextMenu","visNode","spec","selectNode","data","extract","extractColor","triggerCellCursorFlag","messageInfo","maxCNum","findMaxCNumber","key","byPositionToTargetCols","Array","from","width","height","_","i","byContext","position","createExtract","eval","byValue","insertNodeOrPropertyIntoSpecs","undefined","deleteChildByPath","rawSpecs","path","stringifySpec","selectConstrIndex","editor","mappingSpec","highlightCode","getHighlightCodeStartEndLine","getNodebyPath","message","info","selectAreaFromNode","document","body","cursor","documentElement","setProperty","cells","generateHighlightCells","selectionsAreaFromLegend","selectAreaFromLegend","highlightTblCells","treeContainer","resetZoom","visInst","d3","transition","duration","call","miniZoom","transform","tempZoom","drawTree","treeInstance","TreeChart","render","typeMap","selectMatchExtractArea","type","classed","selectionsFromLegend","selectFromLegend","push","tblContainer","handleFormatter","v","matchedInstNum","isNaN","parseInt","handleStep","goToInstance","visTree","children","matchs","handleCodeChange","clickFlag","codeUpdateFromEditor","setTimeout","instance","getValue","setValue","setFlag","prepareDataAfterCodeChange","drawMinimap","input_tbl","tbl","transformTablebyCode","triggerCodeChange","instanceIndex","computeColInfo","drawTblTemplate","optimizeMiniTempDistance","updateCurve","watch","newVal","onMounted","querySelector","setAttribute","_ctx","_cache","_component_a_input_number","_resolveComponent","_component_a_button","_component_a_button_group","_component_v_icon","_component_a_flex","_component_a_menu","_component_a_dropdown","_openBlock","_createElementBlock","_createVNode","justify","align","default","_withCtx","_unref","defaultValue","disabled","onPressEnter","$event","target","size","precision","formatter","onStep","onBlur","title","_toDisplayString","onClick","_createTextVNode","name","scale","ref_key","trigger","open","onOpenChange","overlay","items","_createStaticVNode","$props","$setup","$data","$options","_component_panel_view","_Fragment","_withScopeId","n","_pushScopeId","_popScopeId","props","tblType","icons","string","stringIcon","number","numberIcon","none","nullIcon","sortedColInfos","colInfo","iconCounts","count","filter","icon","sort","a","b","sortedIcons","handleIconClick","col","rows","className","row","correspondingTblCells","in_out_mapping","cell","highlightMinimapCells","_normalizeStyle","reduce","sum","_renderList","index","src","alt","__exports__","lastEl","ele","flex","nextEl","startX","startY","flexSum","dragging","getNeighborEls","draggingType","dividerEl","siblingElements","parentElement","currentIndex","indexOf","getBoundingClientRect","parseFloat","clientX","clientY","onDrag","move","newLastW_H","newNextW_H","newLastRate","newNextRate","newLastFlex","newNextFlex","endDrag","registerAllModules","output_col","output_tbl","cols","inHotInst","outHotInst","renderTblCell","td","prop","cellProperties","Handsontable","renderers","TextRenderer","apply","this","arguments","innerHTML","updateColInfoFn","tblData","clearStatus","initTblInfo","resetData","JSON","parse","stringify","currentInitData","updateData","fileList","fileTblData","handleUpload","request","reader","FileReader","onload","arrayBuffer","result","workbook","XLSX","firstSheetName","SheetNames","worksheet","Sheets","rawData","sheet_to_json","header","maxColumns","Math","max","handlePreview","onSuccess","readAsArrayBuffer","file","error","saveLastCase","handleRemove","transformTblUpdateRootArea","currentCase","caseList","pop","startsWith","includes","arrayToCSV","array","join","loadCaseData","handleDownload","warning","csv","blob","Blob","url","URL","createObjectURL","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","success","normalizeSelection","selections","row1","col1","row2","col2","startRow","min","endRow","startCol","endCol","initEventsForTbl","tblInst1","tblInst2","tbl2","updateSettings","outsideClickDeselects","targetEle","targetClassName","closest","some","c","split","decorations","clear","addHook","currentColumn","newSize","isDoubleClick","changes","source","event","coords","TD","selected","getSelected","selectedCoords","hightedCells","getHightlightedCells","updateVisTreeAreaBox","selectType","parent","nx","x","ny","y","nw","nh","offsetX","offsetY","match","traverse","xDirection","yDirection","startCell","currentSpec","cellValue","getDataAtCell","constraints","valueCstr","getCellDataType","constraint","selectionsPath","specs","newSpec","buildTree","highlightNodes","proxy","getCurrentInstance","$refs","inputTbl","hotInstance","outputTbl","iconScrolls","querySelectorAll","tblScrolls","forEach","iconScroll","addEventListener","scrollLeft","_component_a_upload","accept","customRequest","onRemove","onPreview","showUploadList","showRemoveIcon","ColType","HotTable","rowHeaders","colHeaders","manualColumnResize","autoWrapRow","autoWrapCol","contextMenu","renderer","licenseKey","onMousedown","codeType","editorDefaultOptions","language","theme","fontSize","glyphMargin","automaticLayout","autoIndent","readOnly","minimap","enabled","lineNumbersMinChars","scrollBeyondLastLine","wordWrap","padding","bottom","editorWrapper","regex","areStringEqual","str1","str2","replace","initEditor","dispose","editorOptions","monaco","create","onDidBlurEditorText","checkGrammarError","errorMark","undoHistory","redoHistory","onDidChangeModelContent","rootArea","handleResize","debounce","layout","resizeObserver","ResizeObserver","libUri","existingModel","getModels","find","model","uri","toString","fetch","then","response","text","tsContent","typescript","javascriptDefaults","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","setCompilerOptions","ScriptTarget","ES2015","allowNonTsExtensions","addExtraLib","createModel","observe","createDecorationsCollection","onUnmounted","areaConfig","formData","areaFormData","handleOk","values","handleCancel","selectArea","dragConfigOpen","modalTitleRef","isDragging","useDraggable","startedDrag","transformX","transformY","preTransformX","preTransformY","dragRect","left","right","top","bodyRect","titleRect","watchEffect","transformStyle","_component_a_divider","_component_a_col","_component_a_radio_button","_component_a_radio_group","_component_a_row","_component_a_modal","_createBlock","overflow","onCancel","onOk","okText","modalRender","originVNode","_resolveDynamicComponent","offsetLayer","offsetFrom","_hoisted_17","_hoisted_18","typeMapColor","caseOption","label","codePanel","undoFlag","redoFlag","undo","lastSpec","redo","lastUndo","patternVis","handleKeydown","deselectCell","handleCaseChange","isDropdownOpen","timeHandler","dropdownListEle","selectEnter","clearTimeout","selectLeave","_component_a_select","_component_a_tab_pane","_component_a_tabs","options","onChange","onMouseenter","onMouseleave","InOutTable","PatternVis","activeKey","rightExtra","tab","CodeView","DraggableModal","defineComponent","components","PanelView","pinia","createPinia","app","createApp","App","use","Select","Tabs","Button","Upload","Tooltip","Popover","Input","Modal","Space","Dropdown","Menu","Form","Row","Col","Radio","Divider","Flex","InputNumber","addIcons","BiUpload","BiDownload","LaRocketSolid","BiArrowClockwise","IoArrowUndoOutline","IoArrowRedoOutline","BiChevronLeft","BiChevronRight","component","OhVueIcon","mount","replaceEvenSpaces","str","halfLength","repeat","removeWhitespace","csvToMatrix","csvText","trim","matrix","removeSpaceType","even","all","defineStore","state","shallowRef","visTreeMatchPath","constrNodeRectClickId","fill","codePref","codeSuff","object","in2out","in2nodes","out2in","offset","tblVisHighlight","tblVisInfo","minimapInstHighlight","minimapVisInfo","menuAllList","color","actions","caseN","prompt","case_path","data_res","spec_res","Promise","dataText","specText","ok","msg","traverseTree4UpdateMatchs","nodes","instIndex","node","templateRef","firstLayerFlag","isDefinedFromSpec","hasOwnProperty","ci","cellInfoSelections","constrsInfo","allConstr","completeCellConstraint","cellInfo","getCellBySelect","matchedInsts","currentMatchs","isDefinedFromSpecInst","cm","newMatch","areaBox","child","round","maxInst","hightlightViewsAfterClickNode","selectAll","highlightMinimapInsts","hightlight","attr","select","selection","visInfo","remove","raise","d","enter","append","on","numberToOrdinal","maxDistance","miniG","miniWidth","getBBox","distanceGap","console","currentInstRect","instRightX","instTopY","instBottomY","tempRect","tempLeftX","tempTopY","tempBottomY","tempG","instTransform","getCTM","tempTransform","applyTransform","f","rectTopRight","rectBottomRight","rectRightTopLeft","rectRightBottomLeft","lineGenerator","curve","pathData1","pathData2","traverseTree4UpdateIn2Nodes","parentPath","idCounter","currentPath","areaKey","extractKeys","startLine","endLine","add","Set","tidyData","transformTable","strSpec","serialize","removeQuotesFromKeysRegex","classNames","range","ri","rowFlag","colFlag","topLeft","rowSize","colSize","startPoint","visibleRows","countVisibleRows","visibleCols","countVisibleCols","scrollViewportTo","floor","verticalSnap","horizontalSnap","visData","matchArea","allHightedInCells","allHightedOutCells","concat","coordsOut","posi_mapping","posi","pi","endsWith","pi_n","doRectanglesIntersect","rect1","rect2","isRectanglesContained","pStartRow","pStartCol","pEndRow","pEndCol","cStartRow","cStartCol","cEndRow","cEndCol","arr","maxNumber","types","paths","rootNodes","insertNode","existingChild","newNode","added","rootNode","addedSpec","traverseTree4buildSpecs","pSelection","px","py","pw","ph","targetNode","copyAttributes","highlightNodesId","keyArea","Number","highlightTblTemplate","areas","highlight","area","log","grid_cell_click","outTblCells","points","current","codeFormat","ts","compilerOptions","CommonJS","evalFunction","Function","outputText","TableCanoniserKeyWords","isArray","num","suffix","markers","getModelMarkers","marker","startLineNumber","startColumn","messageContent","derivePosiMapping","CustomError","outTbl","numRows","j","inPosi","outPosi","generateGrid","grid","computeTblPatternGrid","firstNode","grids","box","shift","bgColor","textColor","outY","outX","inputFlag","constrIndex","currentNode","splice","slice","lastIndex","parentNode","currentNodes","replaceSpace","replaceCode","fnList","replacer","fn","replaceTableCanoniserKeyWordsRegex","nodeOrProperty","property","assign","attributes","copyTreeAttributes","tree1","tree2","sonData","sonParentData","rootData","rootStr","sonStr","startIndex","strBefore","startParentLine","startConstLine","endConstLine","decorationsCollection","newDecorations","isWholeLine","set","revealRangeAtTop","table","hot","colCount","getColWidth","String","None","NotNone","func","wait","timeout","args","getters","constructor","super","setPrototypeOf","prototype","TableTidierKeyWords","escapeEvent","KeyboardEvent","keyCode","charCode","which","bubbles","cancelable","customRectCorner","rectInfo","startx","starty","rectWidth","rectHeight","rounded","radius","declareContextMenu","preventDefault","_margins","_container","_data","_store","_zoomLevel","_orient","_defineProperty","svgWidth","svgHeight","margins","container","zoomLevel","orient","depth","calculated","treeLayout","realChart","previousTransform","centerX","root","allNodes","defaultFont","store","setZoomFactor","bind","batchEnterExitUpdate","currentWidth","centerG","targetZoomLevel","nodeMaxWidth","centerY","nodeMaxHeight","patternify","selectedTag","tag","selector","tmpData","targetData","batchSelection","exit","mergedSelection","merge","drawingContainer","replaceChildren","drawingContainerBoundry","typeNodeStyle","nodeWidth","nodeHeight","random","chartVerticalMargin","chartHorizontalMargin","chartWidth","chartHeight","nodeSize","nodeSpacing","nodeId","parentId","parentNodeId","each","x0","y0","zoomfunc","chart","svg","update","treeData","linksData","descendants","nodesData","originalX","nodeCircleRadius","linksSelection","linkGen","linksEnter","insert","linkUpdate","connectorLineWidth","connectorLineColor","realChartWidth","xshiftStart","yshiftStart","xshiftEnd","yshiftEnd","nodesSelection","nodeEnter","nodeGroups","nodeUpdate","nodeRectData","singleNodeG","tooltipText","_constraint","iconsz","iconsize","constrId","constrNodeRect","subTemplate","iconPadding","iconPath","require","_e","dispatchEvent","nodeTextStyle","yAxisAdjust","specWidth","specHeight","stopPropagation","percentWidth","containerWidth","clientWidth","containerHeight","clientHeight","cellWidth","cellHeight","k","g","positionShallow","context","contextShallow","valueShallow","null","nullShallow","selectionShallow","positionRGBA","contextRGBA","valueRGBA","nullRGBA","selectionRGBA","ambiguousText","cellFill","cellStroke","nodeRectFillColor","nodeCircleFillColor","nodeBorderRadius","verticalLineLength","verticalLineWidth","visChildren","updateCellTextVisibility","ctrlKey","button","texts","dispatch","scaledCellWidth","scaledCellHeight","textElement","textLength","getComputedTextLength","Forward","Auto","pairSort","sortWithCorrespondingArray","A","B","sortOrder","indexedA","sortedB","DEFAULT_WIDTH","DEFAULT_HEIGHT","DEFAULT_REFERENCE_AREA_LAYER","DEFAULT_REFERENCE_AREA_POSI","DEFAULT_X_OFFSET","DEFAULT_Y_OFFSET","DEFAULT_X_DIRECTION","DEFAULT_Y_DIRECTION","DEFAULT_CONTEXT_POSITION","DEFAULT_TARGET_COL","ctxCells","DEFAULT_VALUE_CSTR","DEFAULT_IGNORE_OUT_OF_BOUNDS","DEFAULT_FILL","completeRegionPosition","completedSelection","ignoreOutOfBounds","completeContextTransform","toTargetCol","completeSpecification","template","_a","_c","_b","_d","_g","_f","_j","_h","_l","_k","_m","grammar_1","obj","seen","WeakSet","has","evaluateConstraint","calculateOffset","currentArea","constrFlag","layer","areaLayer","li","cellPosi","errorMessage","areaTbl","calculateSize","getSubArea","subArea","fillColumns","maxLength","column","fillValue","traverseArea","endX","endY","currentStartX","currentEndX","currentStartY","currentEndY","tmpArea","areaHeight","areaWidth","xIndex","yIndex","cstr","transformArea","cellArray","flat","transformedCols","ctxCols","ctxCellsInfo","ctxSelections","ctxPosiFn","customSelections","customSelectionsWithDefaults","cellCtxs","cellCtxsInfo","customMapColbyCxt","targetCol","processTemplate","templateIndex","matchTemplateArea","areaChild","templateChild","ti","specWithDefaults","webpackEmptyContext","__webpack_module_cache__","moduleId","cachedModule","loaded","__webpack_modules__","m","amdO","deferred","O","chunkIds","priority","notFulfilled","Infinity","fulfilled","every","r","getter","__esModule","definition","defineProperty","enumerable","get","chunkId","promises","u","miniCssF","globalThis","window","inProgress","dataWebpackPrefix","l","done","script","needAttach","scripts","getElementsByTagName","s","getAttribute","charset","nc","onScriptComplete","prev","onerror","doneFns","head","Symbol","toStringTag","nmd","p","installedChunks","installedChunkData","promise","reject","loadingEnded","errorType","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","__webpack_exports__"],"sourceRoot":""}